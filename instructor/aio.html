<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>R-toolbox: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="../assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="../assets/styles.css">
<script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="manifest" href="../site.webmanifest">
<link rel="mask-icon" href="../safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="white">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="black">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md top-nav library"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="lc-logo" alt="Library Carpentry" src="../assets/images/library-logo.svg"><span class="badge text-bg-danger">
          <abbr title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.">
            <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#early-development-pre-alpha-through-alpha" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
              Pre-Alpha
            </a>
            <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
<li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul>
</li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='../aio.html';">Learner View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav library" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Library Carpentry" src="../assets/images/library-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      R-toolbox
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            R-toolbox
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<hr>
<li><a class="dropdown-item" href="CLT-dk.html">CLT - på dansk</a></li>
<li><a class="dropdown-item" href="CLT-en.html">CLT - på dansk</a></li>
<li><a class="dropdown-item" href="data.html">Data sets</a></li>
<li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul>
</li>
      </ul>
</div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="../instructor/aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  R-toolbox
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress library">
    <div class="progress-bar library" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text">
<li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul>
</li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../aio.html">Learner View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->

            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="reproducible-analysis.html">1. Reproducible Data Analysis</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="reading-files.html">2. Reading data from file</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="descript-stat.html">3. Descriptive Statistics</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="table1.html">4. Table One</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="tidy-data.html">5. Tidy Data</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="normal-distribution.html">6. The normal distribution</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="is-it-normal.html">7. Testing for normality</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="which-distribution.html">8. How is the data distributed?</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="linear-regression.html">9. Linear regression</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush11">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading11">
        <a href="multiple-linear-regression.html">10. Multiple Linear Regression</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush12">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading12">
        <a href="logistic-regression.html">11. Logistisk regression</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush13">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading13">
        <a href="clt.html">12. Central Limit Theorem</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush14">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading14">
        <a href="barcharts.html">13. Nicer barcharts</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush15">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading15">
        <a href="powerberegninger.html">14. powerberegninger</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush16">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading16">
        <a href="kmeans.html">15. k-means</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush17">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading17">
        <a href="factor-analysis.html">16. Factor Analysis</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush18">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading18">
        <a href="structure-you-work.html">17. structure-you-work</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush19">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading19">
        <a href="fence-test.html">18. fence-test</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush20">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading20">
        <a href="design-principles.html">19. design-principles</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr>
<li><a class="dropdown-item" href="CLT-dk.html">CLT - på dansk</a></li>
<li><a class="dropdown-item" href="CLT-en.html">CLT - på dansk</a></li>
<li><a class="dropdown-item" href="data.html">Data sets</a></li>
<li><a class="dropdown-item" href="reference.html">Reference</a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources">
<a href="../instructor/aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">

            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-reproducible-analysis"><p>Content from <a href="reproducible-analysis.html">Reproducible Data Analysis</a></p>
<hr>
<p>Last updated on 2024-10-07 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/reproducible-analysis.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 12 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I ensure that my results can be reproduced?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to use markdown</li>
<li>Demonstrate how to include pieces of code</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>A key concept in the scientific process is reproducibility. We should
be able to run the same experiment again, and get, more or less, the
same result.</p>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div> Instructor Note </h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" aria-labelledby="headingInstructor1" data-bs-parent="#accordionInstructor1">
<div class="accordion-body">
<p>We will not always get the same result, applying the same functions
on the same data - some statistical techniques relies on randomness.</p>
<p>An example is k-means, that clusters data based on randomly selected
initial centroids.</p>
</div>
</div>
</div>
</div>
<p>This also applies to the analysis of data. If we have a collection of
measurements of blood pressure from patients before and after they have
taken an antihypertensive drug, we might arrive at the result that this
specific drug is not working. Doing the same analysis tomorrow, we
should reach the same result.</p>
<p>And that can be surprisingly difficult!</p>
<p>There are a lot of pitfalls, ranging from accessibility to incentive
structures in academia. But the two areas where R can help us are:</p>
<ul>
<li>Software Environment</li>
<li>Documentation and Metadata</li>
<li>Complex Workflows</li>
</ul></section><section><h2 class="section-heading" id="software-environment">Software Environment<a class="anchor" aria-label="anchor" href="#software-environment"></a>
</h2>
<hr class="half-width">
<p>Data analysis is done using specific software, libraries or packages,
in a variety of versions. And it happens in an environment on the
computer that might not be identical from day to day.</p>
<p>One example of these problems is shown every time we load tidyverse:
<img src="../fig/tidyverse_conflicts.png" alt="Tidyverse conflicts" class="figure"></p>
<p>This message informs us that there is a <code>filter()</code>
function in the <code>stats</code> packages which is part of the core
R-installation. That function is masked by the <code>filter()</code>
function from the <code>tidyverse´ package</code>dplyr`.</p>
<p>If our analysis relies on the way the <code>filter()</code> function
works in the <code>tidyverse</code>, we will get errors if
<code>tidyverse</code> is not loaded.</p>
<p>We might also have data stored in memory. Every time we close
RStudio, we are asked if we want to save the environment:</p>
<figure><img src="../fig/save_environment.png" alt="Should we save the environment? No!" class="figure mx-auto d-block"><div class="figcaption">Should we save the environment? No!</div>
</figure><p>This will save all the objects we have in our environment, in order
for RStudio to be able to load them into memory when we open RStudio
again.</p>
<p>That can be nice and useful. On the other hand we run the risk of
having the wrong version of the
<code>my_data_that_is_ready_for_analysis</code> dataframe lying around
in memory.</p>
<p>In addition we can experience performance problems. Storing a lot of
large objects before closing RStudio can take a lot of time. And loading
them into memory when opening RStudio will also take a lot of time.</p>
<p>On modern computers we normally have plenty of storage - but it is
entirely possible to fill your harddrive with R-environments to the
point where your computer crashes.</p>
</section><section><h2 class="section-heading" id="documentation-and-metadata">Documentation and Metadata:<a class="anchor" aria-label="anchor" href="#documentation-and-metadata"></a>
</h2>
<hr class="half-width">
<p>What did we actually do in the analysis? Why did we do it? Why are we
reaching the conclusion we’ve arrived at?</p>
<p>Three very good questions. Having good metadata, data that describes
your data, often makes understanding your data easier. Documenting the
individual steps of your analysis, may not seem necessary right now -
you know why you are doing what you are doing. But future you - you in
three months, or some one else, might not remember or be able to guess
(correctly).</p>
</section><section><h2 class="section-heading" id="complex-workflows">Complex Workflows<a class="anchor" aria-label="anchor" href="#complex-workflows"></a>
</h2>
<hr class="half-width">
<p>Doing data analysis in eg Excel, can involve a lot of pointing and
clicking.</p>
<p>And in any piece of software, the analysis will normally always
involve more than one step. Those steps will have to be done in the
correct order. Calculating a mean of some values, depends heavily on
whether it happens before or after deleting irrelevant observations.</p>
</section><section><h2 class="section-heading" id="the-solution-to-all-of-this">The solution to all of this!<a class="anchor" aria-label="anchor" href="#the-solution-to-all-of-this"></a>
</h2>
<hr class="half-width">
<figure><img src="../fig/horstmarkdown.png" alt="The Rmarkdown family. Artwork by @allison_horst, https://twitter.com/allison_horst, CC-BY" class="figure mx-auto d-block"><div class="figcaption">The Rmarkdown family. Artwork by <span class="citation">@allison_horst</span>, <a href="https://twitter.com/allison_horst" class="external-link uri">https://twitter.com/allison_horst</a>, CC-BY</div>
</figure><p>Working in RMarkdown allows us to collect the text describing our
data, what and why we are doing what we do, the code actually doing it,
and the results of that code - all in one document.</p>
<p>Open a new file, choose RMarkdown, and give your document a name:</p>
<figure><img src="../fig/rmarkdown.png" alt="An RMarkdown document" class="figure mx-auto d-block"><div class="figcaption">An RMarkdown document</div>
</figure><p>The code chunks, marked here with a light grey background, contains
code, in this case not very advanced code. You can run the entire code
chunk by clicking the green arrow on the right. Or by placing your
cursor in the line of code you want to run, and pressing ctrl+enter (or
command+enter on a Mac).</p>
<p>Outside the code chunks we can add our reasons for actually running
<code>summary</code> on the <code>cars</code> dataframe, and describe
what it contains.</p>
<p>You will see a new button in RStudio: <img src="../fig/knitr_button.png" alt="The Knit button" class="figure"></p>
<p>Clicking this, will “knit” your document; run each chunck of code,
add the output to your document, and combine your code, the results and
all your explanatory text to one html-document.</p>
<p>If you do not want an HTMl-document, you can knit to a MicroSoft Word
document. Depending on your computer, you can knit directly to a
pdf.</p>
<p>Having the entirety of your analysis in an RMarkdown document, and
then running it, ensures that the individual steps in the analysis are
run in the correct order.</p>
<p>It does not ensure that your documentation of what you do is written
- it makes it easy to add it, but you still have to do it.</p>
<div class="section level3">
<h3 id="but-what-about-the-environment">But what about the environment?<a class="anchor" aria-label="anchor" href="#but-what-about-the-environment"></a>
</h3>
<p>So we force ourself to have the steps in our analysis in the correct
order, and we make it easy to add documentation. What about the
environment?</p>
<p>Working with RMarkdown also adresses this problem. Every time we
<code>knit</code> our document, RStudio opens a new session of R,
without libraries or objects in memory. This ensures that the analysis
is done in the exact same way each and every time.</p>
<p>This, on the other hand, requires us to add code chunks loading
libraries and data to our document.</p>
<div id="try-it-yourself" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="try-it-yourself" class="callout-inner">
<h3 class="callout-title">Try it yourself</h3>
<div class="callout-content">
<p>Make a new RMarkdown document, add <code><a href="https://tidyverse.tidyverse.org" class="external-link">library(tidyverse)</a></code> to
the first chunk, add your own text, and change the plot to plot the
<code>distance</code> variable from the <code>cars</code> data set.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>Make a new RMarkdown document - File -&gt; New File -&gt; R
Markdown.</p>
<p>Change the final code chunk to include <code>plot(cars$dist)</code>
instead of plot(pressure)</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Use RMarkdown to enforce reproducible analysis</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section><section id="aio-reading-files"><p>Content from <a href="reading-files.html">Reading data from file</a></p>
<hr>
<p>Last updated on 2024-10-07 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/reading-files.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 12 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do you read in data from files??</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to read in data from a selection of different data
files.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>The first step of doing dataanalysis, is normally to read in the
data.</p>
<p>Data can come from many different sources, and it is practically
impossible to cover every possible format. Here we cover some of the
more common.</p>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div> Instructor Note </h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" aria-labelledby="headingInstructor1" data-bs-parent="#accordionInstructor1">
<div class="accordion-body">
<p>The most important point is that there is a very high probability
that at least one package exists that is designed to read a specific
weird data format.</p>
</div>
</div>
</div>
</div>
<figure><img src="../fig/manyfiles.webp" class="figure mx-auto d-block"></figure></section><section><h2 class="section-heading" id="use-code">Use code!<a class="anchor" aria-label="anchor" href="#use-code"></a>
</h2>
<hr class="half-width">
<p>RStudio makes it simple to load most common data formats. Right-click
on the file in RStudio, and choose import. RStudio will then provide an
interface for loading the data.</p>
<figure><img src="../fig/data_import.png" class="figure mx-auto d-block"></figure><p>However in general we prefer to have a script or a document, that can
be run without us pointing and clicking. So - instead of importing the
data in this way, copy the code that RStudio uses to import the data,
and paste it into your script or document.</p>
</section><section><h2 class="section-heading" id="csv-files">CSV-files<a class="anchor" aria-label="anchor" href="#csv-files"></a>
</h2>
<hr class="half-width">
<p>The most basic file type for storing and transferring data. A
“simple” textfile, containing tabular data. One line of text for each
row of data, each cell in that row, corresponding to a column, separated
with a separator, typically a comma.</p>
<p>Many languages use commas as decimal separators. That neccesitates an
option for using something else than a comma. Typically a semicolon.</p>
<div class="section level3">
<h3 id="truly-commaseparated-files">Truly commaseparated files<a class="anchor" aria-label="anchor" href="#truly-commaseparated-files"></a>
</h3>
<p>Use <code>read.csv()</code> (from base-R) or <code>read_csv()</code>
(from <code>readr</code>, included in <code>tidyverse</code>)</p>
<p>We recommend using <code>read_csv()</code>.</p>
</div>
<div class="section level3">
<h3 id="semicolon-separated-files">Semicolon separated files<a class="anchor" aria-label="anchor" href="#semicolon-separated-files"></a>
</h3>
<p>Use <code>read.csv2()</code> (from base-R) or
<code>read_csv2()</code> (from <code>readr</code>, included in
<code>tidyverse</code>)</p>
<p>We recommend <code>read_csv2()</code></p>
</div>
<div class="section level3">
<h3 id="what-they-have-in-common">What they have in common<a class="anchor" aria-label="anchor" href="#what-they-have-in-common"></a>
</h3>
<p><code>read_csv</code> and <code>read_csv2</code> take a lot of
arguments that can control datatypes, handling of headers etc. For most
use, the default options are enough, but if you need to adjust
something, there are plenty of options for that.</p>
<div id="guess_max" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="guess_max" class="callout-inner">
<h3 class="callout-title">guess_max</h3>
<div class="callout-content">
<p><code>read_csv</code> and <code>read_csv2</code> tries to guess the
datatypes in the file, and will convert the data accordingly. That will
return a dataframe where date-time data is stored as such. The functions
by default reads the first 1000 rows, and makes a guess on the datatype
based on that.</p>
<p>That can lead to problems if the first 1000 rows of a column contain
numbers, and row 1001 contains text. In that case the entire row will be
coerced to <code>numeric</code>, and the following rows will contain
<code>NA</code> values. Adjust the argument <code>guess_max</code> to
something larger to catch this problem.</p>
<p>To include every row in the guess, add <code>guess_max = Inf</code> -
but be careful if you have a very large dataset.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="excel-files">Excel-files<a class="anchor" aria-label="anchor" href="#excel-files"></a>
</h2>
<hr class="half-width">
<p>Use the <code>readxl</code> package. Excel comes in two variants,
<code>xls</code> and <code>xlsx</code>. <code>read_excel()</code> makes
a qualified quess of the actual type your excel-file is. Should we need
to specify, we can use <code>read_xls()</code> or
<code>read_xlsx()</code>.</p>
<p>Workbooks often contains more than one sheet. We can specify which we
want to read in:</p>
<p><code>read_excel(path = "filename", sheet = 2)</code></p>
<p>Which will read in sheet number 2 from the workbook “filename”.</p>
<p>Read the documentation for details on how to read in specific cells
or ranges.</p>
</section><section><h2 class="section-heading" id="spss">SPSS<a class="anchor" aria-label="anchor" href="#spss"></a>
</h2>
<hr class="half-width">
<p>SPSS, originally “Statistical Package for the Social Sciences”, later
renamed “Statistical Product and Service Solutions” is a proprietary
statistical software suite developed by IBM.</p>
<p>Not surprisingly it is widely used in social science.</p>
<p>The package <code>haven</code> supports reading SPSS (Stata and SAS)
files</p>
<p>Use the package to read in spss files:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">haven</span><span class="op">)</span></span>
<span><span class="fu">read_spss</span><span class="op">(</span><span class="st">"filename"</span><span class="op">)</span></span></code></pre>
</div>
<p>The function returns at tibble.</p>
<p>Note that SPSS uses a variety of different formats.
<code>read_spss()</code> will make a guess of the correct format, but if
problems arise, try using one of the other functions provided in
<code>haven</code></p>
</section><section><h2 class="section-heading" id="stata">Stata<a class="anchor" aria-label="anchor" href="#stata"></a>
</h2>
<hr class="half-width">
<p>Stata is a proprietary statistical software package, used in a
multitude of different fields, primarily biomedicine, epidemiololy,
sociology and economics.</p>
<p>As mentioned above, hte <code>haven</code> package provides functions
for reading Stata files:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">haven</span><span class="op">)</span></span>
<span><span class="fu">read_stata</span><span class="op">(</span><span class="st">"filename"</span><span class="op">)</span></span></code></pre>
</div>
<p>The function returns at tibble.</p>
<p>As with SPSS Stata uses a couple of different fileformats, and
<code>read_stata</code> makes a guess as to which format is used. If
problems arise, <code>haven</code> has more specific functions for
reading specific file formats.</p>
</section><section><h2 class="section-heading" id="sas">SAS<a class="anchor" aria-label="anchor" href="#sas"></a>
</h2>
<hr class="half-width">
<p>SAS is a proprietary statistical software suite developed by SAS
Institute.</p>
<p>As mentioned above the package <code>haven</code> can read
SAS-files:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">haven</span><span class="op">)</span></span>
<span><span class="fu">read_sas</span><span class="op">(</span><span class="st">"filename"</span><span class="op">)</span></span></code></pre>
</div>
<p>The function returns at tibble.</p>
<p>As with SPSS and Stata, SAS uses a couple of different fileformats,
and <code>read_sas</code> tries to guess the correct format.</p>
<p>If problems arise, <code>haven</code> has more specific functions for
reading specific file formats.</p>
</section><section><h2 class="section-heading" id="json">JSON<a class="anchor" aria-label="anchor" href="#json"></a>
</h2>
<hr class="half-width">
<p>Not all data come in a nice rectangular format:</p>
<table style="width:97%;" class="table">
<colgroup>
<col width="50%">
<col width="20%">
<col width="22%">
<col width="4%">
</colgroup>
<tbody>
<tr class="odd">
<td rowspan="2">
<h1 id="country">Country</h1>
<p>USA</p>
</td>
<td rowspan="2">
<h1 id="name">Name</h1>
<p>NASA</p>
</td>
<td rowspan="2">
<h1 id="phonenumber">Phonenumber</h1>
<ol start="713" style="list-style-type: decimal">
<li>483-3111</li>
</ol>
</td>
<td></td>
</tr>
<tr class="even">
<td></td>
</tr>
<tr class="odd">
<td></td>
<td>White House</td>
<td>
<ol start="202" style="list-style-type: decimal">
<li>456-1414</li>
</ol>
<p>(202)-456-1111</p>
</td>
<td></td>
</tr>
<tr class="even">
<td>Russia</td>
<td>Kremlin</td>
<td colspan="2">0107-095-295-9051</td>
</tr>
<tr class="odd">
<td>Vatican</td>
<td>The Pope</td>
<td>011-39-6-6982</td>
<td></td>
</tr>
</tbody>
</table>
<p>There are two locations in the US, and one of them have two
phonenumbers. These kinds of structure, where one row contains data with
more than one row (etc), are called nested, and are typically stored or
distributed in the JSON-format.</p>
<p>JSON can be read using <code>fromJSON()</code> from the
<code>jsonlite</code> library.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">jsonlite</span><span class="op">)</span></span>
<span><span class="fu">fromJSON</span><span class="op">(</span><span class="st">"filename"</span><span class="op">)</span></span></code></pre>
</div>
<p>Note that you will end up with nested columns - containing lists -
which you probably will have to handle afterwards.</p>
</section><section><h2 class="section-heading" id="other-formats">Other formats<a class="anchor" aria-label="anchor" href="#other-formats"></a>
</h2>
<hr class="half-width">
<p>In general if a piece of software is in widespread enough use that
you encounter the weird file-format it uses, someone will have written a
package for reading it. Google is your friend here!</p>
<p>Also, if you encounter a really weird dataformat, please send us an
example so we can expand our knowledge.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>The <code>readr</code> version of <code>read_csv()</code> is
preferred</li>
<li>Remember that csv is not always actually separated with commas.</li>
<li>The <code>haven</code> package contains functions for reading common
proprietary file formats.</li>
<li>In general a package will exist for reading strange datatypes.
Google is your friend!</li>
<li>Use code to read in your data</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-descript-stat"><p>Content from <a href="descript-stat.html">Descriptive Statistics</a></p>
<hr>
<p>Last updated on 2024-10-07 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/descript-stat.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 12 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can we describe a set of data?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Learn about the most common ways of describing a variable</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div> Instructor Note </h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" data-bs-parent="#accordionInstructor1" aria-labelledby="headingInstructor1">
<div class="accordion-body">
<p>Det kan være en udfordring hvis deltagene ikke ved hvad et gennemsnit
er.</p>
<p>En af de overordnede pointer vi gerne vil frem til her, er
percentilerne og det kumulative densitetsplot - der danner grundlag for
forståelsen af normalfordelingens sammenhæng med statistiske tests.</p>
</div>
</div>
</div>
</div>
<p>Descriptive statistic involves summarising or describing a set of
data. It usually presents quantitative descriptions in a short form, and
helps to simplify large datasaets.</p>
<p>Most descriptive statistical parameters applies to just one variable
in our data, and includes:</p>
<table class="table">
<thead><tr class="header">
<th>Central tendency</th>
<th>Measure of variation</th>
<th>Measure of shape</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Mean</td>
<td>Range</td>
<td>Skewness</td>
</tr>
<tr class="even">
<td>Median</td>
<td>Quartiles</td>
<td>Kurtosis</td>
</tr>
<tr class="odd">
<td>mode</td>
<td>Inter Quartile Range</td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>Variance</td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td>Standard deviation</td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>Percentiles</td>
<td></td>
</tr>
</tbody>
</table></section><div class="section level1">
<h1 id="central-tendency">Central tendency<a class="anchor" aria-label="anchor" href="#central-tendency"></a>
</h1>
<p>The easiest way to get summary statistics on data is to use the
<code>summarise</code> function from the <code>tidyverse</code>
package.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span></code></pre>
</div>
<p>In the following we are working with the <code>palmerpenguins</code>
dataset:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">palmerpenguins</span><span class="op">)</span></span></code></pre>
</div>
<p>Specifically the weight of the penguins, stored in the variable
<code>body_mass_g</code>:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span><span class="op">$</span><span class="va">body_mass_g</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  [1] 3750 3800 3250   NA 3450 3650 3625 4675 3475 4250 3300 3700 3200 3800 4400
 [16] 3700 3450 4500 3325 4200 3400 3600 3800 3950 3800 3800 3550 3200 3150 3950
 [31] 3250 3900 3300 3900 3325 4150 3950 3550 3300 4650 3150 3900 3100 4400 3000
 [46] 4600 3425 2975 3450 4150 3500 4300 3450 4050 2900 3700 3550 3800 2850 3750
 [61] 3150 4400 3600 4050 2850 3950 3350 4100 3050 4450 3600 3900 3550 4150 3700
 [76] 4250 3700 3900 3550 4000 3200 4700 3800 4200 3350 3550 3800 3500 3950 3600
 [91] 3550 4300 3400 4450 3300 4300 3700 4350 2900 4100 3725 4725 3075 4250 2925
[106] 3550 3750 3900 3175 4775 3825 4600 3200 4275 3900 4075 2900 3775 3350 3325
[121] 3150 3500 3450 3875 3050 4000 3275 4300 3050 4000 3325 3500 3500 4475 3425
[136] 3900 3175 3975 3400 4250 3400 3475 3050 3725 3000 3650 4250 3475 3450 3750
[151] 3700 4000 4500 5700 4450 5700 5400 4550 4800 5200 4400 5150 4650 5550 4650
[166] 5850 4200 5850 4150 6300 4800 5350 5700 5000 4400 5050 5000 5100 4100 5650
[181] 4600 5550 5250 4700 5050 6050 5150 5400 4950 5250 4350 5350 3950 5700 4300
[196] 4750 5550 4900 4200 5400 5100 5300 4850 5300 4400 5000 4900 5050 4300 5000
[211] 4450 5550 4200 5300 4400 5650 4700 5700 4650 5800 4700 5550 4750 5000 5100
[226] 5200 4700 5800 4600 6000 4750 5950 4625 5450 4725 5350 4750 5600 4600 5300
[241] 4875 5550 4950 5400 4750 5650 4850 5200 4925 4875 4625 5250 4850 5600 4975
[256] 5500 4725 5500 4700 5500 4575 5500 5000 5950 4650 5500 4375 5850 4875 6000
[271] 4925   NA 4850 5750 5200 5400 3500 3900 3650 3525 3725 3950 3250 3750 4150
[286] 3700 3800 3775 3700 4050 3575 4050 3300 3700 3450 4400 3600 3400 2900 3800
[301] 3300 4150 3400 3800 3700 4550 3200 4300 3350 4100 3600 3900 3850 4800 2700
[316] 4500 3950 3650 3550 3500 3675 4450 3400 4300 3250 3675 3325 3950 3600 4050
[331] 3350 3450 3250 4050 3800 3525 3950 3650 3650 4000 3400 3775 4100 3775</code></pre>
</div>
<p>How can we describe these values?</p>
<div class="section level2">
<h2 id="mean">Mean<a class="anchor" aria-label="anchor" href="#mean"></a>
</h2>
<p>The mean is the average of all datapoints. We add all values
(excluding the missing values encoded with <code>NA</code>), and divide
with the number of observations:</p>
<p><span class="math display">\[\overline{x} = \frac{1}{N}\sum_1^N
x_i\]</span> Where N is the number of observations, and <span class="math inline">\(x_i\)</span> is the individual observations in the
sample <span class="math inline">\(x\)</span>.</p>
<p>The easiest way of getting the mean is using the <code>mean()</code>
function:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mean</span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 4201.754</code></pre>
</div>
<p>A slightly more cumbersome way is using the summarise function from
<code>tidyverse</code>:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>avg_mass <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1 × 1
  avg_mass
     &lt;dbl&gt;
1    4202.</code></pre>
</div>
<p>The advantage will be clear below.</p>
<p>Barring significant outliers, <code>mean</code> is an expression of
position of the data. This is the weight we would expect a random
penguin in our dataset to have.</p>
<p>However, we have three different species of penguins in the dataset,
and they have quite different average weights. There is also a
significant difference in the average weight for the two sexes.</p>
<p>We will get to that at the end of this segment.</p>
</div>
<div class="section level2">
<h2 id="median">Median<a class="anchor" aria-label="anchor" href="#median"></a>
</h2>
<p>Similarly to the average/mean, the <code>median</code> is an
expression of the location of the data. If we order our data by size,
from the smallest to the largest value, and locate the middle
observation, we get the median. This is the value that half of the
observations is smaller than. And half the observations is larger.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>median <span class="op">=</span> <span class="fu">median</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1 × 1
  median
   &lt;dbl&gt;
1   4050</code></pre>
</div>
<p>We can note that the mean is larger that the median. This indicates
that the data is skewed, in this case toward the larger penguins.</p>
<p>We can get both <code>median</code> and <code>mean</code> in one
go:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>median <span class="op">=</span> <span class="fu">median</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            mean   <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1 × 2
  median  mean
   &lt;dbl&gt; &lt;dbl&gt;
1   4050 4202.</code></pre>
</div>
<div id="accordionInstructor2" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor2" aria-expanded="false" aria-controls="collapseInstructor2">
  <h3 class="accordion-header" id="headingInstructor2">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div> Instructor Note </h3>
</button>
<div id="collapseInstructor2" class="accordion-collapse collapse" data-bs-parent="#accordionInstructor2" aria-labelledby="headingInstructor2">
<div class="accordion-body">
<p>This illustrates for the learners that we can calculate more than one
summary statistics in one summarise function.</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="mode">Mode<a class="anchor" aria-label="anchor" href="#mode"></a>
</h2>
<p>Mode is the most common, or frequently occurring, observation. R does
not have a build-in function for this, but we can easily find the mode
by counting the different observations,and locating the most common
one.</p>
<p>We typically do not use this for continous variables. The mode of the
<code>sex</code> variable in this dataset can be found like this:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">sex</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 3 × 2
  sex        n
  &lt;fct&gt;  &lt;int&gt;
1 male     168
2 female   165
3 &lt;NA&gt;      11</code></pre>
</div>
<p>We count the different values in the <code>sex</code> variable, and
arrange the counts in descending order (<code>desc</code>). The mode of
the <code>sex</code> variable is male.</p>
<p>In this specific case, we note that the dataset is pretty evenly
balanced regarding the two sexes.</p>
</div>
</div>
<div class="section level1">
<h1 id="measures-of-variance">Measures of variance<a class="anchor" aria-label="anchor" href="#measures-of-variance"></a>
</h1>
<p>Knowing where the observations are located is interesting. But how do
they vary? How can we describe the variation in the data?</p>
<div class="section level2">
<h2 id="range">Range<a class="anchor" aria-label="anchor" href="#range"></a>
</h2>
<p>The simplest information about the variation is the range. What is
the smallest and what is the largest value? The <code>range()</code>
function can find it.</p>
<p>Since this returns more than one value, we use the function reframe
instead of summarise:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">reframe</span><span class="op">(</span>range <span class="op">=</span> <span class="fu">range</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 2 × 1
  range
  &lt;int&gt;
1  2700
2  6300</code></pre>
</div>
<p>However it is typically more usefull to extract the two values to
separate columns in the output:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>min <span class="op">=</span> <span class="fu">min</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            max <span class="op">=</span> <span class="fu">max</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1 × 2
    min   max
  &lt;int&gt; &lt;int&gt;
1  2700  6300</code></pre>
</div>
<p>The range informs us of the spread of the observations.</p>
</div>
<div class="section level2">
<h2 id="variance">Variance<a class="anchor" aria-label="anchor" href="#variance"></a>
</h2>
<p>The observations varies. They are no all located at the mean (or
median), but are spread out on both sides of the mean. Can we get a
numerical value describing that?</p>
<p>An obvious way would be to calculate the difference between each of
the observations and the mean, and then take the average of those
differences.</p>
<p>That will give us the average deviation. But we have a problem. The
average weight of penguins was 4202 (rounded). Look at two penguins, one
weighing 5000, and another weighing 3425. The differences are:</p>
<ul>
<li>5000 - 4202 = 798</li>
<li>3425 - 4202 = -777</li>
</ul>
<p>The sum of those two differences is: -777 + 798 = 21 g. And the
average is then 10.5 gram. That is <em>not</em> a good estimate of a
variation from the mean of more than 700 gram.</p>
<p>The problem is, that the differences can be both positive and
negative, and might cancel each other out.</p>
<p>We solve that problem by squaring the differences, and calculate the
mean of those.</p>
<div id="accordionInstructor3" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor3" aria-expanded="false" aria-controls="collapseInstructor3">
  <h3 class="accordion-header" id="headingInstructor3">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div> Instructor Note </h3>
</button>
<div id="collapseInstructor3" class="accordion-collapse collapse" data-bs-parent="#accordionInstructor3" aria-labelledby="headingInstructor3">
<div class="accordion-body">
<p>Why not just averaging the absolute values? Using the square rather
than the absolute difference, weighs the deviations so larger deviations
have relatively larger influence on the variance. Squaring results in a
continous and differentiable function, which helps in situations where
we have to do an optimisation. Also the normal distribution is defined
by the variance as defined here, and we would really like to get a
connection between what we observe here, and the normal
distribution.</p>
</div>
</div>
</div>
</div>
<p>The mathematical notation would be:</p>
<p><span class="math display">\[
\sigma^2 = \frac{\sum_{i=1}^N(x_i - \mu)^2}{N}
\]</span></p>
<p>Why are we suddenly using <span class="math inline">\(\mu\)</span>
instead of <span class="math inline">\(\overline{x}\)</span>? Because
this definition uses the population mean. The mean, or average, in the
entire population of all penguins everywhere in the universe. But we
have not weighed all those penguins.</p>
<p>Instead we will normally look at the sample variance:</p>
<p><span class="math display">\[
s^2 = \frac{\sum_{i=1}^N(x_i - \overline{x})^2}{N-1}
\]</span></p>
<p>Note that we also change the <span class="math inline">\(\sigma\)</span> to an <span class="math inline">\(s\)</span>.</p>
<p>And again we are not going to do that by hand, but will ask R to do
it for us:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>            variance <span class="op">=</span> <span class="fu">var</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>          <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1 × 1
  variance
     &lt;dbl&gt;
1  643131.</code></pre>
</div>
<div id="accordionInstructor4" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor4" aria-expanded="false" aria-controls="collapseInstructor4">
  <h3 class="accordion-header" id="headingInstructor4">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div> Instructor Note </h3>
</button>
<div id="collapseInstructor4" class="accordion-collapse collapse" data-bs-parent="#accordionInstructor4" aria-labelledby="headingInstructor4">
<div class="accordion-body">
<p>Et godt spørgsmål vil være - hvorfor dividerer vi med N-1 i stedet
for N?</p>
<p>Det kaldes for en “Bessel korrektion”. Den ene årsag til at vi gør
det er, at godt nok er gennemsnittet i stikprøven et godt estimat for
gennemsnittet i populationen. Men det er ikke præcis det samme. Når vi
dividerer med et mindre tal, får vi en større værdi for variancen - og
dermed et mere konservativt, eller forsigtigt, estimat på variansen.</p>
<p>Den anden årsag handler om frihedsgrader. Hvis vi har tre værdier og
et gennemsnit, kan vi vælge hvad de to af værdierne er, og hvad
gennemsnittet er. Helt frit. Men den tredie værdi er givet. Den kan vi
ikke vælge frit.</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="standard-deviation">Standard deviation<a class="anchor" aria-label="anchor" href="#standard-deviation"></a>
</h2>
<p>There is a problem with the variance. It is 643131, completely off
scale from the actual values. There is also a problem with the unit
which is in <span class="math inline">\(g^2\)</span>.</p>
<p>A measurement of the variation of the data would be the standard
deviation, simply defined as the square root of the variance:</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>            s <span class="op">=</span> <span class="fu">sd</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>          <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1 × 1
      s
  &lt;dbl&gt;
1  802.</code></pre>
</div>
<p>Since the standard deviation occurs in several statistical tests, it
is more frequently used than the variance. It is also more intuitively
relateable to the mean.</p>
</div>
<div class="section level2">
<h2 id="a-histogram">A histogram<a class="anchor" aria-label="anchor" href="#a-histogram"></a>
</h2>
<p>A visual illustration of the data can be nice. Often one of the first
we make, is a histogram.</p>
<p>A histogram is a plot or graph where we split the range of
observations in a number of “buckets”, and count the number of
observations in each bucket:</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">body_mass_g</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="op">!</span><span class="fu">is.na</span><span class="op">(</span><span class="va">body_mass_g</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>buckets <span class="op">=</span> <span class="fu">cut</span><span class="op">(</span><span class="va">body_mass_g</span>, breaks<span class="op">=</span><span class="fu">seq</span><span class="op">(</span><span class="fl">2500</span>,<span class="fl">6500</span>,<span class="fl">500</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">group_by</span><span class="op">(</span><span class="va">buckets</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">summarise</span><span class="op">(</span>antal <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 8 × 2
  buckets         antal
  &lt;fct&gt;           &lt;int&gt;
1 (2.5e+03,3e+03]    11
2 (3e+03,3.5e+03]    67
3 (3.5e+03,4e+03]    92
4 (4e+03,4.5e+03]    57
5 (4.5e+03,5e+03]    54
6 (5e+03,5.5e+03]    33
7 (5.5e+03,6e+03]    26
8 (6e+03,6.5e+03]     2</code></pre>
</div>
<p>Typically, rather that counting ourself, we leave the work to R, and
make a histogram directly:</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">body_mass_g</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">geom_histogram</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<figure><img src="../fig/descript-stat-rendered-unnamed-chunk-14-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>By default ggplot chooses 30 bins, typically we should chose a
different number:</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">body_mass_g</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">geom_histogram</span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<figure><img src="../fig/descript-stat-rendered-unnamed-chunk-15-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Or, ideally, set the widths of them, manually:</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">body_mass_g</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">geom_histogram</span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">250</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Histogram with binwidth = 250 g"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<p><img src="../fig/descript-stat-rendered-unnamed-chunk-16-1.png" style="display: block; margin: auto;" class="figure">
Or even specify the exact intervals we want, here intervals from 0 to
6500 gram in intervals of 250 gram:</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">body_mass_g</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">geom_histogram</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">seq</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">6500</span>,<span class="fl">250</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Histogram with bins in 250 g steps from 0 to 6500 g"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<p><img src="../fig/descript-stat-rendered-unnamed-chunk-17-1.png" style="display: block; margin: auto;" class="figure">
The histogram provides us with a visual indication of both range, the
variation of the values, and an idea about where the data is
located.</p>
</div>
<div class="section level2">
<h2 id="quartiles">Quartiles<a class="anchor" aria-label="anchor" href="#quartiles"></a>
</h2>
<p>The median can be understood as splitting the data in two equally
sized parts, where one is characterized by having values smaller than
the median and the other as having values larger than the median. It is
the value where 50% of the observations are smaller.</p>
<p>Similary we can calculate the value where 25% of the observations are
smaller.</p>
<p>That is often called the first quartile, where the median is the 50%,
or second quartile. Quartile implies four parts, and the existence of a
third or 75% quartile.</p>
<p>We can calcultate those using the quantile function:</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">quantile</span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">body_mass_g</span>, probs <span class="op">=</span> <span class="fl">.25</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> 25%
3550 </code></pre>
</div>
<p>and</p>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">quantile</span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">body_mass_g</span>, probs <span class="op">=</span> <span class="fl">.75</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> 75%
4750 </code></pre>
</div>
<div id="accordionInstructor5" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor5" aria-expanded="false" aria-controls="collapseInstructor5">
  <h3 class="accordion-header" id="headingInstructor5">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div> Instructor Note </h3>
</button>
<div id="collapseInstructor5" class="accordion-collapse collapse" data-bs-parent="#accordionInstructor5" aria-labelledby="headingInstructor5">
<div class="accordion-body">
<p>probs because if we select a random penguin, we have a 25% chance of
selecting a penguin that weighs less than 3550 gram. This ties in to
percentiles and qq-plots.</p>
</div>
</div>
</div>
</div>
<p>We are often interested in knowing the range in which 50% of the
observations fall.</p>
<p>That is used often enough that we have a dedicated function for
it:</p>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>iqr <span class="op">=</span> <span class="fu">IQR</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1 × 1
    iqr
  &lt;dbl&gt;
1  1200</code></pre>
</div>
<p>The name of the quantile function implies that we might have other
quantiles than quartiles. Actually we can calculate any quantile, eg the
2.5% quantile:</p>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">quantile</span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">body_mass_g</span>, probs <span class="op">=</span> <span class="fl">.025</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>    2.5%
2988.125 </code></pre>
</div>
<p>The individual quantiles can be interesting in themselves. If we want
a visual representation of <em>all</em> quantiles, we can calculate all
of them, and plot them.</p>
<p>Instead of doing that by hand, we can use a concept called
<em>CDF</em> or cumulative density function:</p>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CDF</span> <span class="op">&lt;-</span> <span class="fu">ecdf</span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">body_mass_g</span><span class="op">)</span></span>
<span><span class="va">CDF</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Empirical CDF
Call: ecdf(penguins$body_mass_g)
 x[1:94] =   2700,   2850,   2900,  ...,   6050,   6300</code></pre>
</div>
<p>That was not very informative. Lets plot it:</p>
<p>[NOT QUITE DONE!]</p>
<div class="codewrapper sourceCode" id="cb44">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">quantiler</span> <span class="op">&lt;-</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">body_mass_g</span>, probs <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.75</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">penguins</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">body_mass_g</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">stat_ecdf</span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"step"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.25</span>,<span class="fl">0.5</span>,<span class="fl">0.75</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">quantiler</span><span class="op">)</span></span></code></pre>
</div>
<p><img src="../fig/descript-stat-rendered-unnamed-chunk-23-1.png" style="display: block; margin: auto;" class="figure">
den skal vi nok have beskrevet lidt mere.</p>
<p>Men pointen er, at vi for enhver værdi kan aflæse ting. Hvor stor en
andel af pingvinerne vejer mindre end 3000 g? Vi kan finde 3000 på
x-aksen, og aflæse den matchende værdi på y-aksen.</p>
<p>Det svarer også til - hvis vi tager en tilfældig pingvin, hvad er så
sandsynligheden for at den vejer mindre end 3000 gram? Eller for at den
vejer mere end 5000 gram?</p>
</div>
<div class="section level2">
<h2 id="measures-of-shape">Measures of shape<a class="anchor" aria-label="anchor" href="#measures-of-shape"></a>
</h2>
</div>
<div class="section level2">
<h2 id="skewness">Skewness<a class="anchor" aria-label="anchor" href="#skewness"></a>
</h2>
<p>Vi bliver nok nødt til at lave et histogram…</p>
<p>We previously saw a histogram of the data, and noted that the
observations were skewed to the left, and that the “tail” on the right
was longer than on the left. That skewness can be quantised.</p>
<p>There is no function for skewness build into R, but we can get it
from the library <code>e1071</code></p>
<div class="codewrapper sourceCode" id="cb45">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">e1071</span><span class="op">)</span></span>
<span><span class="fu">skewness</span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.4662117</code></pre>
</div>
<p>The skewness is positive, indicating that the data are skewed to the
left, just as we saw. A negative skewness would indicate that the data
skew to the right.</p>
</div>
<div class="section level2">
<h2 id="kurtosis">Kurtosis<a class="anchor" aria-label="anchor" href="#kurtosis"></a>
</h2>
<p>Og her skal vi nok lige have styr på den intuitive forståelse af
det.</p>
</div>
<div class="section level2">
<h2 id="everything-everywhere-all-at-once">Everything Everywhere All at Once<a class="anchor" aria-label="anchor" href="#everything-everywhere-all-at-once"></a>
</h2>
<p>A lot of these descriptive values can be gotten for every variable in
the dataset using the <code>summary</code> function:</p>
<div class="codewrapper sourceCode" id="cb47">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>      species          island    bill_length_mm  bill_depth_mm
 Adelie   :152   Biscoe   :168   Min.   :32.10   Min.   :13.10
 Chinstrap: 68   Dream    :124   1st Qu.:39.23   1st Qu.:15.60
 Gentoo   :124   Torgersen: 52   Median :44.45   Median :17.30
                                 Mean   :43.92   Mean   :17.15
                                 3rd Qu.:48.50   3rd Qu.:18.70
                                 Max.   :59.60   Max.   :21.50
                                 NA's   :2       NA's   :2
 flipper_length_mm  body_mass_g       sex           year
 Min.   :172.0     Min.   :2700   female:165   Min.   :2007
 1st Qu.:190.0     1st Qu.:3550   male  :168   1st Qu.:2007
 Median :197.0     Median :4050   NA's  : 11   Median :2008
 Mean   :200.9     Mean   :4202                Mean   :2008
 3rd Qu.:213.0     3rd Qu.:4750                3rd Qu.:2009
 Max.   :231.0     Max.   :6300                Max.   :2009
 NA's   :2         NA's   :2                                 </code></pre>
</div>
<p>Here we get the range, the 1st and 3rd quantiles (and from those the
IQR), the median and the mean and, rather useful, the number of missing
values in each variable.</p>
<p>We can also get all the descriptive values in one table, by adding
more than one summarizing function to the summarise function:</p>
<div class="codewrapper sourceCode" id="cb49">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>min <span class="op">=</span> <span class="fu">min</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            max <span class="op">=</span> <span class="fu">max</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            mean <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            median <span class="op">=</span> <span class="fu">median</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            stddev <span class="op">=</span> <span class="fu">sd</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            var <span class="op">=</span> <span class="fu">var</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            Q1 <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">body_mass_g</span>, probs <span class="op">=</span> <span class="fl">.25</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            Q3 <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">body_mass_g</span>, probs <span class="op">=</span> <span class="fl">.75</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            iqr <span class="op">=</span> <span class="fu">IQR</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            skew <span class="op">=</span> <span class="fu">skewness</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            kurtosis <span class="op">=</span> <span class="fu">kurtosis</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1 × 11
    min   max  mean median stddev     var    Q1    Q3   iqr  skew kurtosis
  &lt;int&gt; &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
1  2700  6300 4202.   4050   802. 643131.  3550  4750  1200 0.466   -0.740</code></pre>
</div>
<p>As noted, we have three different species of penguins in the dataset.
Their weight varies a lot. If we want to do the summarising on each for
the species, we can group the data by species, before summarising:</p>
<div class="codewrapper sourceCode" id="cb51">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">species</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>min <span class="op">=</span> <span class="fu">min</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            max <span class="op">=</span> <span class="fu">max</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            mean <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            median <span class="op">=</span> <span class="fu">median</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            stddev <span class="op">=</span> <span class="fu">sd</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 3 × 6
  species     min   max  mean median stddev
  &lt;fct&gt;     &lt;int&gt; &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1 Adelie     2850  4775 3701.   3700   459.
2 Chinstrap  2700  4800 3733.   3700   384.
3 Gentoo     3950  6300 5076.   5000   504.</code></pre>
</div>
<p>We have removed some summary statistics in order to get a smaller
table.</p>
</div>
<div class="section level2">
<h2 id="boxplots">Boxplots<a class="anchor" aria-label="anchor" href="#boxplots"></a>
</h2>
<p>Finally boxplots offers a way of visualising some of the summary
statistics:</p>
<div class="codewrapper sourceCode" id="cb53">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">body_mass_g</span>, y <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<figure><img src="../fig/descript-stat-rendered-unnamed-chunk-28-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The boxplot shows us the median (the fat line in the middel of each
box), the 1st and 3rd quartiles (the ends of the boxes), and the range,
with the whiskers at each end of the boxes, illustrating the minimum and
maximum. Any observations, more than 1.5 times the IQR from either the
1st or 3rd quartiles, are deemed as outliers and would be plotted as
individual points in the plot.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Nogen statisktiske pointer om det her</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</div></section><section id="aio-table1"><p>Content from <a href="table1.html">Table One</a></p>
<hr>
<p>Last updated on 2024-10-07 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/table1.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 12 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do you make a Table One?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain what a Table One is</li>
<li>Know how to make a Tabel One and adjust key parameters</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="what-is-a-table-one">What is a “Table One”?<a class="anchor" aria-label="anchor" href="#what-is-a-table-one"></a>
</h2>
<hr class="half-width">
<p>Primarily used in medical and epidemiological research, a Table One
is typically the first table in any publication using data.</p>
<p>It presents the baseline characteristics of the participants in a
study, and provides a concise overview of the relevant demographic and
clinical variables.</p>
<p>It typically compares different groups (male~female,
treatment~control), to highlight similarities and differences.</p>
<p>It can look like this:</p>
<!--html_preserve-->
<div class="Rtable1">
<table class="table Rtable1">
<thead>
<tr>
<th class="grouplabel">
</th>
<th colspan="2" class="grouplabel">
<div>
control
</div>
</th>
<th colspan="2" class="grouplabel">
<div>
case
</div>
</th>
<th colspan="2" class="grouplabel">
<div>
Overall
</div>
</th>
</tr>
<tr>
<th class="rowlabel firstrow lastrow">
</th>
<th class="firstrow lastrow">
<span class="stratlabel">no<br><span class="stratn">(N=298)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">yes<br><span class="stratn">(N=48)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">no<br><span class="stratn">(N=135)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">yes<br><span class="stratn">(N=29)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">no<br><span class="stratn">(N=433)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">yes<br><span class="stratn">(N=77)</span></span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td class="rowlabel firstrow">
Age (years)
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
</tr>
<tr>
<td class="rowlabel">
Mean (SD)
</td>
<td>
61.3 (4.75)
</td>
<td>
58.9 (5.68)
</td>
<td>
61.5 (4.85)
</td>
<td>
58.1 (5.32)
</td>
<td>
61.4 (4.78)
</td>
<td>
58.6 (5.53)
</td>
</tr>
<tr>
<td class="rowlabel lastrow">
Median [Min, Max]
</td>
<td class="lastrow">
62.0 [46.0, 69.0]
</td>
<td class="lastrow">
59.0 [46.0, 68.0]
</td>
<td class="lastrow">
62.0 [45.0, 69.0]
</td>
<td class="lastrow">
58.0 [49.0, 68.0]
</td>
<td class="lastrow">
62.0 [45.0, 69.0]
</td>
<td class="lastrow">
58.0 [46.0, 68.0]
</td>
</tr>
<tr>
<td class="rowlabel firstrow">
estradol (pg/mL)
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
</tr>
<tr>
<td class="rowlabel">
Mean (SD)
</td>
<td>
8.05 (5.29)
</td>
<td>
8.73 (8.84)
</td>
<td>
10.5 (9.72)
</td>
<td>
10.6 (13.7)
</td>
<td>
8.81 (7.06)
</td>
<td>
9.44 (10.9)
</td>
</tr>
<tr>
<td class="rowlabel lastrow">
Median [Min, Max]
</td>
<td class="lastrow">
6.00 [2.00, 46.0]
</td>
<td class="lastrow">
6.50 [2.00, 57.0]
</td>
<td class="lastrow">
8.00 [3.00, 85.0]
</td>
<td class="lastrow">
6.00 [3.00, 76.0]
</td>
<td class="lastrow">
7.00 [2.00, 85.0]
</td>
<td class="lastrow">
6.00 [2.00, 76.0]
</td>
</tr>
<tr>
<td class="rowlabel firstrow">
estrone (pg/mL)
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
</tr>
<tr>
<td class="rowlabel">
Mean (SD)
</td>
<td>
28.7 (15.0)
</td>
<td>
26.8 (12.0)
</td>
<td>
32.3 (15.7)
</td>
<td>
27.7 (13.2)
</td>
<td>
29.8 (15.3)
</td>
<td>
27.1 (12.3)
</td>
</tr>
<tr>
<td class="rowlabel">
Median [Min, Max]
</td>
<td>
25.0 [10.0, 131]
</td>
<td>
23.0 [13.0, 65.0]
</td>
<td>
29.0 [11.0, 119]
</td>
<td>
24.0 [12.0, 59.0]
</td>
<td>
26.0 [10.0, 131]
</td>
<td>
23.0 [12.0, 65.0]
</td>
</tr>
<tr>
<td class="rowlabel lastrow">
Missing
</td>
<td class="lastrow">
58 (19.5%)
</td>
<td class="lastrow">
15 (31.3%)
</td>
<td class="lastrow">
30 (22.2%)
</td>
<td class="lastrow">
11 (37.9%)
</td>
<td class="lastrow">
88 (20.3%)
</td>
<td class="lastrow">
26 (33.8%)
</td>
</tr>
<tr>
<td class="rowlabel firstrow">
testost
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
</tr>
<tr>
<td class="rowlabel">
Mean (SD)
</td>
<td>
25.3 (13.2)
</td>
<td>
22.2 (10.7)
</td>
<td>
27.6 (16.1)
</td>
<td>
28.2 (15.6)
</td>
<td>
26.0 (14.2)
</td>
<td>
24.4 (13.0)
</td>
</tr>
<tr>
<td class="rowlabel">
Median [Min, Max]
</td>
<td>
23.0 [4.00, 111]
</td>
<td>
21.5 [8.00, 63.0]
</td>
<td>
25.0 [6.00, 144]
</td>
<td>
24.0 [10.0, 69.0]
</td>
<td>
23.0 [4.00, 144]
</td>
<td>
22.0 [8.00, 69.0]
</td>
</tr>
<tr>
<td class="rowlabel lastrow">
Missing
</td>
<td class="lastrow">
6 (2.0%)
</td>
<td class="lastrow">
2 (4.2%)
</td>
<td class="lastrow">
3 (2.2%)
</td>
<td class="lastrow">
1 (3.4%)
</td>
<td class="lastrow">
9 (2.1%)
</td>
<td class="lastrow">
3 (3.9%)
</td>
</tr>
<tr>
<td class="rowlabel firstrow">
prolactn
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
</tr>
<tr>
<td class="rowlabel">
Mean (SD)
</td>
<td>
9.60 (5.10)
</td>
<td>
13.7 (12.3)
</td>
<td>
10.8 (6.79)
</td>
<td>
9.57 (3.29)
</td>
<td>
9.99 (5.70)
</td>
<td>
12.2 (10.1)
</td>
</tr>
<tr>
<td class="rowlabel">
Median [Min, Max]
</td>
<td>
8.16 [1.96, 37.3]
</td>
<td>
8.81 [3.87, 55.8]
</td>
<td>
9.30 [2.66, 59.9]
</td>
<td>
8.88 [4.49, 17.6]
</td>
<td>
8.64 [1.96, 59.9]
</td>
<td>
8.84 [3.87, 55.8]
</td>
</tr>
<tr>
<td class="rowlabel lastrow">
Missing
</td>
<td class="lastrow">
14 (4.7%)
</td>
<td class="lastrow">
0 (0%)
</td>
<td class="lastrow">
6 (4.4%)
</td>
<td class="lastrow">
1 (3.4%)
</td>
<td class="lastrow">
20 (4.6%)
</td>
<td class="lastrow">
1 (1.3%)
</td>
</tr>
</tbody>
</table>
</div>
<!--/html_preserve-->
<p>Please note that the automatic styling of this site results in a
table-one that is not very nice looking.</p>
<p>We have 510 participants in a study, split into control and case
groups, and further subdivided into two groups based on Postmenopausal
hormone use. It describes the distribution of sex and concentration of
estradiol, estrone, testosterone and prolactin in a blood sample.</p>
<p>A number of packages making it easy to make a Table One exists. Here
we look at the package <code>table1</code>.</p>
<p>The specific way of doing it depends on the data available. If we do
not have data on the weight of the participants, we are not able to
describe the distribution of their weight.</p>
<p>Let us begin by looking at the data. We begin by loading the two
packages <code>tidyverse</code> and <code>table1</code>. We then read in
the data from the csv-file “BLOOD.csv”, which we have <a href="https://raw.githubusercontent.com/KUBDatalab/R-toolbox/main/episodes/data/BLOOD.csv" class="external-link">downloaded
from this link</a>.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">table1</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"data/BLOOD.csv"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Rows: 510 Columns: 9
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (9): ID, matchid, case, curpmh, ageblood, estradol, estrone, testost, pr...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<p>The data contains missing values, coded as “999.0” for estrone and
testost, and 99.99 for prolactin:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>estrone <span class="op">=</span> <span class="fu">na_if</span><span class="op">(</span><span class="va">estrone</span>, <span class="fl">999.0</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>testost <span class="op">=</span> <span class="fu">na_if</span><span class="op">(</span><span class="va">testost</span>, <span class="fl">999.0</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>prolactn <span class="op">=</span> <span class="fu">na_if</span><span class="op">(</span><span class="va">prolactn</span>, <span class="fl">99.99</span><span class="op">)</span><span class="op">)</span> </span></code></pre>
</div>
<p>We then ensure that categorical values are stored as categorical
values, and adjust the labels of those categorical values:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>case <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">case</span>, labels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"control"</span>, <span class="st">"case"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>curpmh <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">curpmh</span>, labels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"no"</span>, <span class="st">"yes"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>And now we can make our table one like this:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">table1</span><span class="op">(</span><span class="op">~</span><span class="va">ageblood</span><span class="op">+</span><span class="va">estradol</span><span class="op">+</span><span class="va">estrone</span><span class="op">+</span><span class="va">testost</span><span class="op">+</span><span class="va">prolactn</span><span class="op">|</span><span class="va">case</span><span class="op">+</span><span class="va">curpmh</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span></code></pre>
</div>
<!--html_preserve-->
<div class="Rtable1">
<table class="table Rtable1">
<thead>
<tr>
<th class="grouplabel">
</th>
<th colspan="2" class="grouplabel">
<div>
control
</div>
</th>
<th colspan="2" class="grouplabel">
<div>
case
</div>
</th>
<th colspan="2" class="grouplabel">
<div>
Overall
</div>
</th>
</tr>
<tr>
<th class="rowlabel firstrow lastrow">
</th>
<th class="firstrow lastrow">
<span class="stratlabel">no<br><span class="stratn">(N=298)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">yes<br><span class="stratn">(N=48)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">no<br><span class="stratn">(N=135)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">yes<br><span class="stratn">(N=29)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">no<br><span class="stratn">(N=433)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">yes<br><span class="stratn">(N=77)</span></span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td class="rowlabel firstrow">
ageblood
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
</tr>
<tr>
<td class="rowlabel">
Mean (SD)
</td>
<td>
61.3 (4.75)
</td>
<td>
58.9 (5.68)
</td>
<td>
61.5 (4.85)
</td>
<td>
58.1 (5.32)
</td>
<td>
61.4 (4.78)
</td>
<td>
58.6 (5.53)
</td>
</tr>
<tr>
<td class="rowlabel lastrow">
Median [Min, Max]
</td>
<td class="lastrow">
62.0 [46.0, 69.0]
</td>
<td class="lastrow">
59.0 [46.0, 68.0]
</td>
<td class="lastrow">
62.0 [45.0, 69.0]
</td>
<td class="lastrow">
58.0 [49.0, 68.0]
</td>
<td class="lastrow">
62.0 [45.0, 69.0]
</td>
<td class="lastrow">
58.0 [46.0, 68.0]
</td>
</tr>
<tr>
<td class="rowlabel firstrow">
estradol
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
</tr>
<tr>
<td class="rowlabel">
Mean (SD)
</td>
<td>
8.05 (5.29)
</td>
<td>
8.73 (8.84)
</td>
<td>
10.5 (9.72)
</td>
<td>
10.6 (13.7)
</td>
<td>
8.81 (7.06)
</td>
<td>
9.44 (10.9)
</td>
</tr>
<tr>
<td class="rowlabel lastrow">
Median [Min, Max]
</td>
<td class="lastrow">
6.00 [2.00, 46.0]
</td>
<td class="lastrow">
6.50 [2.00, 57.0]
</td>
<td class="lastrow">
8.00 [3.00, 85.0]
</td>
<td class="lastrow">
6.00 [3.00, 76.0]
</td>
<td class="lastrow">
7.00 [2.00, 85.0]
</td>
<td class="lastrow">
6.00 [2.00, 76.0]
</td>
</tr>
<tr>
<td class="rowlabel firstrow">
estrone
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
</tr>
<tr>
<td class="rowlabel">
Mean (SD)
</td>
<td>
28.7 (15.0)
</td>
<td>
26.8 (12.0)
</td>
<td>
32.3 (15.7)
</td>
<td>
27.7 (13.2)
</td>
<td>
29.8 (15.3)
</td>
<td>
27.1 (12.3)
</td>
</tr>
<tr>
<td class="rowlabel">
Median [Min, Max]
</td>
<td>
25.0 [10.0, 131]
</td>
<td>
23.0 [13.0, 65.0]
</td>
<td>
29.0 [11.0, 119]
</td>
<td>
24.0 [12.0, 59.0]
</td>
<td>
26.0 [10.0, 131]
</td>
<td>
23.0 [12.0, 65.0]
</td>
</tr>
<tr>
<td class="rowlabel lastrow">
Missing
</td>
<td class="lastrow">
58 (19.5%)
</td>
<td class="lastrow">
15 (31.3%)
</td>
<td class="lastrow">
30 (22.2%)
</td>
<td class="lastrow">
11 (37.9%)
</td>
<td class="lastrow">
88 (20.3%)
</td>
<td class="lastrow">
26 (33.8%)
</td>
</tr>
<tr>
<td class="rowlabel firstrow">
testost
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
</tr>
<tr>
<td class="rowlabel">
Mean (SD)
</td>
<td>
25.3 (13.2)
</td>
<td>
22.2 (10.7)
</td>
<td>
27.6 (16.1)
</td>
<td>
28.2 (15.6)
</td>
<td>
26.0 (14.2)
</td>
<td>
24.4 (13.0)
</td>
</tr>
<tr>
<td class="rowlabel">
Median [Min, Max]
</td>
<td>
23.0 [4.00, 111]
</td>
<td>
21.5 [8.00, 63.0]
</td>
<td>
25.0 [6.00, 144]
</td>
<td>
24.0 [10.0, 69.0]
</td>
<td>
23.0 [4.00, 144]
</td>
<td>
22.0 [8.00, 69.0]
</td>
</tr>
<tr>
<td class="rowlabel lastrow">
Missing
</td>
<td class="lastrow">
6 (2.0%)
</td>
<td class="lastrow">
2 (4.2%)
</td>
<td class="lastrow">
3 (2.2%)
</td>
<td class="lastrow">
1 (3.4%)
</td>
<td class="lastrow">
9 (2.1%)
</td>
<td class="lastrow">
3 (3.9%)
</td>
</tr>
<tr>
<td class="rowlabel firstrow">
prolactn
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
</tr>
<tr>
<td class="rowlabel">
Mean (SD)
</td>
<td>
9.60 (5.10)
</td>
<td>
13.7 (12.3)
</td>
<td>
10.8 (6.79)
</td>
<td>
9.57 (3.29)
</td>
<td>
9.99 (5.70)
</td>
<td>
12.2 (10.1)
</td>
</tr>
<tr>
<td class="rowlabel">
Median [Min, Max]
</td>
<td>
8.16 [1.96, 37.3]
</td>
<td>
8.81 [3.87, 55.8]
</td>
<td>
9.30 [2.66, 59.9]
</td>
<td>
8.88 [4.49, 17.6]
</td>
<td>
8.64 [1.96, 59.9]
</td>
<td>
8.84 [3.87, 55.8]
</td>
</tr>
<tr>
<td class="rowlabel lastrow">
Missing
</td>
<td class="lastrow">
14 (4.7%)
</td>
<td class="lastrow">
0 (0%)
</td>
<td class="lastrow">
6 (4.4%)
</td>
<td class="lastrow">
1 (3.4%)
</td>
<td class="lastrow">
20 (4.6%)
</td>
<td class="lastrow">
1 (1.3%)
</td>
</tr>
</tbody>
</table>
</div>
<!--/html_preserve-->
<p>It is a good idea, and increases readability, to add labels and units
to the variables. The <code>table1</code> package provides functions for
that:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">label</span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">curpmh</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"current_pmh"</span></span>
<span><span class="fu">label</span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">case</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"case_control"</span></span>
<span><span class="fu">label</span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">ageblood</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Age"</span></span>
<span><span class="fu">units</span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">ageblood</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"years"</span></span>
<span><span class="fu">units</span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">estradol</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"pg/mL"</span></span>
<span><span class="fu">units</span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">estrone</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"pg/mL"</span></span></code></pre>
</div>
<p>Which looks a bit nicer:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">table1</span><span class="op">(</span><span class="op">~</span><span class="va">ageblood</span><span class="op">+</span><span class="va">estradol</span><span class="op">+</span><span class="va">estrone</span><span class="op">+</span><span class="va">testost</span><span class="op">+</span><span class="va">prolactn</span><span class="op">|</span><span class="va">case</span><span class="op">+</span><span class="va">curpmh</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span></code></pre>
</div>
<!--html_preserve-->
<div class="Rtable1">
<table class="table Rtable1">
<thead>
<tr>
<th class="grouplabel">
</th>
<th colspan="2" class="grouplabel">
<div>
control
</div>
</th>
<th colspan="2" class="grouplabel">
<div>
case
</div>
</th>
<th colspan="2" class="grouplabel">
<div>
Overall
</div>
</th>
</tr>
<tr>
<th class="rowlabel firstrow lastrow">
</th>
<th class="firstrow lastrow">
<span class="stratlabel">no<br><span class="stratn">(N=298)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">yes<br><span class="stratn">(N=48)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">no<br><span class="stratn">(N=135)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">yes<br><span class="stratn">(N=29)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">no<br><span class="stratn">(N=433)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">yes<br><span class="stratn">(N=77)</span></span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td class="rowlabel firstrow">
Age (years)
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
</tr>
<tr>
<td class="rowlabel">
Mean (SD)
</td>
<td>
61.3 (4.75)
</td>
<td>
58.9 (5.68)
</td>
<td>
61.5 (4.85)
</td>
<td>
58.1 (5.32)
</td>
<td>
61.4 (4.78)
</td>
<td>
58.6 (5.53)
</td>
</tr>
<tr>
<td class="rowlabel lastrow">
Median [Min, Max]
</td>
<td class="lastrow">
62.0 [46.0, 69.0]
</td>
<td class="lastrow">
59.0 [46.0, 68.0]
</td>
<td class="lastrow">
62.0 [45.0, 69.0]
</td>
<td class="lastrow">
58.0 [49.0, 68.0]
</td>
<td class="lastrow">
62.0 [45.0, 69.0]
</td>
<td class="lastrow">
58.0 [46.0, 68.0]
</td>
</tr>
<tr>
<td class="rowlabel firstrow">
estradol (pg/mL)
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
</tr>
<tr>
<td class="rowlabel">
Mean (SD)
</td>
<td>
8.05 (5.29)
</td>
<td>
8.73 (8.84)
</td>
<td>
10.5 (9.72)
</td>
<td>
10.6 (13.7)
</td>
<td>
8.81 (7.06)
</td>
<td>
9.44 (10.9)
</td>
</tr>
<tr>
<td class="rowlabel lastrow">
Median [Min, Max]
</td>
<td class="lastrow">
6.00 [2.00, 46.0]
</td>
<td class="lastrow">
6.50 [2.00, 57.0]
</td>
<td class="lastrow">
8.00 [3.00, 85.0]
</td>
<td class="lastrow">
6.00 [3.00, 76.0]
</td>
<td class="lastrow">
7.00 [2.00, 85.0]
</td>
<td class="lastrow">
6.00 [2.00, 76.0]
</td>
</tr>
<tr>
<td class="rowlabel firstrow">
estrone (pg/mL)
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
</tr>
<tr>
<td class="rowlabel">
Mean (SD)
</td>
<td>
28.7 (15.0)
</td>
<td>
26.8 (12.0)
</td>
<td>
32.3 (15.7)
</td>
<td>
27.7 (13.2)
</td>
<td>
29.8 (15.3)
</td>
<td>
27.1 (12.3)
</td>
</tr>
<tr>
<td class="rowlabel">
Median [Min, Max]
</td>
<td>
25.0 [10.0, 131]
</td>
<td>
23.0 [13.0, 65.0]
</td>
<td>
29.0 [11.0, 119]
</td>
<td>
24.0 [12.0, 59.0]
</td>
<td>
26.0 [10.0, 131]
</td>
<td>
23.0 [12.0, 65.0]
</td>
</tr>
<tr>
<td class="rowlabel lastrow">
Missing
</td>
<td class="lastrow">
58 (19.5%)
</td>
<td class="lastrow">
15 (31.3%)
</td>
<td class="lastrow">
30 (22.2%)
</td>
<td class="lastrow">
11 (37.9%)
</td>
<td class="lastrow">
88 (20.3%)
</td>
<td class="lastrow">
26 (33.8%)
</td>
</tr>
<tr>
<td class="rowlabel firstrow">
testost
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
</tr>
<tr>
<td class="rowlabel">
Mean (SD)
</td>
<td>
25.3 (13.2)
</td>
<td>
22.2 (10.7)
</td>
<td>
27.6 (16.1)
</td>
<td>
28.2 (15.6)
</td>
<td>
26.0 (14.2)
</td>
<td>
24.4 (13.0)
</td>
</tr>
<tr>
<td class="rowlabel">
Median [Min, Max]
</td>
<td>
23.0 [4.00, 111]
</td>
<td>
21.5 [8.00, 63.0]
</td>
<td>
25.0 [6.00, 144]
</td>
<td>
24.0 [10.0, 69.0]
</td>
<td>
23.0 [4.00, 144]
</td>
<td>
22.0 [8.00, 69.0]
</td>
</tr>
<tr>
<td class="rowlabel lastrow">
Missing
</td>
<td class="lastrow">
6 (2.0%)
</td>
<td class="lastrow">
2 (4.2%)
</td>
<td class="lastrow">
3 (2.2%)
</td>
<td class="lastrow">
1 (3.4%)
</td>
<td class="lastrow">
9 (2.1%)
</td>
<td class="lastrow">
3 (3.9%)
</td>
</tr>
<tr>
<td class="rowlabel firstrow">
prolactn
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
</tr>
<tr>
<td class="rowlabel">
Mean (SD)
</td>
<td>
9.60 (5.10)
</td>
<td>
13.7 (12.3)
</td>
<td>
10.8 (6.79)
</td>
<td>
9.57 (3.29)
</td>
<td>
9.99 (5.70)
</td>
<td>
12.2 (10.1)
</td>
</tr>
<tr>
<td class="rowlabel">
Median [Min, Max]
</td>
<td>
8.16 [1.96, 37.3]
</td>
<td>
8.81 [3.87, 55.8]
</td>
<td>
9.30 [2.66, 59.9]
</td>
<td>
8.88 [4.49, 17.6]
</td>
<td>
8.64 [1.96, 59.9]
</td>
<td>
8.84 [3.87, 55.8]
</td>
</tr>
<tr>
<td class="rowlabel lastrow">
Missing
</td>
<td class="lastrow">
14 (4.7%)
</td>
<td class="lastrow">
0 (0%)
</td>
<td class="lastrow">
6 (4.4%)
</td>
<td class="lastrow">
1 (3.4%)
</td>
<td class="lastrow">
20 (4.6%)
</td>
<td class="lastrow">
1 (1.3%)
</td>
</tr>
</tbody>
</table>
</div>
<!--/html_preserve-->
</section><section><h2 class="section-heading" id="more-advanced-stuff">More advanced stuff<a class="anchor" aria-label="anchor" href="#more-advanced-stuff"></a>
</h2>
<hr class="half-width">
<p>We might want to be able to precisely control the summary statistics
presented in the table.</p>
<p>We can do that by specifying input to the arguments
<code>render.continuous</code> and <code>render.categorical</code> that
control how continuous and categorical data respecetively, is shown in
the table.</p>
<p>The simple way of doing that is by using abbrevieated function
names:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">table1</span><span class="op">(</span><span class="op">~</span><span class="va">sex</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">weight</span><span class="op">|</span><span class="va">treatment</span>, data <span class="op">=</span> <span class="va">dat</span>,</span>
<span>        render.continuous<span class="op">=</span><span class="fu">c</span><span class="op">(</span>.<span class="op">=</span><span class="st">"Mean (SD%)"</span>, .<span class="op">=</span><span class="st">"Median [Min, Max]"</span>,</span>
<span>                           <span class="st">"Geom. mean (Geo. SD%)"</span><span class="op">=</span><span class="st">"GMEAN (GSD%)"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(predvars, data, env): object 'sex' not found</code></pre>
</div>
<p><code>table1</code> recognizes the following summary statisticis: N,
NMISS, MEAN, SD, CV, GMEAN, GCV, MEDIAN, MIN, MAX, IQR, Q1, Q2, Q3, T1,
T2, FREQ, PCT</p>
<p>Details can be found in the help to the function
<code>stats.default()</code></p>
<p>Note that they are case-insensitive, and we can write Median or
mediAn instead of median.</p>
<p>Also note that we write <code>.="Mean (SD%)"</code> which will be
recognized as the functions <code>mean()</code> and <code>sd()</code>,
but also that the label shown should be “Mean (SD%)”.</p>
<p>If we want to specify the label, we can write
<code>"Geom. mean (Geo. SD%)"="GMEAN (GSD%)"</code></p>
<div id="change-the-labels" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="change-the-labels" class="callout-inner">
<h3 class="callout-title">Change the labels</h3>
<div class="callout-content">
<p>We have two unusual values in this table - geometric mean and
geometric standard deviation. Change the code to write out “Geom.” and
“geo.” as geometric.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">table1</span><span class="op">(</span><span class="op">~</span><span class="va">sex</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">weight</span><span class="op">|</span><span class="va">treatment</span>, data <span class="op">=</span> <span class="va">dat</span>,</span>
<span>        render.continuous<span class="op">=</span><span class="fu">c</span><span class="op">(</span>.<span class="op">=</span><span class="st">"Mean (SD%)"</span>, .<span class="op">=</span><span class="st">"Median [Min, Max]"</span>,</span>
<span>                           <span class="st">"Geometric mean (Geometric SD%)"</span><span class="op">=</span><span class="st">"GMEAN (GSD%)"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>The geometric mean of two numbers is the squareroot of the product of
the two numbers. If we have three numbers, we take the cube root of the
product. In general:</p>
<p><span class="math display">\[\left( \prod_{i=1}^{n} x_i
\right)^{\frac{1}{n}}\]</span></p>
<p>The geometric standard deviation is defined by: <span class="math display">\[ \exp\left(\sqrt{\frac{1}{n} \sum_{i=1}^{n}
\left( \log x_i - \frac{1}{n} \sum_{j=1}^{n} \log x_j
\right)^2}\right)\]</span></p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="very-advanced-stuff">Very advanced stuff<a class="anchor" aria-label="anchor" href="#very-advanced-stuff"></a>
</h2>
<hr class="half-width">
<p>If we want to specify the summary statistics very precisely, we have
to define a function ourself:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_summary</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu">c</span><span class="op">(</span><span class="st">""</span>,<span class="st">"Median"</span> <span class="op">=</span> <span class="fu">sprintf</span><span class="op">(</span><span class="st">"%.3f"</span>, <span class="fu">median</span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,</span>
<span><span class="st">"Variance"</span> <span class="op">=</span> <span class="fu">sprintf</span><span class="op">(</span><span class="st">"%.1f"</span>, <span class="fu">var</span><span class="op">(</span><span class="va">x</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">table1</span><span class="op">(</span><span class="op">~</span><span class="va">sex</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">weight</span><span class="op">|</span><span class="va">treatment</span>, data <span class="op">=</span> <span class="va">dat</span>,</span>
<span>render.continuous <span class="op">=</span> <span class="va">my_summary</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(predvars, data, env): object 'sex' not found</code></pre>
</div>
<p>We do not <em>need</em> to use the <code>sprintf()</code> function,
but it is a very neat way of combining text with numeric variables
because it allows us to format them directly.</p>
<p>Summary statistics for categorical data can be adjusted similarly, by
specifying <code>render.categorical</code>.</p>
<div id="what-does-.3f-actually-do" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="what-does-.3f-actually-do" class="callout-inner">
<h3 class="callout-title">What does %.3f actually do?</h3>
<div class="callout-content">
<p>Can you guess what the formatting in ´sprintf´ does?</p>
<p>Try to change “%.3f” in the function to “%.2f”.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_summary</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu">c</span><span class="op">(</span><span class="st">""</span>,<span class="st">"Median"</span> <span class="op">=</span> <span class="fu">sprintf</span><span class="op">(</span><span class="st">"%.3f"</span>, <span class="fu">median</span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,</span>
<span><span class="st">"Variance"</span> <span class="op">=</span> <span class="fu">sprintf</span><span class="op">(</span><span class="st">"%.1f"</span>, <span class="fu">var</span><span class="op">(</span><span class="va">x</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<p><code>sprintf</code> uses a bit of an arcane way of specifying the
way numbers should be formatted when we combine them with text. The
“%”-sign specifies that “this is where we place the number in the
function”. “.3f” specifies that we are treating the number as a floating
point number (which is just a fancy way of saying that it is a decimal
number), and that we would like three digits after the decimal
point.</p>
</div>
</div>
</div>
</div>
<div id="whats-up-with-that-blank-line" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="whats-up-with-that-blank-line" class="callout-inner">
<h3 class="callout-title">Whats up with that blank line?</h3>
<div class="callout-content">
<p>Note that in the function, we define a vector as output, with three
elements:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_summary</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu">c</span><span class="op">(</span><span class="st">""</span>,</span>
<span><span class="st">"Median"</span> <span class="op">=</span> <span class="fu">sprintf</span><span class="op">(</span><span class="st">"%.3f"</span>, <span class="fu">median</span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,</span>
<span><span class="st">"Variance"</span> <span class="op">=</span> <span class="fu">sprintf</span><span class="op">(</span><span class="st">"%.1f"</span>, <span class="fu">var</span><span class="op">(</span><span class="va">x</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<p>Calculating and formatting the median and the varianse is pretty
straightforward.</p>
<p>But the first element is an empty string. Whats up with that?</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<p>Try to remove the empty string from the function, and use it is a
table one as previously shown:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_summary</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu">c</span><span class="op">(</span><span class="st">"Median"</span> <span class="op">=</span> <span class="fu">sprintf</span><span class="op">(</span><span class="st">"%.3f"</span>, <span class="fu">median</span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,</span>
<span><span class="st">"Variance"</span> <span class="op">=</span> <span class="fu">sprintf</span><span class="op">(</span><span class="st">"%.1f"</span>, <span class="fu">var</span><span class="op">(</span><span class="va">x</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">table1</span><span class="op">(</span><span class="op">~</span><span class="va">sex</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">weight</span><span class="op">|</span><span class="va">treatment</span>, data <span class="op">=</span> <span class="va">dat</span>,</span>
<span>render.continuous <span class="op">=</span> <span class="va">my_summary</span><span class="op">)</span></span></code></pre>
</div>
<p>The line beginning with “Median” does not show up, but the median
value is shown next to the “Age” and “Weight” lines.</p>
</div>
</div>
</div>
</div>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div> Instructor Note </h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" data-bs-parent="#accordionInstructor1" aria-labelledby="headingInstructor1">
<div class="accordion-body">
<p>Primarily of use if there are medical students on the course</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>A Table One provides a compact describtion of the data we are
working with</li>
<li>With a little bit of work we can control the content of the
table.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-tidy-data"><p>Content from <a href="tidy-data.html">Tidy Data</a></p>
<hr>
<p>Last updated on 2024-10-07 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/tidy-data.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 12 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do you write a lesson using R Markdown and
<a href="https://carpentries.github.io/sandpaper/" class="external-link">sandpaper</a>?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain what tidy data is</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>Most of what we want to do with our data is relatively simple.
<em>If</em> the data is structured in the right way.</p>
<p>Working within the paradigm of <code>tidyverse</code> it is
preferable if the data is <em>tidy</em>.</p>
<figure><img src="../fig/tidy_why.jpg" alt="" class="figure mx-auto d-block"></figure><p>Tidy data is not the opposite of messy data. Data can be nice and
well structured, tidy as in non-messy, without being tidy in the way we
understand it in this context.</p>
<figure><img src="../fig/tidy_hadley_2.jpg" alt="" class="figure mx-auto d-block"></figure><p>Tidy data in the world of R, especially the dialect of R we call
tidyverse, are characterized by:</p>
<ul>
<li>Each variable is a column; each column is a variable.</li>
<li>Each observation is a row; each row is an observation.</li>
<li>Each value is a cell; each cell is a single value.</li>
</ul>
<figure><img src="../fig/tidy_hadley.jpg" alt="" class="figure mx-auto d-block"></figure><p>This way of structuring our data is useful not only in R, but also in
other software packages.</p>
</section><section><h2 class="section-heading" id="an-examples">An examples<a class="anchor" aria-label="anchor" href="#an-examples"></a>
</h2>
<hr class="half-width">
<p>This is an example of untidy data, on new cases of tubercolosis in
Afghanistan. It is well structured, however there are information in the
column names.</p>
<p>“new_sp_m014” describes “new” cases. Diagnosed with the “sp” method
(culturing a sample of sputum and identifying the presence of
Mycobacterium Tuberculosis bacteria). In “m” meaning males, between the
ages of 0 and 14.</p>
<p>Picking out information on all new cases eg. distribution between the
two sexes is difficult. Similar problems arise if we want to follow the
total number of new cases.</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 10 × 6
   country      year new_sp_m014 new_sp_m1524 new_sp_m2534 new_sp_m3544
   &lt;chr&gt;       &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;
 1 Afghanistan  2000          52          228          183          149
 2 Afghanistan  2001         129          379          349          274
 3 Afghanistan  2002          90          476          481          368
 4 Afghanistan  2003         127          511          436          284
 5 Afghanistan  2004         139          537          568          360
 6 Afghanistan  2005         151          606          560          472
 7 Afghanistan  2006         193          837          791          574
 8 Afghanistan  2007         186          856          840          597
 9 Afghanistan  2008         187          941          773          545
10 Afghanistan  2009         200          906          705          499</code></pre>
</div>
<p>Getting this data on a tidy format is not trivial, but a resulting,
tidy, organised dataset would look something like this:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 40 × 7
   country      year new   method sex   age_group cases
   &lt;fct&gt;       &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;  &lt;fct&gt; &lt;fct&gt;     &lt;dbl&gt;
 1 Afghanistan  2000 new   sp     m     0-14         52
 2 Afghanistan  2000 new   sp     m     15-24       228
 3 Afghanistan  2000 new   sp     m     25-34       183
 4 Afghanistan  2000 new   sp     m     35-44       149
 5 Afghanistan  2001 new   sp     m     0-14        129
 6 Afghanistan  2001 new   sp     m     15-24       379
 7 Afghanistan  2001 new   sp     m     25-34       349
 8 Afghanistan  2001 new   sp     m     35-44       274
 9 Afghanistan  2002 new   sp     m     0-14         90
10 Afghanistan  2002 new   sp     m     15-24       476
# ℹ 30 more rows</code></pre>
</div>
<p>The fact that we are recording “new” cases is now a variable in it
self. The method used is also a variable, and the categorical variabel
sex is similarly a separate variable as is the age group.</p>
<p>The variables <code>new</code>, <code>method</code> and
<code>sex</code> might appear redundant - all values are identical,
however the entire dataset contains data on non-new cases, other methods
for diagnosis and the other sex, recorded as “f”.</p>
</section><section><h2 class="section-heading" id="dos-and-donts-in-excel">Do’s and dont’s in Excel<a class="anchor" aria-label="anchor" href="#dos-and-donts-in-excel"></a>
</h2>
<hr class="half-width">
<p>Excel is a very useful tool, especially for collecting data.</p>
<p>But even though we are able to do everything we can do in R, in
Excel, we will normally do the main part of our work with data in R.</p>
<p>It is therefor a very good idea to think about how we collect and
organise the data in Excel, to make our life easier later on.</p>
<p>We have collected some good rules of thumb for structuring data in
Excel, based on time-consuming and traumatic experiences wrangling data
from Excel to R.</p>
<p><strong>Always</strong></p>
<ul>
<li>Use one column for one variable</li>
<li>Use one row for one observation</li>
<li>Use one cell for one value</li>
<li>Begin your data in the upper left corner (cell A1)</li>
<li>Use one sheet for each type of data</li>
</ul>
<p><strong>Never (EVER!)</strong></p>
<ul>
<li>Modify your raw data - always make a copy before making any
change</li>
<li>Merge cells</li>
<li>Use colors for information</li>
</ul>
<p>Illustrations from the Openscapes blog Tidy Data for reproducibility,
efficiency, and collaboration by Julia Lowndes and Allison Horst</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>tidy data provides a consistent way of organizing data</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-normal-distribution"><p>Content from <a href="normal-distribution.html">The normal distribution</a></p>
<hr>
<p>Last updated on 2024-10-07 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/normal-distribution.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 12 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do you write a lesson using R Markdown and
<a href="https://carpentries.github.io/sandpaper/" class="external-link">sandpaper</a>?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to use markdown with the new lesson template</li>
<li>Demonstrate how to include pieces of code, figures, and nested
challenge blocks</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="the-normal-distribution">The Normal Distribution<a class="anchor" aria-label="anchor" href="#the-normal-distribution"></a>
</h2>
<hr class="half-width">
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div> Instructor Note </h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" data-bs-parent="#accordionInstructor1" aria-labelledby="headingInstructor1">
<div class="accordion-body">
<p>Inline instructor notes can help inform instructors of timing
challenges associated with the lessons. They appear in the “Instructor
View”</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="what-is-the-normal-distribution">What is the normal distribution<a class="anchor" aria-label="anchor" href="#what-is-the-normal-distribution"></a>
</h2>
<hr class="half-width">
<p>A probability distribution is a mathematical function, that describes
the likelyhood of different outcomes in a random experiment. It gives us
probabilities for all possible outcomes, and is normalised so that the
sum of all the probabilities is 1.</p>
<p>Probability distribtutions can be discrete, or they can be
continuous. The normal distribution is just one of several different
continuous probability distributions.</p>
<p>The normal distribution is especially important, for a number of
reasons:</p>
<ol style="list-style-type: decimal">
<li><p>If we take a lot of samples from a population and calculate the
averages of a given variable in those samples, the averages, or means
will be normally distributed. This is know as the Central Limit Theorem
[KAN VI SÆTTE ET LINK IND?]</p></li>
<li><p>Many natural (and human made) processes follow a normal
distribution.</p></li>
<li><p>The normal distribution have useful mathematical properties. It
might not appear to be simple working with the normal distribution. But
the alternative is worse.</p></li>
<li><p>Many statistical methods and tests are based on assumptions of
normality.</p></li>
</ol></section><section><h2 class="section-heading" id="how-does-it-look">How does it look?<a class="anchor" aria-label="anchor" href="#how-does-it-look"></a>
</h2>
<hr class="half-width">
<p>The normal distribution follows this formula:</p>
<p><span class="math display">\[
f(x) = \frac{1}{\sqrt{2\pi\sigma^2}} e^{-\frac{(x-\mu)^2}{2\sigma^2}}
\]</span></p>
<p>If a variable in our population is normally distributed, have a mean
<span class="math inline">\(\mu\)</span> and a standard deviation <span class="math inline">\(\sigma\)</span>, we can find the probability of
observing the value <span class="math inline">\(x\)</span> of the
varibel by plugging in the values, and calculate <span class="math inline">\(f(x)\)</span>.</p>
<p>Note that we are here working with the population mean and standard
deviation. Those are the “true” mean and standard deviation for the
<em>entire</em> universe. That is signified by using the greek letters
<span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>. In practise we do not know what
those true values are.</p>
<div class="section level3">
<h3 id="what-does-it-mean-that-our-data-is-normally-distributed">What does it mean that our data is normally distributed<a class="anchor" aria-label="anchor" href="#what-does-it-mean-that-our-data-is-normally-distributed"></a>
</h3>
<p>We have an entire section on that - but in short: The probabilities
we get from the formula above should match the frequencies we observe in
our data.</p>
</div>
</section><section><h2 class="section-heading" id="how-does-it-look-1">How does it look?<a class="anchor" aria-label="anchor" href="#how-does-it-look-1"></a>
</h2>
<hr class="half-width">
<p>It is useful to be able to compare the distributions of different
variables. That can be difficult if one have a mean of 1000, and the
other have a mean of 2. Therefore we often work with standardized normal
distributions, where we transform the data to have a mean of 0 and a
standard deviation of 1. So let us look at the standardized normal
distribution.</p>
<p>If we plot it, it looks like this:</p>
<p><img src="../fig/The_Normal_Distribution.svg" alt="The Normal Distribution." class="figure"> The area under the curve is 1,
equivalent to 100%.</p>
<p>The normal distribution have a lot of nice mathematical properties,
some of which are indicated on the graph.</p>
<p>CDF-plottet - så vi har forbindelsen til den deskriptive
statistik.</p>
<p>Konceptet med - hvad er sandsynligheden for at se en observation der
ligger x standardafvigelser fra middelværdien.</p>
<p>This allows us to calculate the probability of finding a certain
value in the data, if the data is normally distributed, if we know the
mean and the standard deviation.</p>
<p>R provides us with a set of functions:</p>
<p>pnorm the probability of having a smaller value than. qnorm the value
corresponding to a given probability dnorm the probability density of
the norma distribution at a given x.</p>
<p>Og det er for den standardiserede normalfordeling N(0,1)</p>
<p>De har mulighed for at returnere værdier for en hvilken som helst
normalfordeling med arbitrære middelværdi og standardafvigelse.</p>
<p>An example:</p>
<p>If the height of men are normally distributed, with a mean (mu) = 183
cm, and a standarddeviation of 9.7 cm. How probably is it to find a man
that is taller than 2 meters?</p>
<p>Directly:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span> <span class="op">-</span> <span class="fu">pnorm</span><span class="op">(</span><span class="fl">200</span>,<span class="fl">183</span>,<span class="fl">9.7</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.03983729</code></pre>
</div>
<p>In this example, pnorm returns the probability of an observation
smaller than 200, if data is normally distributed with mean 183, and
standard deviation 9.7.</p>
<p>The probability of finding any observation is 1. So the probability
of finding an observation larger than 200, is 1 minus the probability of
finding an observation smaller than 200.</p>
<p>Manually we could calculate the distance from 200 to 183 = 17. And
divide that with the standard deviation 9.7: 17/9.7 = 1.752577.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span> <span class="op">-</span> <span class="fu">pnorm</span><span class="op">(</span><span class="fl">1.752577</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.03983732</code></pre>
</div>
<p>How many men are between 170 and 190 cm tall? Lidt før dette punkt
skal vi videre til næste lesson.</p>
<p>Og efter clt videre til hypotesetests</p>
</section><section><h2 class="section-heading" id="clt">CLT<a class="anchor" aria-label="anchor" href="#clt"></a>
</h2>
<hr class="half-width">
<p>CLT fører til at vi kan betragte middelværdien for vores data som
normalfordelt. selv når disse data ikke <em>er</em> normalfordelte.</p>
<p>I praksis bruger vi t-fordelingen, der ser lidt anderledes ud - vi
har nemlig ikke kendskab til hele populationens sande middelværdi og
varians. t-fordelingen har tykkere haler, der giver os større sikkerhed
for vores konklusioner.</p>
<p>Hvad gør vi så? Hvis vi tager i princippet uendeligt mange
stikprøver, samples, og beregner middelværdierne, så vil disse
middelværdier følge normalfordelingen.</p>
<p>hvis vi fremstiller linealer, og har en tese om at de er præcist 20
cm lange, som de skal være. det er mu</p>
<p>Nu tager vi en stikprøve på størrelsen “n” fra produktionen. Måler
dem, og beregner gennemsnittet.</p>
<p>Måler vi præcist nok, vil det gennemsnit formentlig adskille sig fra
20 cm. Det gennemsnit er X-bar.</p>
<p>I dette tilfælde antager vi at vi kender standardafvigelsen for vores
produktion.</p>
<p>Hvis vi normerer alle vores målinger, så gennemsnittet er 0. Det gør
vi ved at trække gennemsnittet fra alle målinger. Og så
standardafvigelsen er 1. Det gør vi ved at dividere alle målinger med
standardafvigelsen.</p>
<p>Så vil gennemsnittet af vores stikprøve, fordi CLT, følge en
normalfordeling. Og vi kan se hvor det gennemsnit, denne z-score,
placerer sig på den sande normalfordeling.</p>
<p>og ud fra de matematiske egenskaber fra normalfordelingen, kan vi se
hvor underlig den middelværdi vi måler, er.</p>
<p>og det er stadig ikke en specielt god forklaring…</p>
<div class="section level3">
<h3 id="fordelingsfunktionerne-i-r-">Fordelingsfunktionerne i R.<a class="anchor" aria-label="anchor" href="#fordelingsfunktionerne-i-r-"></a>
</h3>
<p>De hyppigst forekommende fordelinger har hver deres sæt af
funktioner.</p>
<div class="section level4">
<h4 id="rnorm">rnorm<a class="anchor" aria-label="anchor" href="#rnorm"></a>
</h4>
<p>I samme familie finder vi runif, rbeta og en del andre:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rnorm</span><span class="op">(</span><span class="fl">5</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span> <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1]  1.7391252 -2.5664506 -0.4088902 -0.5396592  1.6811075</code></pre>
</div>
<p>Den returnerer (her) fem tilfældige værdier fra en normalfordeling
med (her) middelværdi 0 og standardafvigelse 1.</p>
</div>
<div class="section level4">
<h4 id="dnorm">dnorm<a class="anchor" aria-label="anchor" href="#dnorm"></a>
</h4>
<p>densiteten. I plottet er det værdien på y-aksen af kurven.</p>
</div>
<div class="section level4">
<h4 id="pnorm">pnorm<a class="anchor" aria-label="anchor" href="#pnorm"></a>
</h4>
<p>Den kumulative fordeling. Hvis x er 0, er arealet fra minus uendelig
til 0 lig pnorm(0). Og hvis vi bruger defaulet mean og sd, er det så
0.5. Sandsynligheden for en værdi mindre end x.</p>
</div>
<div class="section level4">
<h4 id="qnorm">qnorm<a class="anchor" aria-label="anchor" href="#qnorm"></a>
</h4>
<p>det er så den omvendte funktion af pnorm. Husk det på at et q er det
omvendte af et p.</p>
<p>i pnorm finder vi sandsynligheden for at værdien er mindre end x. I
qnorm finder vi x for en given sandsynlighed.</p>
</div>
</div>
</section><section><h2 class="section-heading" id="er-ting-normalfordelte">Er ting normalfordelte?<a class="anchor" aria-label="anchor" href="#er-ting-normalfordelte"></a>
</h2>
<hr class="half-width">
<p>Normalfordelingen kaldes normal fordi Karl Pearson og Francis Galton
i det 19. århundrede observerede at det var en statistisk fordeling der
forklarede rigtig mange fænomener i befolkningsdata. Højde, vægt,
blodtryk, intelligenskvotienter mv. Faktisk var det den der forklarede
flest (af de ting de nu undersøgte).</p>
<p>Og så er det i øvrigt den fordeling som middelværdier af stikprøver
vil tilnærme sig jf. den centrale grænseværdisætning.</p>
<p>Så den er normal fordi det er normen, den hyppigst forekommende. Ikke
at forveksle med en mere løs, dagligsprogs, normativ (pun intended)
anvendelse af ordet norm. Normalen i en statistisk sammenhæng er ganske
enkelt den hyppigst forekommende observation.</p>
<p>Det i statistisk forstand normale, normen, er at have brune øjne
(&gt;50% af klodens befolkning har brune øjne). Det betyder ikke at der
er noget galt med at have blå øjne.</p>
<p>Og rigtig mange ting er ret tæt på at være normalfordelte. Men i
virkeligheden er der ikke mange fænomener der følger normalfordelingen
fuldstændig. Et eksempel:</p>
<p>Serum (en del af blod) Molybdæn (der er et essentielt sporstof i
human fysiologi), har en middelværdi på 1.55 og en standardafvigelse på
0.74 hos normale, raske mennesker.</p>
<p>Rifai, N. (2017). Tietz textbook of clinical chemistry and molecular
diagnostics : Tietz textbook of clinical chemistry and molecular
diagnostics - e-book. Elsevier - Health Sciences Division.</p>
<p>Hvis vi antager at serum-Molybdæn er normalfordelt i populationen,
kan vi beregne hvor stor en andel af den normale raske befolkning i
danmark, der har en Molybdæn-koncentration under 0:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pnorm</span><span class="op">(</span><span class="fl">0</span>, mean <span class="op">=</span> <span class="fl">1.55</span>, sd <span class="op">=</span> <span class="fl">0.74</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.01810352</code></pre>
</div>
<p>Hvilket vil sige at vi forventer at lidt over 100.000 danskere har et
negativt indhold af Molybdæn i blodet. Hvilket er fysisk umuligt.
Hvorfor går det så godt alligevel? Fordi serum molybdæn er normalfordelt
<em>nok</em>.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Use <code>.md</code> files for episodes when you want static
content</li>
<li>Use <code>.Rmd</code> files for episodes when you need to generate
output</li>
<li>Run <code>sandpaper::check_lesson()</code> to identify any issues
with your lesson</li>
<li>Run <code>sandpaper::build_lesson()</code> to preview your lesson
locally</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-is-it-normal"><p>Content from <a href="is-it-normal.html">Testing for normality</a></p>
<hr>
<p>Last updated on 2024-10-07 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/is-it-normal.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 12 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do we determine if a dataset might be normally distributed?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to use markdown with the new lesson template</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">palmerpenguins</span><span class="op">)</span></span></code></pre>
</div>
<section><h2 class="section-heading" id="how-to-test-if-our-data-is-normally-distributed">How to test if our data is normally distributed?<a class="anchor" aria-label="anchor" href="#how-to-test-if-our-data-is-normally-distributed"></a>
</h2>
<hr class="half-width">
<p>Common question - is my data normally distributed?</p>
<p>What does it mean that it is normally distributed? It means that the
distribution of our data has the same properties as the normal
distribution.</p>
<p>Let us get some data that we can test:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">normal_test_data</span> <span class="op">&lt;-</span> <span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">species</span> <span class="op">==</span> <span class="st">"Chinstrap"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">bill_depth_mm</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="mean-and-median">Mean and median<a class="anchor" aria-label="anchor" href="#mean-and-median"></a>
</h3>
<p>One of the properties of the normal distribution is that the mean and
median of the data is equal. Let us look at the penguins:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="va">normal_test_data</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> bill_depth_mm
 Min.   :16.40
 1st Qu.:17.50
 Median :18.45
 Mean   :18.42
 3rd Qu.:19.40
 Max.   :20.80  </code></pre>
</div>
<p>This is actually pretty close! But equality between median and mean
is a neccesary, not a sufficient condition.</p>
<p>What next. A histogram of the data should look normal. Let us take a
closer look at bill_depth_mm where mean and median are closest:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">normal_test_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">bill_depth_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<figure><img src="../fig/is-it-normal-rendered-histogram-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>This does not really look like a normal distribution. The fact that
mean and median are almost identical was not a sufficient criterium for
normalcy.</p>
<p>The shape of a histogram is heavily dependent on the bins we choose.
A better way of visualizing often density-plots:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">normal_test_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">bill_depth_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_density</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/is-it-normal-rendered-densityplot-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>We can think of this as a histogram with infinitely small bins.</p>
<p>This does look more normal - but it would be nice to be able to
quantize the degree of normalcy.</p>
</div>
</section><section><h2 class="section-heading" id="percentiels-and-qq-plots-as-a-test">Percentiels and QQ-plots as a test<a class="anchor" aria-label="anchor" href="#percentiels-and-qq-plots-as-a-test"></a>
</h2>
<hr class="half-width">
<p>The properties of the normal distribution informs us that 50% of the
observations in the data are smaller than the mean (and conversely 50%
are larger). We alson know that 50% of the observations should be in the
interquartile range. And what we also know is that 2.5% of the
observations (the 2.5 percentile) are smaller than the mean minus 1.96
times the standard deviation.</p>
<p>Actually we can calculate exactly which percentile a given
observation is in. And we we can calculate which value a given
percentile should have.</p>
<p>Comparing those gives us an indication of how well the data conforms
to a normal distribution.</p>
<p>Rather than doing that by hand, we can get R to do it for us in a
nice graphical way:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">normal_test_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>sample <span class="op">=</span> <span class="va">bill_depth_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_qq</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_qq_line</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/is-it-normal-rendered-qq-plot-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The <code>geom_qq</code> function calculate and plots which
percentile an observation is in.</p>
<p>Rather than being given percentiles, we are given the value that the
percentile corresponds to if we calculate it as number of standard
deviations from the mean.</p>
<p>This results in plots that are more comparable.</p>
<p><code>geom_qq_line</code> plots the line corresponding til the values
the percentiles should have, if the data was normally distributed.</p>
<p>A common theme is that the midle of the data falls relatively close
to the line, and that there are deviations from the line at both ends.
In this case the deviations are largish, indicating that the data is not
normally distributed.</p>
<div id="callout1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout</h3>
<div class="callout-content">
<p>We have two tails in the qq-plot, a left and a right. And they can be
either above or below the qq-line.</p>
<p>That results in four different cases, that informs us about what is
wrong with the data - in regards to how it deviates from normalcy.</p>
<table class="table">
<colgroup>
<col width="15%">
<col width="15%">
<col width="15%">
<col width="54%">
</colgroup>
<thead><tr class="header">
<th>Left tail</th>
<th>Right tail</th>
<th>Name</th>
<th>What</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Above</td>
<td>Below</td>
<td>Leptokurtic</td>
<td>Heavier tails - ie. more extreme values. Higher kurtosis</td>
</tr>
<tr class="even">
<td>Below</td>
<td>Above</td>
<td>Platykurtic</td>
<td>Lighter tails - ie. fewer extreme values. Lower kurtosis</td>
</tr>
<tr class="odd">
<td>Above</td>
<td>Above</td>
<td>Right skewed</td>
<td>A tail that stretches to the higher values - the extreme values are
larger.</td>
</tr>
<tr class="even">
<td>Below</td>
<td>Below</td>
<td>Left skewed</td>
<td>A tail that stretches to the lower values - the extreme values are
smaller.</td>
</tr>
</tbody>
</table>
<figure><img src="../fig/is-it-normal-rendered-unnamed-chunk-1-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="numerical-measures-rather-than-graphical">Numerical measures rather than graphical<a class="anchor" aria-label="anchor" href="#numerical-measures-rather-than-graphical"></a>
</h2>
<hr class="half-width">
<p>With experience the qq-plots can be used to determine if the data is
normally distributed - the points are exactly on the line. But only
rarely the points matches exactly - even if the data is normally
distributed <em>enough</em>. And how much can the tails deviate from the
line before the data is not normally distributed <em>enough</em>?</p>
<p>The deviations can be described numerically using two parameters:</p>
<p>Kurtosis and skewness.</p>
<p>Base-R do not have functions for this, but the package
<code>e1071</code> does.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">e1071</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">skewness</span><span class="op">(</span><span class="va">normal_test_data</span><span class="op">$</span><span class="va">bill_depth_mm</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.006578141</code></pre>
</div>
<p>kurtosis</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">kurtosis</span><span class="op">(</span><span class="va">normal_test_data</span><span class="op">$</span><span class="va">bill_depth_mm</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] -0.960087</code></pre>
</div>
<p>As a rule of thumb, skewness should be within +/-0.5 if the data is
normally distributed. Values between +/-0.5 and +/- 1 indicates a
moderate skewness, where data <em>can</em> still be approximately
normally distributed. Values larger that +/-1 indicates a significant
skewness, and the data is probably not normally distributed.</p>
<p>For the kurtosis matters are a bit more complicated as the kurtosis
for a normal distribution is 3. We therefore look at excess kurtosis,
where i subtract 3 from the calculated kurtosis. An value of +/-1 exces
kurtosis indicates that the data has a ‘tailedness’ close to the normal
distribution. Values between +/-1 and +/-2 indicates a moderate
deviation from the normal distribution, but the data can still be
approximately normally distributed. Values larger than +/-2 is in
general taken as an indication that the data is not normally
distributed.</p>
<p>The absolute value of the excess kurtosis is larger than 2,
indicating that the data is not normally distributed.</p>
</section><section><h2 class="section-heading" id="more-direct-tests">More direct tests<a class="anchor" aria-label="anchor" href="#more-direct-tests"></a>
</h2>
<hr class="half-width">
<p>The question of wether or not data is normally distributed is
important in many contexts, and it should come as no surprise that a
multitude of tests has been devised for testing exactly that.</p>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div> Instructor Note </h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" data-bs-parent="#accordionInstructor1" aria-labelledby="headingInstructor1">
<div class="accordion-body">
<p>These tests can be difficult for learners that have not encountered
hypothesis-testing before.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="shapiro-wilk">Shapiro-Wilk<a class="anchor" aria-label="anchor" href="#shapiro-wilk"></a>
</h3>
<p>The Shapiro-Wilk test is especially suited for small sample sizes
(&lt;50, some claim it works well up to &lt;2000).</p>
<p>It is a measure of the linear correlation between data and the
normally distributed quantiles, what we see in the qqplot.</p>
<p>The null-hypothesis is that data is normally distributed, and the
Shapiro-Wilk test returns a p-value reporting the risk of being wrong if
we reject the null-hypothesis.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">shapiro.test</span><span class="op">(</span><span class="va">normal_test_data</span><span class="op">$</span><span class="va">bill_depth_mm</span><span class="op">)</span> </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Shapiro-Wilk normality test

data:  normal_test_data$bill_depth_mm
W = 0.97274, p-value = 0.1418</code></pre>
</div>
<p>The p-value in this case is 0.1418 - and we do not have enough
evidense to reject the null-hypothesis. The data is probably normally
distributed.</p>
</div>
<div class="section level3">
<h3 id="kolmogorov-smirnov">Kolmogorov-Smirnov<a class="anchor" aria-label="anchor" href="#kolmogorov-smirnov"></a>
</h3>
<p>The KS-test allows us to test if the data is distributed as a lot of
different distributions, not only the normal distribution. Because of
this, we need to specify the specific distribution we are testing for,
in this case a normal distribution with specific values for mean and
standard deviation.</p>
<p>Therefore we need to calculate those:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mean</span> <span class="op">&lt;-</span> <span class="fu">mean</span><span class="op">(</span><span class="va">normal_test_data</span><span class="op">$</span><span class="va">bill_depth_mm</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">sd</span> <span class="op">&lt;-</span> <span class="fu">sd</span><span class="op">(</span><span class="va">normal_test_data</span><span class="op">$</span><span class="va">bill_depth_mm</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">ks.test</span><span class="op">(</span><span class="va">normal_test_data</span><span class="op">$</span><span class="va">bill_depth_mm</span>, <span class="st">"pnorm"</span>, mean <span class="op">=</span> <span class="va">mean</span>, sd <span class="op">=</span> <span class="va">sd</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning in ks.test.default(normal_test_data$bill_depth_mm, "pnorm", mean =
mean, : ties should not be present for the one-sample Kolmogorov-Smirnov test</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Asymptotic one-sample Kolmogorov-Smirnov test

data:  normal_test_data$bill_depth_mm
D = 0.073463, p-value = 0.8565
alternative hypothesis: two-sided</code></pre>
</div>
<p>In this test the null-hypothesis is also that data is normally
distributed. The p-values is very high, and therefore we cannot reject
the null-hypothesis. Again, this is not the same as the data
<em>actually</em> being normally distributed.</p>
<p>This test assumes that there are no repeated values in the data, as
that can affect the precision of the test. The p-value is still very
high, and we will conclude that we cannot rule out that the data is not
normally distributed.</p>
<p>Note that the KS-test assumes that we actually know the true mean and
standard deviation. Here we calculate those values based on the sample,
which is problematic.</p>
</div>
<div class="section level3">
<h3 id="liliefors-test">Liliefors test<a class="anchor" aria-label="anchor" href="#liliefors-test"></a>
</h3>
<p>This is a variation on the KS-test, that is designed specifically for
testing for normality. It does not require us to know the true mean and
standard deviation for the population.</p>
<p>This test is also not available in base-R, but can be found in the
<code>nortest</code> package:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">nortest</span><span class="op">)</span></span>
<span><span class="fu">lillie.test</span><span class="op">(</span><span class="va">normal_test_data</span><span class="op">$</span><span class="va">bill_depth_mm</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Lilliefors (Kolmogorov-Smirnov) normality test

data:  normal_test_data$bill_depth_mm
D = 0.073463, p-value = 0.483</code></pre>
</div>
<p>Again the p-value is so high, that we cannot reject the
null-hypothesis.</p>
</div>
<div class="section level3">
<h3 id="anderson-darling-test">Anderson-Darling test<a class="anchor" aria-label="anchor" href="#anderson-darling-test"></a>
</h3>
<p>This test is more sensitive for deviations in the tails.</p>
<p>It is not available in base-R, but can be found in the
<code>nortest</code> package.</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ad.test</span><span class="op">(</span><span class="va">normal_test_data</span><span class="op">$</span><span class="va">bill_depth_mm</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Anderson-Darling normality test

data:  normal_test_data$bill_depth_mm
A = 0.44788, p-value = 0.2714</code></pre>
</div>
<p>In this case the null-hypothesis is also that data is normally
distributed, and the p-value indicates that we cannot reject the
null-hypothesis.</p>
</div>
</section><section><h2 class="section-heading" id="and-is-it-actually-normally-distributed">And is it actually normally distributed?<a class="anchor" aria-label="anchor" href="#and-is-it-actually-normally-distributed"></a>
</h2>
<hr class="half-width">
<p>Probably not. Except for the excess kurtosis all the tests we have
done indicate that the depth of the beaks of chinstrap penguins can be
normally distributed. Or rather, that we cannot reject the
null-hypothesis that they are normally distributed.</p>
<p>But the fact that we cannot reject this hypothesis is not the same as
concluding that the data actually <strong>is</strong> normally
distributed.</p>
<p>Based on the excess kurtosis and the qq-plot, it would be reasonable
to conclude that it is not.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Use <code>.md</code> files for episodes when you want static
content</li>
<li>Use <code>.Rmd</code> files for episodes when you need to generate
output</li>
<li>Run <code>sandpaper::check_lesson()</code> to identify any issues
with your lesson</li>
<li>Run <code>sandpaper::build_lesson()</code> to preview your lesson
locally</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-which-distribution"><p>Content from <a href="which-distribution.html">How is the data distributed?</a></p>
<hr>
<p>Last updated on 2024-10-07 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/which-distribution.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 12 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>If my data is not normally distributed - which distribution does it
actually follow?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Show how to identify possible distributions describing the data</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>Your data was not normally distributed. Now what?</p>
<p>The process generating your data is probably following some
distribution. The size distribution of cities appears to follow a Pareto
distibution, as is wealth. The number of mutations in a string of DNA
appears to follow a poisson distribution. And the distribution of wind
speeds as well as times to failure for technical components both follow
the Weibull distribution.</p>
<p>If you have a theoretical foundation for which distribution you data
generating function follows, that is nice.</p>
<p>If you do not - we will be interested in figuring out which
distribution your data actually follow.</p>
</section><section><h2 class="section-heading" id="how">How?<a class="anchor" aria-label="anchor" href="#how"></a>
</h2>
<hr class="half-width">
<p>We fit our data to a distribution. Or rather - we fit the data to
several different distributions and then choose the best.</p>
<p>Let us look at some data. The <code>faithful</code> data set contains
272 observations of the Old Faithful geyser in Yellowstone National Park
in USA. We only look at eruptions that lasts longer than 3 minutes:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span>
<span><span class="va">eruption_example</span> <span class="op">&lt;-</span> <span class="va">faithful</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">eruptions</span> <span class="op">&gt;</span> <span class="fl">3</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">select</span><span class="op">(</span><span class="va">eruptions</span><span class="op">)</span></span></code></pre>
</div>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div> Instructor Note </h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" aria-labelledby="headingInstructor1" data-bs-parent="#accordionInstructor1">
<div class="accordion-body">
<p>Det er nødvendigt at specificere at vi bruger
<code>dplyr::select</code> da den maskeres af MASS-pakken</p>
</div>
</div>
</div>
</div>
<p>Rather than testing a lot of different distributions, we can use the
<code>gamlss</code> package, and two add-ons to that.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">gamlss</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">gamlss.dist</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">gamlss.add</span><span class="op">)</span></span></code></pre>
</div>
<p><code>gamlss</code> has the advantage of implementing a <em>lot</em>
of different statistical distributions.</p>
<p>The function <code>fitDist()</code> from <code>gamlss</code> will fit
the data to a selection of different statistical distributions,
calculate a measure of the goodness of fit, and return the best fit (and
information on all the others). Rather than testing against all 97
different distributions supported by <code>gamlss</code>, we can specify
only a selection, in this case <code>realplus</code>, that only includes
the 23 distributions that are defined for positive, real numbers:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">fitDist</span><span class="op">(</span><span class="va">eruptions</span>, type <span class="op">=</span> <span class="st">"realplus"</span>, data <span class="op">=</span> <span class="va">eruption_example</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  |                                                                              |                                                                      |   0%  |                                                                              |===                                                                   |   4%  |                                                                              |======                                                                |   9%  |                                                                              |=========                                                             |  13%  |                                                                              |============                                                          |  17%</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  |                                                                              |===============                                                       |  22%  |                                                                              |==================                                                    |  26%  |                                                                              |=====================                                                 |  30%  |                                                                              |========================                                              |  35%  |                                                                              |===========================                                           |  39%  |                                                                              |==============================                                        |  43%</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  |                                                                              |=================================                                     |  48%  |                                                                              |=====================================                                 |  52%</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  |                                                                              |========================================                              |  57%  |                                                                              |===========================================                           |  61%  |                                                                              |==============================================                        |  65%</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  |                                                                              |=================================================                     |  70%  |                                                                              |====================================================                  |  74%</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  |                                                                              |=======================================================               |  78%  |                                                                              |==========================================================            |  83%Error in solve.default(oout$hessian) :
  Lapack routine dgesv: system is exactly singular: U[4,4] = 0
  |                                                                              |=============================================================         |  87%Error in solve.default(oout$hessian) :
  Lapack routine dgesv: system is exactly singular: U[4,4] = 0
  |                                                                              |================================================================      |  91%  |                                                                              |===================================================================   |  96%  |                                                                              |======================================================================| 100%</code></pre>
</div>
<p>If you do this yourself, you will notice a lot of error-messages. It
is not possible to fit this particular data to <em>all</em> the
distributions, and the ones where the fit fails (enough), we will get an
error message.</p>
<p>The output from <code>fitDist()</code> will return the best fit:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Family:  c("WEI2", "Weibull type 2")
Fitting method: "nlminb"

Call:  gamlssML(formula = y, family = DIST[i])

Mu Coefficients:
[1]  -18.69
Sigma Coefficients:
[1]  2.524

 Degrees of Freedom for the fit: 2 Residual Deg. of Freedom   173
Global Deviance:     175.245
            AIC:     179.245
            SBC:     185.574 </code></pre>
</div>
<p>We are told that the statistical distribution that best fits the data
is <code>Weibull type 2</code> and that the AIC-measurement of goodness
of fit is 170.245.</p>
<div id="callout1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout</h3>
<div class="callout-content">
<p>Is that a good fit? That is a good question. It strongly depends on
the values in the dataset. In this dataset, the length of the eruptions
are measured in minutes If we choose to measure that length in another
unit, eg seconds, the distribution should not change. But the AIC
will.</p>
<p>We can use the AIC to decide that one distribution fits the data
better than another, but not to conclude that that distribution is the
correct one.</p>
</div>
</div>
</div>
<p>The <code>fit</code> object containing the output of the
<code>fitDist()</code> function contains quite a bit more.</p>
<p>If we start by getting the errors out of the way,
<code>fit$failed</code> returns the two distributions that failed enough
to cause errors:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span><span class="op">$</span><span class="va">failed</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[[1]]
[1] "GIG"

[[2]]
[1] "LNO"</code></pre>
</div>
<p>As mentioned <code>fitDist()</code> fitted the data to 23 different
distributions. We can inspect the rest, and their associated AIC-values
like this:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span><span class="op">$</span><span class="va">fits</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>    WEI2     WEI3      WEI       GG    BCPEo     BCPE    BCCGo     BCCG
179.2449 179.2449 179.2449 181.1349 181.4953 181.4953 183.1245 183.1245
     GB2      BCT     BCTo   exGAUS       GA   LOGNO2    LOGNO       IG
183.1354 185.1245 185.1245 190.2994 194.4665 198.3047 198.3047 198.3558
  IGAMMA      EXP       GP PARETO2o  PARETO2
202.6759 861.8066 863.8067 863.8079 863.8081 </code></pre>
</div>
<p>Here we get <code>WEI2</code> first, with an AIC of 179.2449, but we
can see that <code>WEI3</code> and <code>WEI1</code> have almost exactly
the same AIC. Not that surprising if we guess that
<code>Weibull type 3</code> is probably rather similar to
<code>Weibull type 2</code>.</p>
<p>The difference in AIC for the first two distributions tested is very
small. Is it large enough for us to think that <code>WEI2</code> is
significantly better than <code>WEI3</code>?</p>
<p>No. As a general rule of thumb, the difference between the AIC of two
distributions have to be larger than 2 for us to see a significant
difference.</p>
<p>We can get more details using the <code>summary()</code>
function:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>*******************************************************************
Family:  c("WEI2", "Weibull type 2")

Call:  gamlssML(formula = y, family = DIST[i])

Fitting method: "nlminb"


Coefficient(s):
             Estimate  Std. Error  t value   Pr(&gt;|t|)
eta.mu    -18.6934274   1.1306427 -16.5334 &lt; 2.22e-16 ***
eta.sigma   2.5242093   0.0589965  42.7858 &lt; 2.22e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

 Degrees of Freedom for the fit: 2 Residual Deg. of Freedom   173
Global Deviance:     175.245
            AIC:     179.245
            SBC:     185.574 </code></pre>
</div>
<p>And we can get at graphical description as well:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/which-distribution-rendered-plot-fit-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>******************************************************************
	      Summary of the Quantile Residuals
                           mean   =  -0.001205749
                       variance   =  0.9953007
               coef. of skewness  =  0.09022876
               coef. of kurtosis  =  2.529951
Filliben correlation coefficient  =  0.9976953
******************************************************************</code></pre>
</div>
</section><section><h2 class="section-heading" id="what-about-the-other-options">What about the other options?<a class="anchor" aria-label="anchor" href="#what-about-the-other-options"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="general-comments">General comments<a class="anchor" aria-label="anchor" href="#general-comments"></a>
</h3>
<p>Above we got the “best” fit. But we also noted that in order for us
to conclude that one distribution is a better fit than another, the
difference in AIC should be at least 2.</p>
<p>What we are looking for might not actually be the probability
distribution that best fits our data. Our data might be noisy or there
might me systematic errors. The probability distribution we really want,
is the one that best matches the underlying data generating function,
the mechanisms in the real world that we are studying, that actually is
at the hearth of the data we collect.</p>
<p>We might not be able to find that. But we should consider if some of
the other possibilities provided by <code>fitDist()</code> might
actually be better.</p>
<div id="accordionInstructor2" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor2" aria-expanded="false" aria-controls="collapseInstructor2">
  <h3 class="accordion-header" id="headingInstructor2">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div> Instructor Note </h3>
</button>
<div id="collapseInstructor2" class="accordion-collapse collapse" aria-labelledby="headingInstructor2" data-bs-parent="#accordionInstructor2">
<div class="accordion-body">
<p>Og her er det vi holder dem fast på at det faktisk er dem selv der er
de bedst kvalificerede til at afgøre det. For det er dem der forstår
domænet og data.</p>
</div>
</div>
</div>
</div>
<p>First step is to look at the relevant distributions. In the setup
with <code>gamlss</code>, <code>gamlss.dist</code> and
<code>gamlss.add</code> we can test distributions of different types.
The complete list can be found using the help function for
<code>fitDist()</code>, but falls in the following families:</p>
<ul>
<li>realline - continuous distributions for all real values</li>
<li>realplus - continuous distributions for positive real values</li>
<li>realAll - all continuous distributions - the combination of realline
and realplus</li>
<li>real0to1 - continuous distributions defined for real values between
0 and 1</li>
<li>counts - distributions for counts</li>
<li>binom - binomial distributions</li>
</ul>
<p>Begin by considering which type whatever your data is describing,
best matches.</p>
</div>
<div class="section level3">
<h3 id="actually-looking-at-the-fits">Actually looking at the fits<a class="anchor" aria-label="anchor" href="#actually-looking-at-the-fits"></a>
</h3>
<p>For the selection of eruptions that we fitted, we chose the
“realplus” selection of distibutions to test. We did that, because the
eruption times are all positive, and on the real number line.</p>
<div class="instructur">
<p>“Real numbers”, på dansk reelle tal. Hvis du ved hvad imaginære tal
er, ved du også hvad reelle tal er. Hvis ikke - så er reelle tal alle de
tal du vil tænke på som tal.</p>
</div>
<p>Behind the scenes <code>fitDist</code> fits the data to the chosen
selection of distributions, and returns the best.</p>
<p>Looking at the result of the fit we see this:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Family:  c("WEI2", "Weibull type 2")
Fitting method: "nlminb"

Call:  gamlssML(formula = y, family = DIST[i])

Mu Coefficients:
[1]  -18.69
Sigma Coefficients:
[1]  2.524

 Degrees of Freedom for the fit: 2 Residual Deg. of Freedom   173
Global Deviance:     175.245
            AIC:     179.245
            SBC:     185.574 </code></pre>
</div>
<p>In the <code>Call</code> part of the output, we see this:</p>
<p><code>Call:  gamlssML(formula = y, family = DIST[i])</code></p>
<p>and from that we can deduces that if we want to fit the data to eg
the log-normal distribution (in the documentation we find that the
abbreviation for that is “LOGNO”), we can do it like this:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">log_norm_fit</span> <span class="op">&lt;-</span> <span class="fu">gamlss</span><span class="op">(</span><span class="va">eruptions</span> <span class="op">~</span> <span class="fl">1</span>, family <span class="op">=</span> <span class="va">LOGNO</span>, data <span class="op">=</span> <span class="va">eruption_example</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>GAMLSS-RS iteration 1: Global Deviance = 194.3047
GAMLSS-RS iteration 2: Global Deviance = 194.3047 </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="va">log_norm_fit</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>******************************************************************
Family:  c("LOGNO", "Log Normal")

Call:
gamlss(formula = eruptions ~ 1, family = LOGNO, data = eruption_example)

Fitting method: RS()

------------------------------------------------------------------
Mu link function:  identity
Mu Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) 1.451832   0.007461   194.6   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Sigma link function:  log
Sigma Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -2.31561    0.05345  -43.32   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
No. of observations in the fit:  175
Degrees of Freedom for the fit:  2
      Residual Deg. of Freedom:  173
                      at cycle:  2

Global Deviance:     194.3047
            AIC:     198.3047
            SBC:     204.6343
******************************************************************</code></pre>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>The data generating function is not necessarily the same as the
distribution that best fit the data</li>
<li>Chose the distribution that best describes your data - not the one
that fits best</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section><section id="aio-linear-regression"><p>Content from <a href="linear-regression.html">Linear regression</a></p>
<hr>
<p>Last updated on 2024-10-07 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/linear-regression.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 12 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I make a linear regression?</li>
<li>How do I interpret the results of a linear regression?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to fit data to a linear equation in one dimension</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>Here is some data, observations of the distance (in ft) it takes to
stop a car driving at different speeds (in mph):</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cars</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">speed</span>,<span class="va">dist</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/linear-regression-rendered-unnamed-chunk-1-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Not surprisingly the faster the car travels, the longer distance it
takes to stop it.</p>
<p>If we want to predict how long a car traveling at 10 mph takes to
stop, we could look at the observations at 10 mph and note that there is
some variation. We might take the average of those observations, and use
that as an estimate of how many feet it takes to stop a car traveling at
10 mph.</p>
<p>But what if we want to predict how long it takes to stop the car if
we are driving it at 12.5 mph instead? That would be nice to know, in
order to avoid hitting stuff. There are no observations in the data at
12.5 mph! We could estimate it as the average of the (average) stopping
distance at 12 mph and at 13 mph (21.5 and 35 ft respectively) and give
an estimate of 28.25 ft.</p>
<p>This is easy - 12.5 is exactly at the middle of the interval of 12 to
13 mph. But what if we want the distance at 12.4 mph?</p>
<p>Instead of fiddling with the numbers manually, we note that it
appears to be possible to draw a straight line through the points,
describing the connection between the two variables.</p>
<p>Let’s do that:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cars</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">speed</span>,<span class="va">dist</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<figure><img src="../fig/linear-regression-rendered-unnamed-chunk-2-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The points do not fall precisely on the line, but it’s not very
bad.</p>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div> Instructor Note </h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" aria-labelledby="headingInstructor1" data-bs-parent="#accordionInstructor1">
<div class="accordion-body">
<p>Bremselængden er faktisk ikke en lineær funktion af hastigheden.
Bilen har kinetisk (bevægelses) energi så længe den bevæger sig. Den
skal vi have ned på 0. Og eftersom den kinetiske energi er givet ved
<span class="math inline">\(E_{kin} = \frac{1}{2}mv^2\)</span> hvor m er
bilens masse og v er hastigheden, vil dist afhænge af speed i anden.</p>
</div>
</div>
</div>
</div>
<p>When we want to figure out how long it takes to stop a car driving at
12.5 mph, we can locate 12.5 on the x-axis, move vertically up to the
line, and read the corresponding value on the y-axis, about 30 mph.</p>
<p>But we can do better. Such a line can be described mathematically.
Straight lines in two dimensions can in general be described using the
formula:</p>
<p><span class="math display">\[
y = ax + b
\]</span> or, in this specific case:</p>
<p><span class="math display">\[
dist = a*speed + b
\]</span></p>
<p><code>a</code> and <code>b</code> are the coefficients of this
“model”. <code>a</code> is the slope, or how much the distance changes,
if we change speed by one. <code>b</code> is the intercept, the value
where the line crosses the y-axis. Or the distance it takes to stop a
car, traveling at a speed of 0 miles per hour - a value that does not
necessarily make sense, but is still a part of the model.</p>
<p>If we want to be very strict about it, that <code>=</code> is not
really equal. The expression describes the straight line, but the actual
observations do not actually fall on the line. If, for a given dist and
speed, we want the expression to actually be equal, there is some
variation that we need to include. We do that by adding a
<code>residual</code>:</p>
<p><span class="math display">\[
dist = a*speed + b + \epsilon
\]</span></p>
<p>And, if we want to be very mathematical concise, instead of using
<code>a</code>and <code>b</code> for the coefficients in the expression,
we would instead write it like this:</p>
<p><span class="math display">\[
dist = \beta_0 + \beta_1 speed + \epsilon
\]</span></p>
<p>That is all very nice. But how do we find the actual <code>a</code>
and <code>b</code> (or <span class="math inline">\(\beta_i\)</span>)?
What is the “best” line or model for this?</p>
<p>We do that by fitting <code>a</code> and <code>b</code> to values
that minimizes <span class="math inline">\(\epsilon\)</span>, that is,
we need to find the difference between the actual observed values, and
the prediction from the expression or model. Instead of looking at the
individual differences one by one, we look at the sum of the
differences, and minimizes that. However, the observed values can be
larger than the prediction, or smaller. The differences can therefore be
both negative and positive, and the sum can become zero because the
difference might cancel each other out.</p>
<p>To avoid that problem, we square the differences, and then minimize
the sum of the squares. That is the reason for calling the method for
minimizing <span class="math inline">\(\epsilon\)</span>, and by that
finding the optimal <code>a</code> and <code>b</code>, “least
squares”.</p>
<p>In a simple linear model like this, we can calculate the coefficients
directly:</p>
<p><span class="math display">\[\beta_1 = \frac{\sum_{i=1}^{n} (x_i -
\overline{x})(y_i - \overline{y})}{\sum_{i=1}^{n} (x_i -
\overline{x})^2}\]</span></p>
<p><span class="math display">\[\beta_0 = \overline{y} -
\beta_1\overline{x}\]</span></p>
<p>We do not want to do that - R can do it for us, with the function
<code>lm()</code></p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">lm</span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">x</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span></code></pre>
</div>
<p>y~x is the “formula notation” in R, and describes that y is a
function of x.</p>
<p>Using the example from above:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linear_model</span> <span class="op">&lt;-</span> <span class="fu">lm</span><span class="op">(</span><span class="va">dist</span><span class="op">~</span><span class="va">speed</span>, data <span class="op">=</span> <span class="va">cars</span><span class="op">)</span></span></code></pre>
</div>
<p>We saved the result of the function in an object, in order to be able
to work with it. If we just want the coefficients, we can output the
result directly:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linear_model</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
lm(formula = dist ~ speed, data = cars)

Coefficients:
(Intercept)        speed
    -17.579        3.932  </code></pre>
</div>
<p>This gives us the coefficients of the model. The intercept,
<code>b</code> or <span class="math inline">\(\beta_0\)</span> is
-17.579. And the slope, <code>a</code> or <span class="math inline">\(\beta_1\)</span> is 3.932.</p>
<p>Having a negative intercept, or in this case any intercept different
from 0 does not make physical sense - a car travelling at 0 miles pr
hour should have a stopping distance of 0 ft.</p>
<p>The slope tells us, that if we increase the speed of the car by 1
mph, the stopping distance will increase by 3.932 ft.</p>
<div id="challenge-1-can-you-do-it" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-1-can-you-do-it" class="callout-inner">
<h3 class="callout-title">Challenge 1: Can you do it?</h3>
<div class="callout-content">
<p>What stopping distance does the model predict if the speed i 12.5
mph?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>3.932*12.5 - 17.579 = 31.571 ft</p>
</div>
</div>
</div>
</div>
<div id="challenge-2-might-there-be-a-problem-with-that-prediction" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-2-might-there-be-a-problem-with-that-prediction" class="callout-inner">
<h3 class="callout-title">Challenge 2: Might there be a problem with that prediction?</h3>
<div class="callout-content">

</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>Yep. We might be able to measure the speed with the implied
precision. But the prediction implies a precision on the scale of
1/10000 mm.</p>
</div>
</div>
</div>
</div>
<p>We can get more details using the <code>summary()</code>
function:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="va">linear_model</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
lm(formula = dist ~ speed, data = cars)

Residuals:
    Min      1Q  Median      3Q     Max
-29.069  -9.525  -2.272   9.215  43.201

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -17.5791     6.7584  -2.601   0.0123 *
speed         3.9324     0.4155   9.464 1.49e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 15.38 on 48 degrees of freedom
Multiple R-squared:  0.6511,	Adjusted R-squared:  0.6438
F-statistic: 89.57 on 1 and 48 DF,  p-value: 1.49e-12</code></pre>
</div>
<p>Let us look at that output in detail.</p>
<p><code>Call</code> simply repeats the model that we build, just in
case we have forgotten it - but also to have the actual model included
in the output, in order for other functions to access it and use it. We
will get to that.</p>
<p>The residuals are included. It is often important to take a look at
those, and we will do that shortly.</p>
<p>Now, the coefficients.</p>
<p>The estimates for intercept and speed, that is the intercept and the
slope of the line, are given. Those are the same we saw previously. We
also get a standard error. We need that for testing how much trust we
have in the result.</p>
<p>We are almost certain that the estimates of the values for intercept
and slope are not correct. They are estimates after all and we will
never know what the <em>true</em> values are. But we can test if they
are zero.</p>
<p>The hypothesis we can test is - is the coefficient for the slope
actually zero, even though the estimate we get is 3.9? If it is zero,
speed will not have any influence on the stopping distance. So; with
what certainty can we rule out that it is in fact zero?</p>
<p>We are testing the hypothesis that we have gotten a value for speed
of 3.9 by random chance, but that the true value is zero. If it is zero,
the value of 3.9 is 9.5 standard errors away from 0: $3.9324/0.4155 =
9.46426 $. And, using the t-distribution which describes these sorts of
things pretty well, that will happen very rarely. The Pr, or p-value, is
1.49e-12. That is the chance, or probability, that we will get a value
for the slope in our model that is 9.464 standard errors away from zero,
if the true value of the slope is zero.</p>
<p>In general if the p-value is smaller than 0.05, we reject the
hypothesis that the true value of the slope is 0.</p>
<p>Since we can assume that the estimates are normally distributed, we
can see that, <em>if</em> the true value of the slope was zero, the
value we get here, is 3.9324/0.4155 = 9.46426, standard errors away from
zero.</p>
<p>RSE is the squareroot of the sum of the squared residuals, divided by
the number of observations, <span class="math inline">\(n\)</span> minus
the number of parameters in the model, in this case 2. It is an estimate
of the average difference between the observed values, and the values
the model predicts. We want RSE to be as small as possible. What is
small? That depends on the size of the values. If we predict values in
the range of 0 to 2, an RSE of 15 is very large. If we predict values in
the range 0 to 1000, it is small.</p>
<p>Multiple R-squared, is a measure of how much of the variation in
<code>dist</code> that our model explains. In this case the model
explains ~65% of the variation. Not that impressive, but acceptable.</p>
<p>The adjusted R-squared adjusts the multiple R-square by the number of
independent variables in the model. It becomes an important measure of
how good the model is, when we get to multiple linear regression,
because we will get a better R-squared by adding independent variables,
even if these variables do not actually have any connection to the
dependent variables.</p>
<p>The F-statistic is 89.57 and has a p-value of 1.49e-12.</p>
<p>This tests our model against a model where all the slopes (we only
have one in this case) are 0; that is, is the overall model significant.
In this case it is, and there is overall strong evidence for the claim
that the speed of the car influences the stopping distance.</p>
<div id="discussion1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<p>Make a model, where you describe the length of the flipper of a
penguin, as a function of its weigth. You find data on penguins in the
library <code>palmerpenguins</code>. :::: solution</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">palmerpenguins</span><span class="op">)</span></span>
<span><span class="va">penguin_model</span> <span class="op">&lt;-</span> <span class="fu">lm</span><span class="op">(</span><span class="va">flipper_length_mm</span><span class="op">~</span><span class="va">body_mass_g</span>, data <span class="op">=</span> <span class="va">penguins</span><span class="op">)</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">penguin_model</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
lm(formula = flipper_length_mm ~ body_mass_g, data = penguins)

Residuals:
     Min       1Q   Median       3Q      Max
-23.7626  -4.9138   0.9891   5.1166  16.6392

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) 1.367e+02  1.997e+00   68.47   &lt;2e-16 ***
body_mass_g 1.528e-02  4.668e-04   32.72   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.913 on 340 degrees of freedom
  (2 observations deleted due to missingness)
Multiple R-squared:  0.759,	Adjusted R-squared:  0.7583
F-statistic:  1071 on 1 and 340 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</div>
</div>
<p>::::</p>
</section><section><h2 class="section-heading" id="testing-the-assumptions">Testing the assumptions<a class="anchor" aria-label="anchor" href="#testing-the-assumptions"></a>
</h2>
<hr class="half-width">
<p>We can <em>always</em> make a linear model. The questions is: should
we?</p>
<p>There are certain assumptions that needs to be met in order to trust
a linear model.</p>
<ol style="list-style-type: decimal">
<li><p>There should be a linear connection between the dependent and
independent variable. We test that by comparing the observed values with
the predicted values (the straight line).</p></li>
<li><p>Independence. The observations needs to be independent. If one
measurement influences another measurement, we are not allowed to use a
linear model.</p></li>
<li><p>Normality of residuals. The residuals must be normally
distributed.</p></li>
</ol>
<p>There exist specific tests for the first two assumptions, but in
general we know our data well enough to determine if they are fulfilled.
The third assumptions can be tested using a <code>qqplot</code>. We
begin by extracting the residuals from our model:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">residuals</span> <span class="op">&lt;-</span> <span class="fu">residuals</span><span class="op">(</span><span class="va">linear_model</span><span class="op">)</span></span></code></pre>
</div>
<p>And then plotting them:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">qqnorm</span><span class="op">(</span><span class="va">residuals</span><span class="op">)</span></span>
<span><span class="fu">qqline</span><span class="op">(</span><span class="va">residuals</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/linear-regression-rendered-unnamed-chunk-9-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The points should be (close to be) on the straight line in the plot.
In this case they are close enough.</p>
<p>This is also a handy way to test if our data is normally
distributed.</p>
<div id="challenge3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<p>Test if the residuals in our penguin model from before, are normally
distributed.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguin_residuals</span> <span class="op">&lt;-</span> <span class="fu">residuals</span><span class="op">(</span><span class="va">penguin_model</span><span class="op">)</span></span>
<span><span class="fu">qqnorm</span><span class="op">(</span><span class="va">penguin_residuals</span><span class="op">)</span></span>
<span><span class="fu">qqline</span><span class="op">(</span><span class="va">penguin_residuals</span><span class="op">)</span></span></code></pre>
</div>
<p><img src="../fig/linear-regression-rendered-unnamed-chunk-10-1.png" style="display: block; margin: auto;" class="figure">
They are relatively close to normal.</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Use <code>.md</code> files for episodes when you want static
content</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-multiple-linear-regression"><p>Content from <a href="multiple-linear-regression.html">Multiple Linear Regression</a></p>
<hr>
<p>Last updated on 2024-10-07 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/multiple-linear-regression.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 12 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do you run a multiple linear regression?</li>
<li>What about conditional effects?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to use markdown with the new lesson template</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>A linear regression is relatively simple to understand and visualise.
We have a dependent variable that we try to predict - model - using an
independent variable. In principle we can change the independent
variable, and the model will predict the change in the dependent
variable. We can visualise this using a relatively simple graph,
plotting the two variables against each other, and adding the line
representing the model.</p>
<p>But what if we have reason to believe that the dependent variable
depends on more than one independent variable?</p>
<p>Let us find some data for illustrating this.</p>
<p>Before anything else, we load the <code>tidyverse</code> package, and
then load the data:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">density</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"data/BONEDEN.csv"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Rows: 41 Columns: 25
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (25): ID, age, zyg, ht1, wt1, tea1, cof1, alc1, cur1, men1, pyr1, ls1, f...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<p>The data records the bonedensity in different parts of the skeleton
of female monozygotic twins, as well as height, age, weight, smoking,
alcohol, tea and coffee-habits. We are going to observe the second twin,
where all variables are suffixed with the digit “2”:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">density</span> <span class="op">&lt;-</span> <span class="va">density</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="va">age</span>, <span class="fu">contains</span><span class="op">(</span><span class="st">"2"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">density</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 6 × 12
    age   ht2   wt2  tea2  cof2  alc2  cur2  men2  pyr2   ls2   fn2   fs2
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1    27   160    56    42    21     0     0     0  13.8  0.76  0.68  1.04
2    42   159    72    20    21     1     1     0  48    0.89  0.64  1.11
3    59   156    54     7    28     0     0     1  20.5  0.51  0.64  0.86
4    61   162    58    21    35     0     0     1  29.8  0.85  0.69  1.03
5    47   150    58    91     0     0     1     1  25    0.59  0.54  0.96
6    33   158    54    14    14     0     0     0   5    0.83  0.5   1.06</code></pre>
</div>
<p>More specically we are trying to model the bone density in the
femoral shaft (lårbensskaft). As an intial hypothesis, we are going to
assume that the density depends on height (<code>ht2</code>), age
(<code>age</code>), weight (<code>wt2</code>), tea (<code>tea2</code>)
and coffee consumption (<code>cof2</code>).</p>
<p>That is, we assume that there is a linear correlation between the
bone density and each of the independent variables.</p>
<p>The simple linear regresion between just the bone density and the
height, can be done with:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">lm</span><span class="op">(</span><span class="va">fs2</span> <span class="op">~</span> <span class="va">ht2</span>, data <span class="op">=</span> <span class="va">density</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summary</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
lm(formula = fs2 ~ ht2, data = density)

Residuals:
     Min       1Q   Median       3Q      Max
-0.41406 -0.02810  0.00190  0.07658  0.30722

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -1.78744    0.71928  -2.485 0.017351 *
ht2          0.01766    0.00445   3.969 0.000301 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1315 on 39 degrees of freedom
Multiple R-squared:  0.2877,	Adjusted R-squared:  0.2694
F-statistic: 15.75 on 1 and 39 DF,  p-value: 0.0003006</code></pre>
</div>
<p>Where we pipe the output of the regression to the summary function to
take a closer look. There is a strong correlation between bone density
and height. If we increse the height of a woman by one centimeter, the
density of the femoral shaft is expected to increase by 0.0177 <span class="math inline">\(g/cm^3\)</span>. The correlation is significant,
we are rather sure that the estimate of this coefficient is different
from 0.</p>
<p>Now we would like to add the other independent variables to the
model.</p>
<p>The model we are building can be described using math as:</p>
<p><span class="math display">\[ \text{fs2} = w_0 + w_1\text{ht2} +
w_2\text{wt2} + w_3\text{tea2} + w_4\text{cof2} + \epsilon  \]</span>
That is - we would like to figure out which coefficients <span class="math inline">\(w_1\)</span> to <span class="math inline">\(w_4\)</span>, and which intercept <span class="math inline">\(w_0\)</span> gives us estimates of fs2, that
minimises the error <span class="math inline">\(\epsilon\)</span></p>
<p>This is pretty straight forward. Instead of running
<code>lm(fs2~ht2, data = density</code>, we add the additional
independent variables using the <code>+</code> sign. And again we pipe
the result to the summary function to take a closer look:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">lm</span><span class="op">(</span><span class="va">fs2</span> <span class="op">~</span> <span class="va">ht2</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">wt2</span> <span class="op">+</span> <span class="va">tea2</span> <span class="op">+</span> <span class="va">cof2</span>, data <span class="op">=</span> <span class="va">density</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">summary</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
lm(formula = fs2 ~ ht2 + age + wt2 + tea2 + cof2, data = density)

Residuals:
      Min        1Q    Median        3Q       Max
-0.247601 -0.061517  0.005634  0.067826  0.166474

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -0.2800114  0.7774507  -0.360 0.720887
ht2          0.0090956  0.0046455   1.958 0.058246 .
age         -0.0068373  0.0015669  -4.364 0.000108 ***
wt2          0.0038274  0.0014934   2.563 0.014836 *
tea2        -0.0009246  0.0009837  -0.940 0.353677
cof2        -0.0005310  0.0009328  -0.569 0.572778
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1043 on 35 degrees of freedom
Multiple R-squared:  0.5978,	Adjusted R-squared:  0.5403
F-statistic:  10.4 on 5 and 35 DF,  p-value: 3.566e-06</code></pre>
</div>
<p>It is <em>that</em> simple. Interpreting the results on the other
hand is a little bit more complicated.</p>
<p>The bone density, for a newborn woman (0 years old), that is 0
centimeters high, weighing 0 kilogram, who does not drink either tea or
coffee, is -0.28 <span class="math inline">\(g/cm^3\)</span> - which is
obviously either impossible, or a discovery that would get you an
invitation to Stockholm.</p>
<p>For each centimeter the woman grows, <em>if all other variables are
held constant!</em> the bone density is expected to increase by 0.0091
<span class="math inline">\(g/cm^3\)</span>.</p>
<p>For each year the woman grows older, <em>if all other variables are
held constant!</em> the bone density is expected to decrease by 0.0068
<span class="math inline">\(g/cm^3\)</span>.</p>
<p>For each kilogram the woman puts on weight, <em>if all other
variables are held constant!</em> the bone density is expected to
increase by 0.0038 <span class="math inline">\(g/cm^3\)</span>.</p>
<p>The coefficient for the height variable is not significant (if we
have decided on a 5% significanse level), and neither consumption of teo
nor coffee has a significant influence on bone density. According to
this model.</p>
<p>Is this a good model? No. The coefficients for Tea and coffee
consumption are not significant, and should not be in the model. Let us
remove them.</p>
<p>But let us remove them one by one. First coffee that has the worst
p-value:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">lm</span><span class="op">(</span><span class="va">fs2</span> <span class="op">~</span> <span class="va">ht2</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">wt2</span> <span class="op">+</span> <span class="va">tea2</span>, data <span class="op">=</span> <span class="va">density</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">summary</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
lm(formula = fs2 ~ ht2 + age + wt2 + tea2, data = density)

Residuals:
     Min       1Q   Median       3Q      Max
-0.26036 -0.06261  0.01682  0.06366  0.17393

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -0.2209640  0.7632342  -0.290   0.7739
ht2          0.0085364  0.0044976   1.898   0.0657 .
age         -0.0068645  0.0015514  -4.425 8.58e-05 ***
wt2          0.0041140  0.0013927   2.954   0.0055 **
tea2        -0.0007497  0.0009257  -0.810   0.4233
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1034 on 36 degrees of freedom
Multiple R-squared:  0.5941,	Adjusted R-squared:  0.5489
F-statistic: 13.17 on 4 and 36 DF,  p-value: 1.048e-06</code></pre>
</div>
<p>Note that not only is the coefficient for tea still not significant,
it actually gets “worse”.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">lm</span><span class="op">(</span><span class="va">fs2</span> <span class="op">~</span> <span class="va">ht2</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">wt2</span> , data <span class="op">=</span> <span class="va">density</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">summary</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
lm(formula = fs2 ~ ht2 + age + wt2, data = density)

Residuals:
      Min        1Q    Median        3Q       Max
-0.273490 -0.058038  0.005241  0.067527  0.169512

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -0.569569   0.627355  -0.908  0.36981
ht2          0.010524   0.003751   2.806  0.00796 **
age         -0.006489   0.001474  -4.404 8.74e-05 ***
wt2          0.004077   0.001385   2.943  0.00559 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1029 on 37 degrees of freedom
Multiple R-squared:  0.5867,	Adjusted R-squared:  0.5531
F-statistic:  17.5 on 3 and 37 DF,  p-value: 3.078e-07</code></pre>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Use <code>.md</code> files for episodes when you want static
content</li>
<li>Use <code>.Rmd</code> files for episodes when you need to generate
output</li>
<li>Run <code>sandpaper::check_lesson()</code> to identify any issues
with your lesson</li>
<li>Run <code>sandpaper::build_lesson()</code> to preview your lesson
locally</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-logistic-regression"><p>Content from <a href="logistic-regression.html">Logistisk regression</a></p>
<hr>
<p>Last updated on 2024-10-07 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/logistic-regression.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 12 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do you run a logistic regression?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to use markdown with the new lesson template</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="logistisk-regression">Logistisk Regression<a class="anchor" aria-label="anchor" href="#logistisk-regression"></a>
</h2>
<hr class="half-width">
<p>Hvad nu hvis den afhængige variabel ikke er kontinuært, men
kategorisk? Altså at vi forsøger at forudsige eksempelvis “syg/rask”,
baseret på en række kontinuærte uafhængige variable.</p>
<p>Først binær, vi har en række variable, baseret på dem forsøger vi at
forudsige om udfaldet er det ene eller det andet af to mulige
udfald.</p>
<div class="section level3">
<h3 id="formel-for-logistisk-regression">Formel for Logistisk Regression<a class="anchor" aria-label="anchor" href="#formel-for-logistisk-regression"></a>
</h3>
<p>Logistisk regressionsmodel kan matematisk beskrives ved:</p>
<p><span class="math display">\[\text{logit}(p) = \log\left(\frac{p}{1 -
p}\right) = \beta_0 + \beta_1X_1 + \beta_2X_2 + \ldots +
\beta_kX_k\]</span></p>
<p>hvor:</p>
<p><span class="math inline">\(p\)</span> er sandsynligheden for, at den
afhængige variabel <span class="math inline">\(Y\)</span> tager værdien
1.</p>
<p><span class="math inline">\(\beta_0, \beta_1, \ldots,
\beta_k\)</span> er koefficienter, som modellen estimerer.</p>
<p>*<span class="math inline">\(X_1, X_2, \ldots, X_k\)</span> er de
uafhængige variabler.</p>
<p>Funktionen ser således ud:
<img src="../fig/logistic-regression-rendered-logit_func_plot-1.png" style="display: block; margin: auto;" class="figure"></p>
<p>Og pointen er altså at vi hælder noget input ind, og så får vi langt
henadvejen enten 0 eller 1 ud. Der vil stort set altid være en gråzone,
hvor sandsynligheden for et bestemt udfald er en del større end 0, men
også en del mindre end 1. Vi vil ofte vælge at sætte grænsen ved 50%,
men vær opmærksom på, at det betyder at vi får et udfald der er 0,
selvom sandsynligheden for at svaret er 1 i virkeligheden er 49%</p>
</div>
</section><div class="section level1">
<h1 id="fit-modellen">fit modellen<a class="anchor" aria-label="anchor" href="#fit-modellen"></a>
</h1>
<p>Alt det er udemærket. Måden vi i praksis gør det på er ved:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">glm</span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">x1</span><span class="op">+</span><span class="va">x2</span>, family <span class="op">=</span> <span class="st">"binomial"</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level1">
<h1 id="koefficienter-og-p-værdier">koefficienter og p-værdier<a class="anchor" aria-label="anchor" href="#koefficienter-og-p-v%C3%A6rdier"></a>
</h1>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level1">
<h1 id="predict">predict<a class="anchor" aria-label="anchor" href="#predict"></a>
</h1>
<p>new_data &lt;- data.frame(x1 = c(1, 2, 3), x2 = c(4, 5, 6))
predict(model, newdata = new_data, type = “response”)</p>
<div class="section level2">
<h2 id="andre">andre<a class="anchor" aria-label="anchor" href="#andre"></a>
</h2>
<p>glm kan andet. Det kommer vi ikke ind på.</p>
<div class="section level3">
<h3 id="probit">Probit?<a class="anchor" aria-label="anchor" href="#probit"></a>
</h3>
<p>det er link funktionen der styrer det. Vi har jo en sandsynlighed -
og den går ffra 0 til 1. Hvis vi skal fitte det til en model, skal
skalaen være uendelig. Den tranformation foretages af
linkfunktionen.</p>
<p>Normalt bruger vi logitfunktionen.</p>
<p>Probit er når vi bruger den kumulative fordelingsfunktion for
normalfordelingen. Den er populær når man antager at der ligger en
underliggende normalitet i respons. Eksempelvis i reaktion på dosis i
toxikologi.</p>
<p>Der er andre.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Use <code>.md</code> files for episodes when you want static
content</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</div>
</div></section><section id="aio-clt"><p>Content from <a href="clt.html">Central Limit Theorem</a></p>
<hr>
<p>Last updated on 2024-10-07 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/clt.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 12 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do you write a lesson using R Markdown and
<a href="https://carpentries.github.io/sandpaper/" class="external-link">sandpaper</a>?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to use markdown with the new lesson template</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>An important phenomenon working with data is the “Central Limit
Theorem”.</p>
<p>It states that, if we take a lot of samples from a distribution, the
mean of those samples will approximate the normal distribution, even
though the distribution in it self is not normally distributed.</p>
<p>The uniform distribution is not normally distributed. Without any
additional arguments, it will produce x random values between 0 and 1,
with equal probability for all possible values. Here we get 100 random
values, and plot a histogram of them:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">random_numbers</span> <span class="op">&lt;-</span> <span class="fu">runif</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span> </span>
<span><span class="fu">hist</span><span class="op">(</span><span class="va">random_numbers</span><span class="op">)</span></span></code></pre>
</div>
<p><img src="../fig/clt-rendered-random-histogram-1.png" style="display: block; margin: auto;" class="figure">
This is definitely not normally distributed.</p>
<p>The mean of these random numbers is:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mean</span><span class="op">(</span><span class="va">random_numbers</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.448561</code></pre>
</div>
<p>The important point of the Central Limit Theorem is, that if we take
a large number of random samples, and calculate the mean of each of
these samples, the means will be normally distributed.</p>
<p>We could also have found the mean of the 100 random numbers like
this:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mean</span><span class="op">(</span><span class="fu">runif</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.4619255</code></pre>
</div>
<p>And we can use the <code>replicate()</code> function to repeat that
calculation several times, in this case 1000 times:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">repeated_means</span> <span class="op">&lt;-</span> <span class="fu">replicate</span><span class="op">(</span><span class="fl">1000</span>, <span class="fu">mean</span><span class="op">(</span><span class="fu">runif</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>When we plot the histogram of these 1000 means of 100 random numbers,
we get this result:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">hist</span><span class="op">(</span><span class="va">repeated_means</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/clt-rendered-repeated-means-histogram-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The histogram looks quite normally distributed, even though the
distribution from which we drew the random samples were not.</p>
<p>This is the essense of the Central Limit Theorem. The distrubution of
the means of our samples will approximate the normal distribution,
regardless of the underlying distribution.</p>
<p>Because of this, we are able to treat the mean (and a number of other
statistical descriptors), as normally distributed - <em>and</em> use the
properties we know the normal distribution to have to work with
them.</p>
<p>The math required for proving this theorem is relatively complicated,
but can be found in the (extra material)[<a href="https://kubdatalab.github.io/R-toolbox/CLT-dk.html" class="external-link uri">https://kubdatalab.github.io/R-toolbox/CLT-dk.html</a>] on
this page. Note that the proof is in Danish, we are working on an
english version.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>The mean of a sample can be treated as if it is normally
distributed</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-barcharts"><p>Content from <a href="barcharts.html">Nicer barcharts</a></p>
<hr>
<p>Last updated on 2024-10-07 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/barcharts.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 12 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do we style barcharts to look better?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to use ggplot to make barcharts look better</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>Barcharts are easy to make, but how can we get them to look
nicer.</p>
<p>This is a checklist for cleaning up your barchart.</p>
<p>We start by getting some data:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">palmerpenguins</span><span class="op">)</span></span>
<span><span class="va">penguin_example</span> <span class="op">&lt;-</span> <span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">species</span><span class="op">)</span></span></code></pre>
</div>
<p>Barcharts and histograms are often confused. Histograms visualizes 1
dimentional data, barcharts 2 dimensional. The easy way to distinguish
them is the white space between the columns. Histograms are describing a
continious set of data, broken down into bins. Therefore there is no
breaks between the columns. Barcharts describes values in discrete
categories.</p>
<p>A further distinction in ggplot is between bar charts and column
charts.</p>
<p>Bar charts, made with <code>geom_bar()</code> makes the height of the
bar propotional to the number of cases/observations in each group, where
as <code>geom_col</code> makes the heights proportional to a value in
the group - that is just one value pr. group.</p>
<div id="callout1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout</h3>
<div class="callout-content">
<p>The way this happens is in the inner workings of the ggplot object.
All <code>geom</code>s come with an associated function/argument
<code>stats</code>, that controls the statistical transformation of the
input data. In <code>geom_bar</code> that transformation is
<code>stat_count()</code>, that counts the observations in each group.
In <code>geom_col´ it is ´stat_identity()</code>, which does nothing
with the data.</p>
</div>
</div>
</div>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div> Instructor Note </h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" aria-labelledby="headingInstructor1" data-bs-parent="#accordionInstructor1">
<div class="accordion-body">
<p>Men det er egentlig ikke vigtigt her - fokus er på hvordan man får et
barchart til at se pænere ud.</p>
</div>
</div>
</div>
</div>
<p>The us make the first barchart:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguin_example</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span><span class="fu">geom_bar</span><span class="op">(</span><span class="op">)</span> </span></code></pre>
</div>
<figure><img src="../fig/barcharts-rendered-unnamed-chunk-1-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>This barchart is <em>boring</em>. Grey in grey.</p>
</section><section><h2 class="section-heading" id="step-1---colors-and-labels">Step 1 - colors and labels<a class="anchor" aria-label="anchor" href="#step-1---colors-and-labels"></a>
</h2>
<hr class="half-width">
<p>The first step would be to do something about the colors, and add
labels and a title to the plot:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguin_example</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span><span class="fu">geom_bar</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"darkorchid3"</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">labs</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  y <span class="op">=</span> <span class="st">"Number of penguins"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Number of penguins at Palmer Station, Antarctica"</span><span class="op">)</span></span></code></pre>
</div>
<p><img src="../fig/barcharts-rendered-unnamed-chunk-2-1.png" style="display: block; margin: auto;" class="figure">
It is not strictly necessary to remove the label of the x-axis, but it
is superfluous in this case.</p>
</section><section><h2 class="section-heading" id="second-step---the-order-of-the-bars">Second step - the order of the bars<a class="anchor" aria-label="anchor" href="#second-step---the-order-of-the-bars"></a>
</h2>
<hr class="half-width">
<p>Note that the plot orders the species of penguins in alphabetical
order. For some purposes this is perfectly fine. But in general we
prefer to have the categories ordered by size, that is the number of
observations.</p>
<p>The order of categories can be controlled by converting the
observations to a categorical value, and ordering the levels in that
<code>factor</code> by frequency.</p>
<p>The <code>forcats</code> library makes that relatively easy, using
the function <code>fct_infreq()</code>, which converts the character
vector that is <code>species</code> to a factor with levels ordered by
frequency:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguin_example</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>species <span class="op">=</span> <span class="fu">fct_infreq</span><span class="op">(</span><span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span><span class="fu">geom_bar</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"darkorchid3"</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">labs</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  y <span class="op">=</span> <span class="st">"Number of penguins"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Number of penguins at Palmer Station, Antarctica"</span><span class="op">)</span></span></code></pre>
</div>
<p><img src="../fig/barcharts-rendered-unnamed-chunk-3-1.png" style="display: block; margin: auto;" class="figure">
This facilitates the reading of the graph - it becomes very easy to see
that the most frequent species of penguin is Adelie penguins.</p>
<div id="accordionInstructor2" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor2" aria-expanded="false" aria-controls="collapseInstructor2">
  <h3 class="accordion-header" id="headingInstructor2">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div> Instructor Note </h3>
</button>
<div id="collapseInstructor2" class="accordion-collapse collapse" aria-labelledby="headingInstructor2" data-bs-parent="#accordionInstructor2">
<div class="accordion-body">
<p>Ja, det er let nok ellers, men nu er det ekstremt let.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="rotating-the-plot">Rotating the plot<a class="anchor" aria-label="anchor" href="#rotating-the-plot"></a>
</h2>
<hr class="half-width">
<p>We only have three here, but if we have a lot of categories, it is
often preferable to have the columns as bars on the y-axis. We do that
by changing the <code>x</code> in the <code>aes()</code> function to
<code>y</code>:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguin_example</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>species <span class="op">=</span> <span class="fu">fct_infreq</span><span class="op">(</span><span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span><span class="fu">geom_bar</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"darkorchid3"</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">labs</span><span class="op">(</span></span>
<span>  y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  x <span class="op">=</span> <span class="st">"Number of penguins"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Number of penguins at Palmer Station, Antarctica"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/barcharts-rendered-unnamed-chunk-4-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></section><section><h2 class="section-heading" id="size-of-text">Size of text<a class="anchor" aria-label="anchor" href="#size-of-text"></a>
</h2>
<hr class="half-width">
<p>The default size of the text on labels, title etc is a bit to the
small side. To improve readability, we change the base_size parameter in
the default theme of ggplot to 14. You might need to play around with
the value, depending on the number of categories.</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguin_example</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>species <span class="op">=</span> <span class="fu">fct_infreq</span><span class="op">(</span><span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span><span class="fu">geom_bar</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"darkorchid3"</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">labs</span><span class="op">(</span></span>
<span>  y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  x <span class="op">=</span> <span class="st">"Number of penguins"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Number of penguins at Palmer Station, Antarctica"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_grey</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p><img src="../fig/barcharts-rendered-unnamed-chunk-5-1.png" style="display: block; margin: auto;" class="figure">
We also changed the scaling of the title of the plot. The size of that
is now 10% larger than the base size. We can do that by specifying a
specific size, but here we have done it using the <code>rel()</code>
function which changes the size relative to the base font size in the
plot.</p>
</section><section><h2 class="section-heading" id="step-xxx-removing-unnessecary-space">Step xxx removing unnessecary space<a class="anchor" aria-label="anchor" href="#step-xxx-removing-unnessecary-space"></a>
</h2>
<hr class="half-width">
<p>There is a bit of empty space between the columns and the labels on
the y-axis.</p>
<p>Let us get rid of that:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguin_example</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>species <span class="op">=</span> <span class="fu">fct_infreq</span><span class="op">(</span><span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span><span class="fu">geom_bar</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"darkorchid3"</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">labs</span><span class="op">(</span></span>
<span>  y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  x <span class="op">=</span> <span class="st">"Number of penguins"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Number of penguins at Palmer Station, Antarctica"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_grey</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu">expansion</span><span class="op">(</span>mult <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p><img src="../fig/barcharts-rendered-unnamed-chunk-6-1.png" style="display: block; margin: auto;" class="figure">
We control what is happening on the x-scale by using the family of
<code>scale_x</code> functions. Because it is a continuous scale, more
specifically <code>scale_x_continuous()</code>.</p>
<p>What is happening by default is that the scale is expanded relative
to the minimum and maximum values of the data. If we want to change
that, we cab either add absolute values (or subtract by using negative
values), or we can make a change relative to the data. That makes the
change robust to changes in the underlying data.</p>
<p>The mult() function in this case add 0 expansion to the left side of
the scale, and 1% ~ 0.01 to the righthand side of the scale.</p>
</section><section><h2 class="section-heading" id="remove-clutter">Remove clutter<a class="anchor" aria-label="anchor" href="#remove-clutter"></a>
</h2>
<hr class="half-width">
<p>There ar horizontal lines in the plot background that are
unnessecary. And the grey background we get by default is not very nice.
Remove them:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguin_example</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>species <span class="op">=</span> <span class="fu">fct_infreq</span><span class="op">(</span><span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span><span class="fu">geom_bar</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"darkorchid3"</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">labs</span><span class="op">(</span></span>
<span>  y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  x <span class="op">=</span> <span class="st">"Number of penguins"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Number of penguins at Palmer Station, Antarctica"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu">expansion</span><span class="op">(</span>mult <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    panel.grid.major.y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.minor.y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<p><img src="../fig/barcharts-rendered-unnamed-chunk-7-1.png" style="display: block; margin: auto;" class="figure">
First we change the default theme of the plot from
<code>theme_grey</code> to <code>theme_minimal</code>, which gets rid of
the grey background. In the additional <code>theme()</code> function we
remove the gridlines, both major and minor gridlines, on the y-axis, by
setting them to the speciel plot element
<code>element_blank()</code></p>
</section><section><h2 class="section-heading" id="add-raw-numbers-to-the-plot">Add raw numbers to the plot<a class="anchor" aria-label="anchor" href="#add-raw-numbers-to-the-plot"></a>
</h2>
<hr class="half-width">
<p>Especially for barcharts, it can make sense to add the raw values to
the columns, rather than relying on reading the values from the
x-axis.</p>
<p>That <em>can</em> be done, but a more general, and easier to
understand, approach is to construct a dataframe with the data:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguin_count</span> <span class="op">&lt;-</span> <span class="fu">count</span><span class="op">(</span><span class="va">penguin_example</span>, <span class="va">species</span><span class="op">)</span></span>
<span><span class="va">penguin_example</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>species <span class="op">=</span> <span class="fu">fct_infreq</span><span class="op">(</span><span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"darkorchid3"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Number of penguins at Palmer Station, Antarctica"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_minimal</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span></span>
<span>      panel.grid.major <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>      panel.grid.minor <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text</span><span class="op">(</span>data <span class="op">=</span> <span class="va">penguin_count</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">n</span>, y <span class="op">=</span> <span class="va">species</span>, label <span class="op">=</span> <span class="va">n</span><span class="op">)</span>,</span>
<span>    hjust <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    nudge_x <span class="op">=</span> <span class="op">-</span><span class="fl">0.25</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="cn">NULL</span>, expand <span class="op">=</span> <span class="fu">expansion</span><span class="op">(</span>mult <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span></code></pre>
</div>
<figure><img src="../fig/barcharts-rendered-count_penguins-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>In general it is a good idea to remove all extraneous pixels in the
graph. And when we add the counts directly to the plot, we can get rid
of the x-axis entirely.</p>
<p>On the other hand, it can be a good idea in this specific example, to
add a vertical indication of where the x=0 intercept is:
<code>geom_vline(xintercept = 0)</code>.</p>
<p>And: Always remember to think about the contrast between the color of
the bars and the text!</p>
</section><section><h2 class="section-heading" id="add-labels-to-the-plot">Add labels to the plot<a class="anchor" aria-label="anchor" href="#add-labels-to-the-plot"></a>
</h2>
<hr class="half-width">
<p>We can do the same with labels if we want:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguin_example</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>species <span class="op">=</span> <span class="fu">fct_infreq</span><span class="op">(</span><span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"darkorchid3"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Number of penguins"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Number of penguins at Palmer Station, Antarctica"</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    panel.grid.major.y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.minor.y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.major.x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.minor.x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu">expansion</span><span class="op">(</span>mult <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_discrete</span><span class="op">(</span>breaks <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">penguin_count</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">n</span>, y <span class="op">=</span> <span class="va">species</span>, label <span class="op">=</span> <span class="va">n</span><span class="op">)</span>,</span>
<span>    hjust <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    nudge_x <span class="op">=</span> <span class="op">-</span><span class="fl">0.25</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"white"</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">penguin_count</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="va">species</span>, label <span class="op">=</span> <span class="va">species</span><span class="op">)</span>,</span>
<span>    hjust <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    nudge_x <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>    fontface <span class="op">=</span> <span class="st">"bold"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">4.5</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/barcharts-rendered-unnamed-chunk-8-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></section><section><h2 class="section-heading" id="slimmer-bars">Slimmer bars<a class="anchor" aria-label="anchor" href="#slimmer-bars"></a>
</h2>
<hr class="half-width">
<p>Depending on aspect ratio of the final plot, number of categories
etc, we might want to adjust the width of the bars:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguin_example</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>species <span class="op">=</span> <span class="fu">fct_infreq</span><span class="op">(</span><span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span></span>
<span>    fill <span class="op">=</span> <span class="st">"darkorchid3"</span>,</span>
<span>    width <span class="op">=</span> <span class="fl">0.4</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Number of penguins"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Number of penguins at Palmer Station, Antarctica"</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    panel.grid.major.y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.minor.y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.major.x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.minor.x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu">expansion</span><span class="op">(</span>mult <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_discrete</span><span class="op">(</span>breaks <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">penguin_count</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">n</span>, y <span class="op">=</span> <span class="va">species</span>, label <span class="op">=</span> <span class="va">n</span><span class="op">)</span>,</span>
<span>    hjust <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    nudge_y <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">5.5</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">penguin_count</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="va">species</span>, label <span class="op">=</span> <span class="va">species</span><span class="op">)</span>,</span>
<span>    hjust <span class="op">=</span> <span class="fl">0</span>, </span>
<span>    nudge_x <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>    nudge_y <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"white"</span>, </span>
<span>    fontface <span class="op">=</span> <span class="st">"bold"</span>, </span>
<span>    size <span class="op">=</span> <span class="fl">4.5</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/barcharts-rendered-unnamed-chunk-9-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Relatively small changes to a bar chart can make it look much more
professional</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-powerberegninger"><p>Content from <a href="powerberegninger.html">powerberegninger</a></p>
<hr>
<p>Last updated on 2024-10-07 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/powerberegninger.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 12 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How large of a sample do I need to identify a result?</li>
<li>How much confidence can I get using a specific sample size?</li>
<li>How much power can I get using a specific sample size?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to use markdown with the new lesson template</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>We have some data on the lung volume of children, and want to see if
there is a difference between the (mean) lung volume of the two sexes.
Ie if the mean for boys is 1.87 and for girls is 1.84, there obviously
is a difference. But is it significant?</p>
<p>We would do that by running at two-sample t-test. The null-hypothesis
is that there is no difference between the mean of the two samples, and
if the p-value is smaller than (typically) 0.05, we will reject the
null-hypothesis.</p>
<p>That is not the same as concluding that there <em>is</em> a
difference, just that the risk of of observing such a difference by
random chance, if there really were no difference, is low (less than
5%).</p>
<p>This can go wrong in two ways. There might actually be no difference,
but we reject the null-hypothesis anyway, and conclude that a difference
exist. That is a false positive; we see a difference where none is. We
also call it a type I error.</p>
<p>On the other hand, there might really be a diffence, but we fail to
reject the null hypothesis, that is we conclude that no difference
exist, even though there <em>is</em> a difference. That is a false
negative, or a type II error.</p>
<p>The risk of a type I error is <span class="math inline">\(\alpha\)</span> - which is what we specify
choosing a level of significance, typically 0.05.</p>
<p>The risk of a type II error is related to the concept of “power”, or
<span class="math inline">\(\beta\)</span>. Thas is the chance of seeing
a difference where such a difference actually exists. And the risk of
not seeing it is therefore <span class="math inline">\(1-\beta\)</span>.</p>
<p>These two concepts are combined in power-calculations.</p>
</section><section><h2 class="section-heading" id="how-many-children-do-we-need-to-test">How many children do we need to test?<a class="anchor" aria-label="anchor" href="#how-many-children-do-we-need-to-test"></a>
</h2>
<hr class="half-width">
<p>We begin by loading the data. You can download the data <a href="https://raw.githubusercontent.com/KUBDatalab/R-toolbox/main/episodes/data/FEV.csv" class="external-link">from
this link</a>.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"data/FEV.csv"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Rows: 654 Columns: 6
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (6): Id, Age, FEV, Hgt, Sex, Smoke

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<p>The dataset have measurements of the lung capacity (FEV) for boys and
girls between the ages of 3 and 19. Since we know that there
<em>are</em> significant differences between the two sexes once they
reach puberty, we will be looking at the data for prepubescent
children.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">Age</span> <span class="op">&lt;</span> <span class="fl">10</span><span class="op">)</span></span></code></pre>
</div>
<p>The means and standard deviations can be calculated like this:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">Sex</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">summarise</span><span class="op">(</span>mean <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">FEV</span><span class="op">)</span>,</span>
<span>          sd <span class="op">=</span> <span class="fu">sd</span><span class="op">(</span><span class="va">FEV</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 2 × 3
    Sex  mean    sd
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0  2.00 0.508
2     1  2.07 0.514</code></pre>
</div>
<p>In this dataset the girls are coded as “0” and the boys as “1”. We
see a difference of 0.0757019.</p>
<p>Is there a difference? The null-hypothesis is that there is not. We
have two independent samples, so we are running a two-sample-t-test:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">girls</span> <span class="op">&lt;-</span> <span class="va">test_data</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">filter</span><span class="op">(</span><span class="va">Sex</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">boys</span> <span class="op">&lt;-</span> <span class="va">test_data</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">filter</span><span class="op">(</span><span class="va">Sex</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">t.test</span><span class="op">(</span><span class="va">boys</span><span class="op">$</span><span class="va">FEV</span>, <span class="va">girls</span><span class="op">$</span><span class="va">FEV</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Welch Two Sample t-test

data:  boys$FEV and girls$FEV
t = 1.3021, df = 306.88, p-value = 0.1939
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -0.03870191  0.19010577
sample estimates:
mean of x mean of y
 2.070799  1.995097 </code></pre>
</div>
<p>The p-value is larger than 0.05, so we do not reject the
null-hypothesis, and conclude that even though there might be a
difference, we cannot rule out the possibility that the difference we
see between the two means is happening by chance.</p>
<p>How many children should we measure, if we wanted to see a difference
of 0.0757019?</p>
<p>That is, how large a sample should we have, if we want to detect an
actual difference as small as this? This difference is often called the
effect-size.</p>
<p>The effect size is relative to the absolute size of the means. A
difference of 0.08 is easier to detect when it is between 1.99 and 2.07
than if it is between 5461.31 and 5461.39.</p>
<p>Therefore we measure the effect size in standard deviations rather
than in absolute values. We denote that as <code>d</code> or Cohen’s
d. Often we want to see a specific effect size: 0.2 is considered small,
0.5 as medium and 0.8 as large.</p>
<p>In this case we have an effect size, but needs to convert it to
standard deviations:</p>
<p><span class="math display">\[d = \frac{\mu_{boys} -
\mu_{girls}}{\sigma_{pooled}}\]</span></p>
<p>Where the pooled standard deviation is calculated with:</p>
<p><span class="math display">\[\sigma_{pooled} =
\sqrt{\frac{(n_{boys}-1)s_{boys}^2 +
(n_{girls}-1)s_{girls}^2}{n_{boys}+n_{girls} -2}}\]</span></p>
<p>Which is a weighted average of the two standard deviations.</p>
<p>We need the following values:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">Sex</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span>, mean <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">FEV</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fu">sd</span><span class="op">(</span><span class="va">FEV</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 2 × 4
    Sex     n  mean    sd
  &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0   155  2.00 0.508
2     1   154  2.07 0.514</code></pre>
</div>
<p>And now get the pooled standard deviation with:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s_p</span> <span class="op">&lt;-</span> <span class="fu">sqrt</span><span class="op">(</span><span class="op">(</span><span class="op">(</span><span class="fl">154</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fl">0.5144072</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="op">(</span><span class="fl">155</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fl">0.5075533</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">154</span><span class="op">+</span><span class="fl">155</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>And can then calculate Cohen’s d, or, the effect size in standard
deviations:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">2.070799</span><span class="op">-</span><span class="fl">1.995097</span><span class="op">)</span><span class="op">/</span><span class="va">s_p</span></span>
<span><span class="va">d</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.1481504</code></pre>
</div>
<p>Now we almost have all our ducks in a row. There is only one number
we need to decide on - the power. In this example we decide that it
should be 0.9. To reiterate: If the difference exists, we want to have a
90% chance of detecting it.</p>
<p>Or, conversely, we are willing to accept a 10% chance of a type II
error, where we fail to detect the difference.</p>
<p>R has a built in function for doing the final calculation for a two
sample t test. But we are going to use the <code>pwr</code> library. The
results are the same, but the calculations are different for different
tests, and <code>pwr</code> provides functions for handling other
tests.</p>
<p>The function we are going to use is <code>pwr.t.test</code>:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">pwr</span><span class="op">)</span></span>
<span><span class="fu">pwr.t.test</span><span class="op">(</span>d<span class="op">=</span><span class="va">d</span>, sig.level <span class="op">=</span> <span class="fl">0.05</span>, power <span class="op">=</span> <span class="fl">0.9</span>, type <span class="op">=</span> <span class="st">"two.sample"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
     Two-sample t test power calculation

              n = 958.4203
              d = 0.1481504
      sig.level = 0.05
          power = 0.9
    alternative = two.sided

NOTE: n is number in *each* group</code></pre>
</div>
<p>We specify the effect size (d), the significanse level (0.05), the
power we want (0.9), and the type of test we want to be able to do on
the data (“two.sample”).</p>
<p>And get the result that we need (at least) 959 observations in
<em>each</em> group, in order to see the wanted effect size, with at a
5% significanse level and with a power of 0.9.</p>
</section><section><h2 class="section-heading" id="how-large-effect-sizes-can-we-see">How large effect sizes can we see?<a class="anchor" aria-label="anchor" href="#how-large-effect-sizes-can-we-see"></a>
</h2>
<hr class="half-width">
<p>The function is smart. There are four numbers involved: The effect
size, the significanse level, the power and the number of observations.
They are all connected, and if we specify three of them, we will get the
fourth.</p>
<p>Given the number of observations we have, we can calculate the power
of the test:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pwr.t.test</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">155</span>, d<span class="op">=</span><span class="va">d</span>, sig.level <span class="op">=</span> <span class="fl">0.05</span>, type <span class="op">=</span> <span class="st">"two.sample"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
     Two-sample t test power calculation

              n = 155
              d = 0.1481504
      sig.level = 0.05
          power = 0.2552478
    alternative = two.sided

NOTE: n is number in *each* group</code></pre>
</div>
<p>There is ~75% chance of getting a type II error.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Use <code>.md</code> files for episodes when you want static
content</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-kmeans"><p>Content from <a href="kmeans.html">k-means</a></p>
<hr>
<p>Last updated on 2024-10-07 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/kmeans.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 12 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do you write a lesson using R Markdown and
<a href="https://carpentries.github.io/sandpaper/" class="external-link">sandpaper</a>?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to use markdown with the new lesson template</li>
<li>Demonstrate how to include pieces of code, figures, and nested
challenge blocks</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="what-is-k-means">What is k-means?<a class="anchor" aria-label="anchor" href="#what-is-k-means"></a>
</h2>
<hr class="half-width">
<p>k-means is a clustering algorithm. We have some data, and we would
like to partition that data into a set of distinct, non-overlapping
clusters.</p>
<p>And we would like those clusters to be based on the similarity of the
features of the data.</p>
<p>When we talk about features, we talk about variables, or dimensions
in the data.</p>
<p>k-means is an unsupervised machine learning algorithm. We do not know
the “true” groups, but simply want to group the results.</p>
<p>Here we have some data on wine. Different parameters of wine from
three different grapes (or cultivars) have been measured. Most of them
are chemical measurements.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vin</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"data/win/wine.data"</span>, col_names <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Rows: 178 Columns: 14
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (14): X1, X2, X3, X4, X5, X6, X7, X8, X9, X10, X11, X12, X13, X14

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">names</span><span class="op">(</span><span class="va">vin</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"cultivar"</span>,</span>
<span>                <span class="st">"Alcohol"</span>,</span>
<span>                <span class="st">"Malicacid"</span>,</span>
<span>                <span class="st">"Ash"</span>,</span>
<span>                <span class="st">"Alcalinityofash"</span>,</span>
<span>                <span class="st">"Magnesium"</span>,</span>
<span>                <span class="st">"Totalphenols"</span>,</span>
<span>                <span class="st">"Flavanoids"</span>,</span>
<span>                <span class="st">"Nonflavanoidphenols"</span>,</span>
<span>                <span class="st">"Proanthocyanins"</span>,</span>
<span>                <span class="st">"Colorintensity"</span>,</span>
<span>                <span class="st">"Hue"</span>,</span>
<span>                <span class="st">"OD280OD315ofdilutedwines"</span>,</span>
<span>                <span class="st">"Proline"</span><span class="op">)</span></span></code></pre>
</div>
<p>Here we have chosen a data set where we know the “true” values in
order to illustrate the process.</p>
</section><section><h2 class="section-heading" id="what-does-it-do">What does it do?<a class="anchor" aria-label="anchor" href="#what-does-it-do"></a>
</h2>
<hr class="half-width">
<p>K-means works by chosing K - the number of clusters we want. That is
a choice entirely up to us.</p>
<p>The algorithm then choses K random points, also called centroids. In
this case these centroids are in 13 dimensions, because we have 13
features in the dataset.</p>
<p>It then calculates the distance from each observation in the data, to
each of the K centroids. After that each observation is assigned to the
centroid it is closest to. We are going to set K = 3 because we know
that there are three clusters in the data. Each point will therefore be
assigned to a specific cluster, described by the relevant centroid.</p>
<p>The algorithm then calculates three new centroids. All the
observations assigned to centroid A are averaged, and we get a new
centroid. The same calculations are done for the other two centroids,
and we now have three new centroids. They now actually have a relation
to the data - before they we assigned randomly, now they are based on
the data.</p>
<p>Now the algorithm repeats the calculation of distance. For each
observation in the data, which centroid is it closest to. Since we
calculated new centroids, some of the observations will switch and will
be assigned to a new centroid.</p>
<p>Again the new assignments of observations are used to calculate new
centroids for the three clusters, and all calculations repeated until no
observations swithces between clusters, or we have repeated the
algorithm a set number of times (by default 10 times).</p>
<p>After that, we have clustered our data in three (or whatever K we
chose) clusters, based on the features of the data.</p>
</section><section><h2 class="section-heading" id="how-do-we-actually-do-that">How do we actually do that?<a class="anchor" aria-label="anchor" href="#how-do-we-actually-do-that"></a>
</h2>
<hr class="half-width">
<p>The algorithm only works with numerical data, and we of course have
to remove the variable containing the “true” clusters.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cluster_data</span> <span class="op">&lt;-</span> <span class="va">vin</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">cultivar</span><span class="op">)</span></span></code></pre>
</div>
<p>After that, we run the function <code>kmeans</code>, and specify that
we want three centers (K), and save the result to an object, that we can
work with afterwards:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clustering</span> <span class="op">&lt;-</span> <span class="fu">kmeans</span><span class="op">(</span><span class="va">cluster_data</span>, centers <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">clustering</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>K-means clustering with 3 clusters of sizes 50, 28, 100

Cluster means:
   Alcohol Malicacid    Ash Alcalinityofash Magnesium Totalphenols Flavanoids
1 13.33680  2.396800 2.3718        18.51000  108.6000     2.432400   2.214800
2 13.82214  1.773929 2.4900        16.96429  105.3571     2.923929   3.111429
3 12.60250  2.463600 2.3293        20.69600   93.7400     2.050400   1.633500
  Nonflavanoidphenols Proanthocyanins Colorintensity      Hue
1           0.3236000        1.707200       5.143600 0.966720
2           0.2985714        1.986786       6.202857 1.103571
3           0.3987000        1.421900       4.694800 0.911900
  OD280OD315ofdilutedwines Proline
1                 2.862800  894.60
2                 2.984643 1301.50
3                 2.381700  517.75

Clustering vector:
  [1] 1 1 2 2 1 2 2 2 1 1 2 2 2 2 2 2 2 2 2 1 1 1 1 1 1 1 2 2 1 1 2 2 1 2 1 1 1
 [38] 2 1 1 1 1 1 3 1 1 1 1 1 2 2 2 2 2 1 2 1 2 2 3 3 3 3 3 3 3 3 3 1 1 1 3 3 1
 [75] 1 3 3 3 1 3 3 1 3 3 3 3 3 3 3 3 3 3 3 3 3 1 3 3 3 3 1 3 3 3 3 3 3 3 3 3 3
[112] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 1 3 3 3 3 1 3 3 1 1 3 3
[149] 3 3 3 3 3 3 3 1 3 1 3 3 3 3 3 3 3 3 3 3 1 3 3 3 3 1 1 1 1 3

Within cluster sum of squares by cluster:
[1]  815783.7  550201.0 1263330.5
 (between_SS / total_SS =  85.1 %)

Available components:

[1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
[6] "betweenss"    "size"         "iter"         "ifault"      </code></pre>
</div>
<p>We know the true values, so we extract the clusters the algorithm
found, and match them with the true values, and count the matches:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tibble</span><span class="op">(</span>quess <span class="op">=</span> <span class="va">clustering</span><span class="op">$</span><span class="va">cluster</span>, true <span class="op">=</span> <span class="va">vin</span><span class="op">$</span><span class="va">cultivar</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">table</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>     true
quess  1  2  3
    1 30  9 11
    2 28  0  0
    3  1 62 37</code></pre>
</div>
<p>The algorithm have no idea about the numbering, the three groups are
numbered 1 to 3 randomly. It appears that cluster 2 from the algorithm
matches cluster 2 from the data. The two other clusters are a bit more
confusing.</p>
<p>Does that mean the algorithm does a bad job?</p>
</section><section><h2 class="section-heading" id="preprocessing-is-necessary">Preprocessing is necessary!<a class="anchor" aria-label="anchor" href="#preprocessing-is-necessary"></a>
</h2>
<hr class="half-width">
<p>Looking at the data give a hint about the problems:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># head(vin)</span></span></code></pre>
</div>
<p>Note the differences between the values of “Malicacid” and
“Magnesium”. One have values between 0.74 and 5.8 and the other bewtten
70 and 162. The latter influences the means much more that the
former.</p>
<p>It is therefore good practice to scale the features to have the same
range and standard deviation:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scaled_data</span> <span class="op">&lt;-</span> <span class="fu">scale</span><span class="op">(</span><span class="va">cluster_data</span><span class="op">)</span></span></code></pre>
</div>
<p>If we now do the same clustering as before, but now on the scaled
data, we get much better results:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">clustering</span> <span class="op">&lt;-</span> <span class="fu">kmeans</span><span class="op">(</span><span class="va">scaled_data</span>, centers <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu">tibble</span><span class="op">(</span>quess <span class="op">=</span> <span class="va">clustering</span><span class="op">$</span><span class="va">cluster</span>, true <span class="op">=</span> <span class="va">vin</span><span class="op">$</span><span class="va">cultivar</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">table</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>     true
quess  1  2  3
    1 59  3  0
    2  0 65  0
    3  0  3 48</code></pre>
</div>
<p>By chance, the numbering of the clusters now matches the “true”
cluster numbers.</p>
<p>The clustering is not perfect. 3 observations belonging to cluster 2,
are assigned to cluster 1 by the algorithm (and 3 more to cluster
3).</p>
</section><section><h2 class="section-heading" id="what-are-those-distances">What are those distances?<a class="anchor" aria-label="anchor" href="#what-are-those-distances"></a>
</h2>
<hr class="half-width">
<p>It is easy to measure the distance between two observations when we
only have two features/dimensions: Plot them on a piece of paper, and
bring out the ruler.</p>
<p>But what is the distance between this point:</p>
<p>1, 14.23, 1.71, 2.43, 15.6, 127, 2.8, 3.06, 0.28, 2.29, 5.64, 1.04,
3.92, 1065 and 1, 13.2, 1.78, 2.14, 11.2, 100, 2.65, 2.76, 0.26, 1.28,
4.38, 1.05, 3.4, 1050?</p>
<p>Rather than plotting and measuring, if we only have two observations
with two features, and we call the the observations <span class="math inline">\((x_1, y_1)\)</span> and <span class="math inline">\((x_2,y_2)\)</span> we can get the distance using
this formula:</p>
<p><span class="math display">\[d = \sqrt{(x_2 - x_1)^2 + (y_2 - y_1)^2}
\]</span></p>
<p>For an arbitrary number of dimensions we get this: <span class="math display">\[d = \sqrt{\sum_{i=1}^{n} \left(x_2^{(i)} -
x_1^{(i)}\right)^2}\]</span></p>
<p>Where the weird symbol under the squareroot sign indicates that we
add all the squared differences between the pairs of observations.</p>
</section><section><h2 class="section-heading" id="is-the-clustering-reproducible">Is the clustering reproducible?<a class="anchor" aria-label="anchor" href="#is-the-clustering-reproducible"></a>
</h2>
<hr class="half-width">
<p>Not nessecarily. If there <em>are</em> very clear clusters, in
general it will be.</p>
<p>But the algorithm is able to find clusters even if there are
none:</p>
<p>Here we have 1000 observations of two features:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_data</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span>x <span class="op">=</span> <span class="fu">rnorm</span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu">rnorm</span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>They are as random as the random number generator can do it.</p>
<p>Let us make one clustering, and then another:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">47</span><span class="op">)</span></span>
<span><span class="va">kmeans_model1</span> <span class="op">&lt;-</span> <span class="fu">kmeans</span><span class="op">(</span><span class="va">test_data</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">kmeans_model2</span> <span class="op">&lt;-</span> <span class="fu">kmeans</span><span class="op">(</span><span class="va">test_data</span>, <span class="fl">5</span><span class="op">)</span></span></code></pre>
</div>
<p>And then extract the clustering and match them like before:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tibble</span><span class="op">(</span>take_one <span class="op">=</span> <span class="va">kmeans_model1</span><span class="op">$</span><span class="va">cluster</span>,</span>
<span>        take_two <span class="op">=</span> <span class="va">kmeans_model2</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">table</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>        take_two
take_one   1   2   3   4   5
       1   2 132   0  23   0
       2   2   0 217   0   2
       3   0   0  11   1 124
       4 127  73   9   0   0
       5   0  68   1 121  87</code></pre>
</div>
<p>Two clusterings on the exact same data. And they are pretty
different.</p>
<p>Visualizing it makes it even more apparent:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tibble</span><span class="op">(</span>take_one <span class="op">=</span> <span class="va">kmeans_model1</span><span class="op">$</span><span class="va">cluster</span>,</span>
<span>        take_two <span class="op">=</span> <span class="va">kmeans_model2</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span>  <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">cbind</span><span class="op">(</span><span class="va">test_data</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,color<span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">take_one</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/kmeans-rendered-unnamed-chunk-11-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tibble</span><span class="op">(</span>take_one <span class="op">=</span> <span class="va">kmeans_model1</span><span class="op">$</span><span class="va">cluster</span>,</span>
<span>        take_two <span class="op">=</span> <span class="va">kmeans_model2</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span>  <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">cbind</span><span class="op">(</span><span class="va">test_data</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,color<span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">take_two</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/kmeans-rendered-unnamed-chunk-12-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></section><section><h2 class="section-heading" id="can-it-be-use-on-any-data">Can it be use on any data?<a class="anchor" aria-label="anchor" href="#can-it-be-use-on-any-data"></a>
</h2>
<hr class="half-width">
<p>No. Even though there might actually be clusters in the data, the
algorithm is not nessecarily able to find them. Consider this data:</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_data</span> <span class="op">&lt;-</span> <span class="fu">rbind</span><span class="op">(</span></span>
<span>  <span class="fu">data.frame</span><span class="op">(</span>x <span class="op">=</span> <span class="fu">rnorm</span><span class="op">(</span><span class="fl">200</span>, <span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu">rnorm</span><span class="op">(</span><span class="fl">200</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, z <span class="op">=</span> <span class="fu">rep</span><span class="op">(</span><span class="st">"A"</span>, <span class="fl">200</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">data.frame</span><span class="op">(</span>x <span class="op">=</span> <span class="fu">runif</span><span class="op">(</span><span class="fl">1400</span>, <span class="op">-</span><span class="fl">30</span>,<span class="fl">30</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu">runif</span><span class="op">(</span><span class="fl">1400</span>,<span class="op">-</span><span class="fl">30</span>,<span class="fl">30</span><span class="op">)</span>, z <span class="op">=</span> <span class="fu">rep</span><span class="op">(</span><span class="st">"B"</span>, <span class="fl">1400</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">filter</span><span class="op">(</span><span class="fu">abs</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">10</span> <span class="op">|</span> <span class="fu">abs</span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">test_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>, color <span class="op">=</span> <span class="va">z</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p><img src="../fig/kmeans-rendered-unnamed-chunk-13-1.png" style="display: block; margin: auto;" class="figure">
There is obviously a cluster centered around (0,0). And another cluster
more or lesss evenly spread around it.</p>
<p>The algorithm <em>will</em> find two clusters:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kmeans_model3</span> <span class="op">&lt;-</span> <span class="fu">kmeans</span><span class="op">(</span><span class="va">test_data</span><span class="op">[</span>,<span class="op">-</span><span class="fl">3</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">cluster3</span> <span class="op">&lt;-</span> <span class="fu">augment</span><span class="op">(</span><span class="va">kmeans_model3</span>, <span class="va">test_data</span><span class="op">[</span>,<span class="op">-</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in augment(kmeans_model3, test_data[, -3]): could not find function "augment"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">cluster3</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,color<span class="op">=</span><span class="va">.cluster</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'cluster3' not found</code></pre>
</div>
<p>But not the ones we want.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Use <code>.md</code> files for episodes when you want static
content</li>
<li>Use <code>.Rmd</code> files for episodes when you need to generate
output</li>
<li>Run <code>sandpaper::check_lesson()</code> to identify any issues
with your lesson</li>
<li>Run <code>sandpaper::build_lesson()</code> to preview your lesson
locally</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-factor-analysis"><p>Content from <a href="factor-analysis.html">Factor Analysis</a></p>
<hr>
<p>Last updated on 2024-10-07 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/factor-analysis.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 12 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do you write a lesson using R Markdown and
<a href="https://carpentries.github.io/sandpaper/" class="external-link">sandpaper</a>?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to use markdown with the new lesson template</li>
<li>Demonstrate how to include pieces of code, figures, and nested
challenge blocks</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Minder en del om pca - også i matematikken. Antager at der er et
mindre antal underliggende faktorer, som kan forklare observationerne.
Det er de underliggende faktorer vi forsøger at belyse. faktoranalysen
forklarer kovariansen i data. pca forklarer variansen.</p>
<p>en pca komponent er en lineær kombination af observerede variable.
faktoranalysen leder til at de observerede variable er en linear
kombination af uobserverede variable eller faktorer.</p>
<p>PCA er dimensionsreducerende. FA finder latente variable.</p>
<p>PCA er en type af faktoranalyse. Men er observationel, mens FA er en
modelleringsteknik.</p>
<p>fa kører i to trin. Eksplorativ faktoranalyse, hvor vi identificerer
faktorerne. og confirmatory faktoranalyse, hvor vi bekræfter at vi
faktisk fik identificeret faktorerne.</p>
<p>Den er vældig brugt i psykologien.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">lavaan</span><span class="op">)</span> </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>This is lavaan 0.6-19
lavaan is FREE software! Please report any bugs.</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     </code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">psych</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Attaching package: 'psych'

The following objects are masked from 'package:ggplot2':

    %+%, alpha

The following object is masked from 'package:lavaan':

    cor2cov</code></pre>
</div>
<p>Let us look at some data:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">glimpse</span><span class="op">(</span><span class="va">HolzingerSwineford1939</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Rows: 301
Columns: 15
$ id     &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 18, 19, …
$ sex    &lt;int&gt; 1, 2, 2, 1, 2, 2, 1, 2, 2, 2, 1, 1, 2, 2, 1, 2, 2, 1, 2, 2, 1, …
$ ageyr  &lt;int&gt; 13, 13, 13, 13, 12, 14, 12, 12, 13, 12, 12, 12, 12, 12, 12, 12,…
$ agemo  &lt;int&gt; 1, 7, 1, 2, 2, 1, 1, 2, 0, 5, 2, 11, 7, 8, 6, 1, 11, 5, 8, 3, 1…
$ school &lt;fct&gt; Pasteur, Pasteur, Pasteur, Pasteur, Pasteur, Pasteur, Pasteur, …
$ grade  &lt;int&gt; 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, …
$ x1     &lt;dbl&gt; 3.333333, 5.333333, 4.500000, 5.333333, 4.833333, 5.333333, 2.8…
$ x2     &lt;dbl&gt; 7.75, 5.25, 5.25, 7.75, 4.75, 5.00, 6.00, 6.25, 5.75, 5.25, 5.7…
$ x3     &lt;dbl&gt; 0.375, 2.125, 1.875, 3.000, 0.875, 2.250, 1.000, 1.875, 1.500, …
$ x4     &lt;dbl&gt; 2.333333, 1.666667, 1.000000, 2.666667, 2.666667, 1.000000, 3.3…
$ x5     &lt;dbl&gt; 5.75, 3.00, 1.75, 4.50, 4.00, 3.00, 6.00, 4.25, 5.75, 5.00, 3.5…
$ x6     &lt;dbl&gt; 1.2857143, 1.2857143, 0.4285714, 2.4285714, 2.5714286, 0.857142…
$ x7     &lt;dbl&gt; 3.391304, 3.782609, 3.260870, 3.000000, 3.695652, 4.347826, 4.6…
$ x8     &lt;dbl&gt; 5.75, 6.25, 3.90, 5.30, 6.30, 6.65, 6.20, 5.15, 4.65, 4.55, 5.7…
$ x9     &lt;dbl&gt; 6.361111, 7.916667, 4.416667, 4.861111, 5.916667, 7.500000, 4.8…</code></pre>
</div>
<p>We have 301 observations. School children (with an id) of different
sex (sex), age (ageyr, agemo) at different schools (school) and
different grades (grade) have been tested on their ability to solve a
battery of tasks:</p>
<ul>
<li>x1 Visual Perception - A test measuring visual perception
abilities.</li>
<li>x2 Cubes - A test assessing the ability to mentally rotate
three-dimensional objects.</li>
<li>x3 Lozenges - A test that evaluates the ability to identify shape
changes.</li>
<li>x4 Paragraph Comprehension - A test of reading comprehension,
measuring the ability to understand written paragraphs.</li>
<li>x5 Sentence Completion - A test that assesses the ability to
complete sentences, typically reflecting verbal ability.</li>
<li>x6 Word Meaning - A test measuring the understanding of word
meanings, often used as a gauge of vocabulary knowledge.</li>
<li>x7 Speeded Addition - A test of arithmetic skills, focusing on the
ability to perform addition.</li>
<li>x8 speeded counting of dots - A test that evaluates counting skills
using dot patterns.</li>
<li>x9 speeded discrimination straight and curved capitals - A test
measuring the ability to recognize straight and curved capital letters
in text.</li>
</ul>
<p>The thesis is, that there are some underlying factors.</p>
<p>Spatial ability - the ability to perceive and manipulate visual and
spatial information, x1, x2 og x3. verbal ability x4,x5 og x6
mathematical ability - x7 og x8 speed of processing - x9</p>
<p>The thinking is, that if the student is good at math, he or she will
score high on x7 and x8. That is, a student scoring high on x7 will
probably score high x8. Or low on both.</p>
<p>This makes intuitive sense. But we would like to be able to actually
identify these underlying factors.</p>
<div class="section level3">
<h3 id="exploratory">Exploratory<a class="anchor" aria-label="anchor" href="#exploratory"></a>
</h3>
<p>We do a factor analysis, and ask for 9 factors - that is the maximum
factors we can expect.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">psych</span><span class="op">)</span></span>
<span><span class="va">hs.efa</span> <span class="op">&lt;-</span> <span class="fu">fa</span><span class="op">(</span><span class="fu">select</span><span class="op">(</span><span class="va">HolzingerSwineford1939</span>, <span class="va">x1</span><span class="op">:</span><span class="va">x9</span><span class="op">)</span>, nfactors <span class="op">=</span> <span class="fl">9</span>, </span>
<span>             rotate <span class="op">=</span> <span class="st">"none"</span>, fm <span class="op">=</span> <span class="st">"ml"</span><span class="op">)</span></span>
<span><span class="va">hs.efa</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Factor Analysis using method =  ml
Call: fa(r = select(HolzingerSwineford1939, x1:x9), nfactors = 9, rotate = "none",
    fm = "ml")
Standardized loadings (pattern matrix) based upon correlation matrix
    ML1   ML2   ML3 ML4 ML5 ML6 ML7 ML8 ML9   h2   u2 com
x1 0.50  0.31  0.32   0   0   0   0   0   0 0.44 0.56 2.4
x2 0.26  0.19  0.38   0   0   0   0   0   0 0.25 0.75 2.3
x3 0.29  0.40  0.38   0   0   0   0   0   0 0.38 0.62 2.8
x4 0.81 -0.17 -0.03   0   0   0   0   0   0 0.69 0.31 1.1
x5 0.81 -0.21 -0.08   0   0   0   0   0   0 0.70 0.30 1.2
x6 0.81 -0.15  0.01   0   0   0   0   0   0 0.67 0.33 1.1
x7 0.23  0.41 -0.44   0   0   0   0   0   0 0.41 0.59 2.5
x8 0.27  0.55 -0.28   0   0   0   0   0   0 0.45 0.55 2.0
x9 0.39  0.54 -0.03   0   0   0   0   0   0 0.44 0.56 1.8

                       ML1  ML2  ML3  ML4  ML5  ML6  ML7  ML8  ML9
SS loadings           2.63 1.15 0.67 0.00 0.00 0.00 0.00 0.00 0.00
Proportion Var        0.29 0.13 0.07 0.00 0.00 0.00 0.00 0.00 0.00
Cumulative Var        0.29 0.42 0.49 0.49 0.49 0.49 0.49 0.49 0.49
Proportion Explained  0.59 0.26 0.15 0.00 0.00 0.00 0.00 0.00 0.00
Cumulative Proportion 0.59 0.85 1.00 1.00 1.00 1.00 1.00 1.00 1.00

Mean item complexity =  1.9
Test of the hypothesis that 9 factors are sufficient.

df null model =  36  with the objective function =  3.05 with Chi Square =  904.1
df of  the model are -9  and the objective function was  0.11

The root mean square of the residuals (RMSR) is  0.03
The df corrected root mean square of the residuals is  NA

The harmonic n.obs is  301 with the empirical chi square  19.16  with prob &lt;  NA
The total n.obs was  301  with Likelihood Chi Square =  33.29  with prob &lt;  NA

Tucker Lewis Index of factoring reliability =  1.199
Fit based upon off diagonal values = 0.99
Measures of factor score adequacy
                                                   ML1  ML2   ML3 ML4 ML5 ML6
Correlation of (regression) scores with factors   0.93 0.80  0.70   0   0   0
Multiple R square of scores with factors          0.86 0.65  0.49   0   0   0
Minimum correlation of possible factor scores     0.72 0.29 -0.03  -1  -1  -1
                                                  ML7 ML8 ML9
Correlation of (regression) scores with factors     0   0   0
Multiple R square of scores with factors            0   0   0
Minimum correlation of possible factor scores      -1  -1  -1</code></pre>
</div>
<p>De enkelte elementer: SS loadings (Sum of Squared Loadings): Summen
af kvadrerede faktorbelastninger for hver faktor. Dette viser, hvor
meget varians hver faktor forklarer.</p>
<p>For ML1 er det 2.63, hvilket betyder, at denne faktor forklarer det
meste af variansen blandt de faktorer, der blev estimeret. ML4 til ML9
forklarer ingen varians (0.00), hvilket bekræfter din observation om, at
kun de første få faktorer er betydningsfulde. Proportion Var (Proportion
of Variance): Andelen af total varians forklaret af hver faktor.</p>
<p>ML1 forklarer 29% af variansen, ML2 forklarer 13%, og ML3 forklarer
7%. De resterende faktorer forklarer ingen varians. Cumulative Var
(Cumulative Variance): Den kumulative andel af total varians forklaret
op til og med den pågældende faktor.</p>
<p>ML1 alene forklarer 29% af variansen. De første tre faktorer
tilsammen forklarer 49%. Proportion Explained: Procentdelen af den
forklarede varians, der kan tilskrives hver faktor.</p>
<p>ML1 står for 59% af den forklarede varians, ML2 står for 26%, og ML3
står for 15%. Cumulative Proportion: Den kumulative andel af den
forklarede varians.</p>
<p>De første tre faktorer forklarer 100% af variansen, hvilket
indikerer, at resten af faktorerne ikke bidrager yderligere til at
forklare variansen.</p>
<p>Mean Item Complexity Dette tal repræsenterer gennemsnittet af
antallet af faktorer, som hver variabel har betydelige belastninger på.
En værdi på 1.9 indikerer, at de fleste variabler har betydelige
belastninger på næsten 2 faktorer.</p>
<p>Model Fit df null model: Antal frihedsgrader i nulmodellen (den
model, der antager, at alle variabler er ukorrelerede). Chi Square:
Chi-kvadrat statistikken for nulmodellen. df of the model: Antal
frihedsgrader i den estimerede model. En negativ værdi indikerer en
overparametriseret model (flere faktorer end dataene kan understøtte).
Objective Function: Værdien af objektivfunktionen for den estimerede
model.</p>
<p>RMSR (Root Mean Square Residual) RMSR: Gennemsnittet af kvadratroden
af residualerne (forskellen mellem de observerede og modelpredikterede
værdier). En lav RMSR indikerer en god modeltilpasning.</p>
<p>Chi Square and Fit Indices Harmonic n.obs: Det harmoniske gennemsnit
af antallet af observationer. Empirical Chi Square: Den empiriske
chi-kvadrat værdi. Likelihood Chi Square: Chi-kvadrat statistikken for
modellen baseret på likelihood metoden. Tucker Lewis Index (TLI): En
fit-indeks, hvor værdier over 0.9 typisk indikerer en god
modeltilpasning. En værdi på 1.199 er meget høj. Fit based upon off
diagonal values: Indikator for modeltilpasning baseret på off-diagonale
værdier i residualkorrelationsmatricen. En værdi på 0.99 indikerer
fremragende fit.</p>
<p>Often a visual representation of the model is useful:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot</span><span class="op">(</span><span class="va">hs.efa</span><span class="op">$</span><span class="va">e.values</span><span class="op">)</span></span></code></pre>
</div>
<p><img src="../fig/factor-analysis-rendered-unnamed-chunk-3-1.png" style="display: block; margin: auto;" class="figure">
The rule of thumb is that we reject factors with an eigenvalue lower
than 1.0.</p>
<p>Three factors are sufficient. We now do the factor analysis
again:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hs.efa</span> <span class="op">&lt;-</span> <span class="fu">fa</span><span class="op">(</span><span class="fu">select</span><span class="op">(</span><span class="va">HolzingerSwineford1939</span>, <span class="va">x1</span><span class="op">:</span><span class="va">x9</span><span class="op">)</span>, nfactors <span class="op">=</span> <span class="fl">3</span>, </span>
<span>             rotate <span class="op">=</span> <span class="st">"none"</span>, fm <span class="op">=</span> <span class="st">"ml"</span><span class="op">)</span></span>
<span><span class="va">hs.efa</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Factor Analysis using method =  ml
Call: fa(r = select(HolzingerSwineford1939, x1:x9), nfactors = 3, rotate = "none",
    fm = "ml")
Standardized loadings (pattern matrix) based upon correlation matrix
    ML1   ML2   ML3   h2   u2 com
x1 0.49  0.31  0.39 0.49 0.51 2.7
x2 0.24  0.17  0.40 0.25 0.75 2.1
x3 0.27  0.41  0.47 0.46 0.54 2.6
x4 0.83 -0.15 -0.03 0.72 0.28 1.1
x5 0.84 -0.21 -0.10 0.76 0.24 1.2
x6 0.82 -0.13  0.02 0.69 0.31 1.0
x7 0.23  0.48 -0.46 0.50 0.50 2.4
x8 0.27  0.62 -0.27 0.53 0.47 1.8
x9 0.38  0.56  0.02 0.46 0.54 1.8

                       ML1  ML2  ML3
SS loadings           2.72 1.31 0.82
Proportion Var        0.30 0.15 0.09
Cumulative Var        0.30 0.45 0.54
Proportion Explained  0.56 0.27 0.17
Cumulative Proportion 0.56 0.83 1.00

Mean item complexity =  1.8
Test of the hypothesis that 3 factors are sufficient.

df null model =  36  with the objective function =  3.05 with Chi Square =  904.1
df of  the model are 12  and the objective function was  0.08

The root mean square of the residuals (RMSR) is  0.02
The df corrected root mean square of the residuals is  0.03

The harmonic n.obs is  301 with the empirical chi square  8.03  with prob &lt;  0.78
The total n.obs was  301  with Likelihood Chi Square =  22.38  with prob &lt;  0.034

Tucker Lewis Index of factoring reliability =  0.964
RMSEA index =  0.053  and the 90 % confidence intervals are  0.015 0.088
BIC =  -46.11
Fit based upon off diagonal values = 1
Measures of factor score adequacy
                                                   ML1  ML2  ML3
Correlation of (regression) scores with factors   0.95 0.86 0.78
Multiple R square of scores with factors          0.90 0.73 0.60
Minimum correlation of possible factor scores     0.80 0.46 0.21</code></pre>
</div>
<p>og hvilke er så med i hvilke?</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hs.efa</span> <span class="op">&lt;-</span> <span class="fu">fa</span><span class="op">(</span><span class="fu">select</span><span class="op">(</span><span class="va">HolzingerSwineford1939</span>, <span class="va">x1</span><span class="op">:</span><span class="va">x9</span><span class="op">)</span>, nfactors <span class="op">=</span> <span class="fl">3</span>, </span>
<span>             rotate <span class="op">=</span> <span class="st">"varimax"</span>, fm <span class="op">=</span> <span class="st">"ml"</span><span class="op">)</span></span>
<span><span class="va">hs.efa</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Factor Analysis using method =  ml
Call: fa(r = select(HolzingerSwineford1939, x1:x9), nfactors = 3, rotate = "varimax",
    fm = "ml")
Standardized loadings (pattern matrix) based upon correlation matrix
    ML1   ML3   ML2   h2   u2 com
x1 0.28  0.62  0.15 0.49 0.51 1.5
x2 0.10  0.49 -0.03 0.25 0.75 1.1
x3 0.03  0.66  0.13 0.46 0.54 1.1
x4 0.83  0.16  0.10 0.72 0.28 1.1
x5 0.86  0.09  0.09 0.76 0.24 1.0
x6 0.80  0.21  0.09 0.69 0.31 1.2
x7 0.09 -0.07  0.70 0.50 0.50 1.1
x8 0.05  0.16  0.71 0.53 0.47 1.1
x9 0.13  0.41  0.52 0.46 0.54 2.0

                       ML1  ML3  ML2
SS loadings           2.18 1.34 1.33
Proportion Var        0.24 0.15 0.15
Cumulative Var        0.24 0.39 0.54
Proportion Explained  0.45 0.28 0.27
Cumulative Proportion 0.45 0.73 1.00

Mean item complexity =  1.2
Test of the hypothesis that 3 factors are sufficient.

df null model =  36  with the objective function =  3.05 with Chi Square =  904.1
df of  the model are 12  and the objective function was  0.08

The root mean square of the residuals (RMSR) is  0.02
The df corrected root mean square of the residuals is  0.03

The harmonic n.obs is  301 with the empirical chi square  8.03  with prob &lt;  0.78
The total n.obs was  301  with Likelihood Chi Square =  22.38  with prob &lt;  0.034

Tucker Lewis Index of factoring reliability =  0.964
RMSEA index =  0.053  and the 90 % confidence intervals are  0.015 0.088
BIC =  -46.11
Fit based upon off diagonal values = 1
Measures of factor score adequacy
                                                   ML1  ML3  ML2
Correlation of (regression) scores with factors   0.93 0.81 0.84
Multiple R square of scores with factors          0.87 0.66 0.70
Minimum correlation of possible factor scores     0.74 0.33 0.40</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print</span><span class="op">(</span><span class="va">hs.efa</span><span class="op">$</span><span class="va">loadings</span>, cutoff <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Loadings:
   ML1    ML3    ML2
x1         0.623
x2         0.489
x3         0.663
x4  0.827
x5  0.861
x6  0.801
x7                0.696
x8                0.709
x9         0.406  0.524

                 ML1   ML3   ML2
SS loadings    2.185 1.343 1.327
Proportion Var 0.243 0.149 0.147
Cumulative Var 0.243 0.392 0.539</code></pre>
</div>
<p>Bum. Så har vi identificeret hvilke manifeste variable der indgår i
hvilke latente faktorer.</p>
</div>
<section><h2 class="section-heading" id="confirmatory-factor-analysis">Confirmatory factor analysis<a class="anchor" aria-label="anchor" href="#confirmatory-factor-analysis"></a>
</h2>
<hr class="half-width">
<p>Nu bør vi hive fat i et nyt datasæt med manifeste variable, og se
hvor godt vores models latente variable beskriver variationen i det.</p>
<p>I praksis er de studerende (og mange andre) dovne og springer over
hvor gærdet er lavest (og hvorfor pokker skulle man også vælge at
springe over hvor det er højest.)</p>
<p>så hvordan laver man den bekræftende analyse?</p>
<p>Vi kal have stillet en model op. Den ser lidt speciel ud.</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HS.model</span> <span class="op">&lt;-</span> <span class="st">'visual  =~ x1 + x2 + x3</span></span>
<span><span class="st">             textual =~ x4 + x5 + x6</span></span>
<span><span class="st">             speed   =~ x7 + x8 + x9'</span></span></code></pre>
</div>
<p>Så fitter vi:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">cfa</span><span class="op">(</span><span class="va">HS.model</span>, data <span class="op">=</span> <span class="va">HolzingerSwineford1939</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>lavaan 0.6-19 ended normally after 35 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        21

  Number of observations                           301

Model Test User Model:

  Test statistic                                85.306
  Degrees of freedom                                24
  P-value (Chi-square)                           0.000</code></pre>
</div>
<p>Nej hvor er det fint. Selvfølgelig er det det. Vi har fittet vores
oprindelige data på den model vi fik fra samme data. Det skal helst være
ret godt.</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="va">fit</span>, standardized<span class="op">=</span><span class="cn">TRUE</span>, fit.measures<span class="op">=</span><span class="cn">TRUE</span>, rsquare<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>lavaan 0.6-19 ended normally after 35 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        21

  Number of observations                           301

Model Test User Model:

  Test statistic                                85.306
  Degrees of freedom                                24
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                               918.852
  Degrees of freedom                                36
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.931
  Tucker-Lewis Index (TLI)                       0.896

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -3737.745
  Loglikelihood unrestricted model (H1)      -3695.092

  Akaike (AIC)                                7517.490
  Bayesian (BIC)                              7595.339
  Sample-size adjusted Bayesian (SABIC)       7528.739

Root Mean Square Error of Approximation:

  RMSEA                                          0.092
  90 Percent confidence interval - lower         0.071
  90 Percent confidence interval - upper         0.114
  P-value H_0: RMSEA &lt;= 0.050                    0.001
  P-value H_0: RMSEA &gt;= 0.080                    0.840

Standardized Root Mean Square Residual:

  SRMR                                           0.065

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual =~
    x1                1.000                               0.900    0.772
    x2                0.554    0.100    5.554    0.000    0.498    0.424
    x3                0.729    0.109    6.685    0.000    0.656    0.581
  textual =~
    x4                1.000                               0.990    0.852
    x5                1.113    0.065   17.014    0.000    1.102    0.855
    x6                0.926    0.055   16.703    0.000    0.917    0.838
  speed =~
    x7                1.000                               0.619    0.570
    x8                1.180    0.165    7.152    0.000    0.731    0.723
    x9                1.082    0.151    7.155    0.000    0.670    0.665

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual ~~
    textual           0.408    0.074    5.552    0.000    0.459    0.459
    speed             0.262    0.056    4.660    0.000    0.471    0.471
  textual ~~
    speed             0.173    0.049    3.518    0.000    0.283    0.283

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .x1                0.549    0.114    4.833    0.000    0.549    0.404
   .x2                1.134    0.102   11.146    0.000    1.134    0.821
   .x3                0.844    0.091    9.317    0.000    0.844    0.662
   .x4                0.371    0.048    7.779    0.000    0.371    0.275
   .x5                0.446    0.058    7.642    0.000    0.446    0.269
   .x6                0.356    0.043    8.277    0.000    0.356    0.298
   .x7                0.799    0.081    9.823    0.000    0.799    0.676
   .x8                0.488    0.074    6.573    0.000    0.488    0.477
   .x9                0.566    0.071    8.003    0.000    0.566    0.558
    visual            0.809    0.145    5.564    0.000    1.000    1.000
    textual           0.979    0.112    8.737    0.000    1.000    1.000
    speed             0.384    0.086    4.451    0.000    1.000    1.000

R-Square:
                   Estimate
    x1                0.596
    x2                0.179
    x3                0.338
    x4                0.725
    x5                0.731
    x6                0.702
    x7                0.324
    x8                0.523
    x9                0.442</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">fitted</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>$cov
      x1    x2    x3    x4    x5    x6    x7    x8    x9
x1 1.358
x2 0.448 1.382
x3 0.590 0.327 1.275
x4 0.408 0.226 0.298 1.351
x5 0.454 0.252 0.331 1.090 1.660
x6 0.378 0.209 0.276 0.907 1.010 1.196
x7 0.262 0.145 0.191 0.173 0.193 0.161 1.183
x8 0.309 0.171 0.226 0.205 0.228 0.190 0.453 1.022
x9 0.284 0.157 0.207 0.188 0.209 0.174 0.415 0.490 1.015</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">coef</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>      visual=~x2       visual=~x3      textual=~x5      textual=~x6
           0.554            0.729            1.113            0.926
       speed=~x8        speed=~x9           x1~~x1           x2~~x2
           1.180            1.082            0.549            1.134
          x3~~x3           x4~~x4           x5~~x5           x6~~x6
           0.844            0.371            0.446            0.356
          x7~~x7           x8~~x8           x9~~x9   visual~~visual
           0.799            0.488            0.566            0.809
textual~~textual     speed~~speed  visual~~textual    visual~~speed
           0.979            0.384            0.408            0.262
  textual~~speed
           0.173 </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">resid</span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"normalized"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>$type
[1] "normalized"

$cov
       x1     x2     x3     x4     x5     x6     x7     x8     x9
x1  0.000
x2 -0.493  0.000
x3 -0.125  1.539  0.000
x4  1.159 -0.214 -1.170  0.000
x5 -0.153 -0.459 -2.606  0.070  0.000
x6  0.983  0.507 -0.436 -0.130  0.048  0.000
x7 -2.423 -3.273 -1.450  0.625 -0.617 -0.240  0.000
x8 -0.655 -0.896 -0.200 -1.162 -0.624 -0.375  1.170  0.000
x9  2.405  1.249  2.420  0.808  1.126  0.958 -0.625 -0.504  0.000</code></pre>
</div>
<p>CAVE! SEMPLOT FEJLER UNDER INSTALLATION PÅ GITHUB! library(semPlot)
semPaths(fit, “std”, layout = “tree”, intercepts = F, residuals = T,
nDigits = 2, label.cex = 1, edge.label.cex=.95, fade = F)</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Use <code>.md</code> files for episodes when you want static
content</li>
<li>Use <code>.Rmd</code> files for episodes when you need to generate
output</li>
<li>Run <code>sandpaper::check_lesson()</code> to identify any issues
with your lesson</li>
<li>Run <code>sandpaper::build_lesson()</code> to preview your lesson
locally</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-structure-you-work"><p>Content from <a href="structure-you-work.html">structure-you-work</a></p>
<hr>
<p>Last updated on 2024-10-07 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/structure-you-work.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 12 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do you write a lesson using R Markdown and
<a href="https://carpentries.github.io/sandpaper/" class="external-link">sandpaper</a>?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to use markdown with the new lesson template</li>
<li>Demonstrate how to include pieces of code, figures, and nested
challenge blocks</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Filstruktur.</p>
<p>kommentarer</p>
<p>mappestruktur</p>
<p>særskilte scripts</p>
<p>projekter</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Use <code>.md</code> files for episodes when you want static
content</li>
<li>Use <code>.Rmd</code> files for episodes when you need to generate
output</li>
<li>Run <code>sandpaper::check_lesson()</code> to identify any issues
with your lesson</li>
<li>Run <code>sandpaper::build_lesson()</code> to preview your lesson
locally</li>
</ul>
</div>
</div>
</div></section><section id="aio-fence-test"><p>Content from <a href="fence-test.html">fence-test</a></p>
<hr>
<p>Last updated on 2024-10-07 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/fence-test.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 12 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do you write a lesson using R Markdown and
<a href="https://carpentries.github.io/sandpaper/" class="external-link">sandpaper</a>?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to use markdown with the new lesson template</li>
<li>Demonstrate how to include pieces of code, figures, and nested
challenge blocks</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Fences</p>
<p>glossary?</p>
<p>objectives, questions og keypoints kender vi. challenge og solution
gør vi også.</p>
<div id="dette-er-en-callout-fence" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="dette-er-en-callout-fence" class="callout-inner">
<h3 class="callout-title">dette er en callout fence</h3>
<div class="callout-content">

</div>
</div>
</div>
<div id="dette-er-en-prereq-fence" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<div id="dette-er-en-prereq-fence" class="callout-inner">
<h3 class="callout-title">dette er en prereq fence</h3>
<div class="callout-content">

</div>
</div>
</div>
<div id="dette-er-en-checklist-fence" class="callout checklist">
<div class="callout-square">
<i class="callout-icon" data-feather="check-square"></i>
</div>
<div id="dette-er-en-checklist-fence" class="callout-inner">
<h3 class="callout-title">dette er en checklist fence</h3>
<div class="callout-content">

</div>
</div>
</div>
<div id="accordionHint1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint1" aria-expanded="false" aria-controls="collapseHint1">
  <h4 class="accordion-header" id="headingHint1">
  dette er en hint fence
  </h4>
</button>
<div id="collapseHint1" class="accordion-collapse collapse" data-bs-parent="#accordionHint1" aria-labelledby="headingHint1">
<div class="accordion-body">

</div>
</div>
</div>
</div>
<div id="dette-er-en-discussion-fence" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="dette-er-en-discussion-fence" class="callout-inner">
<h3 class="callout-title">dette er en discussion fence</h3>
<div class="callout-content">

</div>
</div>
</div>
<div id="dette-er-en-testimonial-fence" class="callout testimonial">
<div class="callout-square">
<i class="callout-icon" data-feather="heart"></i>
</div>
<div id="dette-er-en-testimonial-fence" class="callout-inner">
<h3 class="callout-title">dette er en testimonial fence</h3>
<div class="callout-content">

</div>
</div>
</div>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">
  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div>
  dette er en instructor fence
  </h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" data-bs-parent="#accordionInstructor1" aria-labelledby="headingInstructor1">
<div class="accordion-body">

</div>
</div>
</div>
</div>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">
  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div>
  dette er en spoiler fence
  </h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler1" aria-labelledby="headingSpoiler1">
<div class="accordion-body">

</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="fanegruppe-eksempel">Fanegruppe Eksempel<a class="anchor" aria-label="anchor" href="#fanegruppe-eksempel"></a>
</h2>
<hr class="half-width">
<div class="tabs">
<nav><div id="nav-tab-1" class="nav nav-tabs" role="tablist">
<button class="nav-link active" id="nav-tab-1-Windows" name="Windows" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-1-Windows" type="button" role="tab" aria-controls="nav-tabpanel-1-Windows" aria-selected="true">
  <h3 class="tab-header" id="nav-tab-heading-1-Windows">
  Windows
  </h3>
</button>
<button class="nav-link" id="nav-tab-1-Mac" name="Mac" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-1-Mac" type="button" role="tab" aria-controls="nav-tabpanel-1-Mac" aria-selected="false">
  <h3 class="tab-header" id="nav-tab-heading-1-Mac">
  Mac
  </h3>
</button>
<button class="nav-link" id="nav-tab-1-Linux" name="Linux" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-1-Linux" type="button" role="tab" aria-controls="nav-tabpanel-1-Linux" aria-selected="false">
  <h3 class="tab-header" id="nav-tab-heading-1-Linux">
  Linux
  </h3>
</button>
</div>
</nav><div id="nav-tabContent-1" class="tab-content">
<div id="nav-tabpanel-1-Windows" class="tab-pane show active" role="tabpanel" aria-labelledby="nav-tab-1-Windows">
<p>1</p>
</div>
<div id="nav-tabpanel-1-Mac" class="tab-pane" role="tabpanel" aria-labelledby="nav-tab-1-Mac">
<p>2</p>
</div>
<div id="nav-tabpanel-1-Linux" class="tab-pane" role="tabpanel" aria-labelledby="nav-tab-1-Linux">
<p>3</p>
</div>
</div>
</div>
<div class="tabs">
<nav><div id="nav-tab-2" class="nav nav-tabs" role="tablist">
<button class="nav-link active" id="nav-tab-2-Windows" name="Windows" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-2-Windows" type="button" role="tab" aria-controls="nav-tabpanel-2-Windows" aria-selected="true">
  <h3 class="tab-header" id="nav-tab-heading-2-Windows">
  Windows
  </h3>
</button>
<button class="nav-link" id="nav-tab-2-Mac" name="Mac" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-2-Mac" type="button" role="tab" aria-controls="nav-tabpanel-2-Mac" aria-selected="false">
  <h3 class="tab-header" id="nav-tab-heading-2-Mac">
  Mac
  </h3>
</button>
<button class="nav-link" id="nav-tab-2-Linux" name="Linux" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-2-Linux" type="button" role="tab" aria-controls="nav-tabpanel-2-Linux" aria-selected="false">
  <h3 class="tab-header" id="nav-tab-heading-2-Linux">
  Linux
  </h3>
</button>
<button class="nav-link" id="nav-tab-2-raspbian" name="raspbian" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-2-raspbian" type="button" role="tab" aria-controls="nav-tabpanel-2-raspbian" aria-selected="false">
  <h3 class="tab-header" id="nav-tab-heading-2-raspbian">
  raspbian
  </h3>
</button>
</div>
</nav><div id="nav-tabContent-2" class="tab-content">
<div id="nav-tabpanel-2-Windows" class="tab-pane show active" role="tabpanel" aria-labelledby="nav-tab-2-Windows">
<p>4</p>
</div>
<div id="nav-tabpanel-2-Mac" class="tab-pane" role="tabpanel" aria-labelledby="nav-tab-2-Mac">
<p>5</p>
</div>
<div id="nav-tabpanel-2-Linux" class="tab-pane" role="tabpanel" aria-labelledby="nav-tab-2-Linux">
<p>6</p>
</div>
<div id="nav-tabpanel-2-Windows" class="tab-pane" role="tabpanel" aria-labelledby="nav-tab-2-Windows">
<p>7</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Use <code>.md</code> files for episodes when you want static
content</li>
<li>Use <code>.Rmd</code> files for episodes when you need to generate
output</li>
<li>Run <code>sandpaper::check_lesson()</code> to identify any issues
with your lesson</li>
<li>Run <code>sandpaper::build_lesson()</code> to preview your lesson
locally</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-design-principles"><p>Content from <a href="design-principles.html">design-principles</a></p>
<hr>
<p>Last updated on 2024-10-07 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/design-principles.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 12 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do you write a lesson using R Markdown and
<a href="https://carpentries.github.io/sandpaper/" class="external-link">sandpaper</a>?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to use markdown with the new lesson template</li>
<li>Demonstrate how to include pieces of code, figures, and nested
challenge blocks</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">patchwork</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">palmerpenguins</span><span class="op">)</span></span></code></pre>
</div>
<p>These are our generel recommendations for making graphs. They do not
cover every possible case. Because the number of different cases is
pretty close to infinite.</p>
<p>Nor are they - with a few exceptions - very firm. Once in a very rare
situation a pie chart is actually the best way of visualising data.</p>
<p>One of the gurus in the field of thinking about visual
representations of data is Edward Tufte. He outlines a set of general
principles:</p>
<p>Graphical integrity Visual representations of data must tell the
truth - they must not lie.</p>
<p>He posits 6 principles of graphical integrity.</p>
<section><h2 class="section-heading" id="representation-of-numbers-should-be-directly-proportional-to-the-numerical-quantities-represented">1. Representation of Numbers Should Be Directly Proportional to the
Numerical Quantities Represented<a class="anchor" aria-label="anchor" href="#representation-of-numbers-should-be-directly-proportional-to-the-numerical-quantities-represented"></a>
</h2>
<hr class="half-width">
<p>The size of the elements in a graph (e.g., bars in a bar chart)
should correspond to the actual data values. This prevents misleading
interpretations. Example: A bar chart where the height of each bar
accurately reflects the corresponding data value.</p>
</section><section><h2 class="section-heading" id="no-gridlines">No gridlines<a class="anchor" aria-label="anchor" href="#no-gridlines"></a>
</h2>
<hr class="half-width">
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">et</span> <span class="op">&lt;-</span> <span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y<span class="op">=</span><span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"With gridlines"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">to</span> <span class="op">&lt;-</span> <span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y<span class="op">=</span><span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Without gridlines"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">et</span> <span class="op">+</span> <span class="va">to</span></span></code></pre>
</div>
<p><img src="../fig/design-principles-rendered-unnamed-chunk-1-1.png" style="display: block; margin: auto;" class="figure">
Do the gridlines add value to the plot? In general the answer is no, and
we have better ways of adding the value they might bring.</p>
<p>Inspireret af Common Consultancy.</p>
<p>ingen gridlines</p>
<p>Datalabesl eller aksemærkater - ikke begge. Vil du vise data eller
tendens?</p>
<p>Datalabels inde i søjlerne støjer mindre end uden for.</p>
<p>Hvis grafen bedst læses fra venstre - så placer y-aksen til
højre.</p>
<p>Brug ikoner og skriftstørrelse aktivt. <a href="https://x.com/ValdemarOsted/status/1829409939653001316/photo/4" class="external-link uri">https://x.com/ValdemarOsted/status/1829409939653001316/photo/4</a></p>
<p>Undgå legend ved linegraphs <a href="https://x.com/ValdemarOsted/status/1829409944270987537/photo/1" class="external-link uri">https://x.com/ValdemarOsted/status/1829409944270987537/photo/1</a></p>
<p>Ingen akselinier ved kategoriske variable <a href="https://x.com/ValdemarOsted/status/1829409944270987537/photo/2" class="external-link uri">https://x.com/ValdemarOsted/status/1829409944270987537/photo/2</a></p>
<p>Lagkagediagrammer er farlige, men flotte. Skal de absolut være der -
brug datalabels! <a href="https://x.com/ValdemarOsted/status/1829409944270987537/photo/3" class="external-link uri">https://x.com/ValdemarOsted/status/1829409944270987537/photo/3</a></p>
<p>Fremhæv gerne værdier! <a href="https://x.com/ValdemarOsted/status/1829409944270987537/photo/4" class="external-link uri">https://x.com/ValdemarOsted/status/1829409944270987537/photo/4</a></p>
<p>Placer titlen på grafen i nederste højre hjørne <a href="https://x.com/ValdemarOsted/status/1829409948540772604/photo/1" class="external-link uri">https://x.com/ValdemarOsted/status/1829409948540772604/photo/1</a>
Her er vi ikke helt enige…</p>
<p>Lange navne eller mange søgler - vandret søjlediagram</p>
<p>ALDRIG dobbelte y-eller x-akser. <a href="https://x.com/ValdemarOsted/status/1829409948540772604/photo/3" class="external-link uri">https://x.com/ValdemarOsted/status/1829409948540772604/photo/3</a>
Og slet ikke hvis enhederne er forskellige.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">palmerpenguins</span><span class="op">)</span></span>
<span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">filter</span><span class="op">(</span><span class="va">species</span> <span class="op">==</span> <span class="st">"Adelie"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">body_mass_g</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">bill_depth_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">flipper_length_mm</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">scale_y_continuous</span><span class="op">(</span>sec.axis <span class="op">=</span> <span class="fu">sec_axis</span><span class="op">(</span><span class="op">~</span><span class="va">.</span><span class="op">*</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">theme_ipsum</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in theme_ipsum(): could not find function "theme_ipsum"</code></pre>
</div>
</section><section><h2 class="section-heading" id="d-pie-charts">3D pie charts<a class="anchor" aria-label="anchor" href="#d-pie-charts"></a>
</h2>
<hr class="half-width">
<p>There are only two situations where you should make a 3D pie
chart.</p>
<ol style="list-style-type: decimal">
<li>If you want to misrepresent the data.</li>
<li>If you want to illustrate why 3D pie charts should never be
made.</li>
</ol>
<figure><img src="../fig/design-principles-rendered-unnamed-chunk-3-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The values behind the four slices are: A: 20, B: 40, C: 30 and D:
15.</p>
<p>Or: Slice B represents a value twice as large as slice A. Slice C
represents a value twice as large as slice D. This is not a all obvious
from the plot. The perspective forced on the plot in order to give the
3D illusion, distorts the area of the slices.</p>
</section><section><h2 class="section-heading" id="the-axes-should-always-start-at-0">The axes should always start at 0<a class="anchor" aria-label="anchor" href="#the-axes-should-always-start-at-0"></a>
</h2>
<hr class="half-width">
<p>Except when they shouldn’t.</p>
<p>Langt, langt de fleste gange skal aksen starte med 0. Men ikke hvis
aksen ikke har et naturligt 0 punkt. Den klassiske om gennemsnitlig
højde af kvinder. Tidsserier er også en undtagelse.</p>
<p><a href="https://thedoublethink.com/tuftes-principles-for-visualizing-quantitative-information/" class="external-link uri">https://thedoublethink.com/tuftes-principles-for-visualizing-quantitative-information/</a></p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Use <code>.md</code> files for episodes when you want static
content</li>
<li>Use <code>.Rmd</code> files for episodes when you need to generate
output</li>
<li>Run <code>sandpaper::check_lesson()</code> to identify any issues
with your lesson</li>
<li>Run <code>sandpaper::build_lesson()</code> to preview your lesson
locally</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/README.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/KUBDatalab/R-toolbox/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/KUBDatalab/R-toolbox/" class="external-link">Source</a></p>
				<p><a href="https://github.com/KUBDatalab/R-toolbox/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:kubdatalab@kb.dk">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.7" class="external-link">sandpaper (0.16.7)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.6" class="external-link">pegboard (0.7.6)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.4" class="external-link">varnish (1.0.4)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://KUBDatalab.github.io/R-toolbox/instructor/aio.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://KUBDatalab.github.io/R-toolbox/instructor/aio.html",
  "identifier": "https://KUBDatalab.github.io/R-toolbox/instructor/aio.html",
  "dateCreated": "2024-04-09",
  "dateModified": "2024-10-07",
  "datePublished": "2024-10-07"
}

  </script><script>
		feather.replace();
	</script>
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->


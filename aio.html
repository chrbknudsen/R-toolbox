<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>R-toolbox: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="assets/styles.css">
<script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="manifest" href="site.webmanifest">
<link rel="mask-icon" href="safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="white">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="black">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md top-nav library"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="lc-logo" alt="Library Carpentry" src="assets/images/library-logo.svg"><span class="badge text-bg-danger">
          <abbr title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.">
            <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#early-development-pre-alpha-through-alpha" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
              Pre-Alpha
            </a>
            <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
<li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul>
</li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/aio.html';">Instructor View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav library" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Library Carpentry" src="assets/images/library-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      R-toolbox
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            R-toolbox
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<li><a class="dropdown-item" href="CLT-dk.html">CLT - på dansk</a></li>
<li><a class="dropdown-item" href="CLT-en.html">CLT - på dansk</a></li>
<li><a class="dropdown-item" href="data.html">Data sets</a></li>
<li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul>
</li>
      </ul>
</div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  R-toolbox
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress library">
    <div class="progress-bar library" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text">
<li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul>
</li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/aio.html">Instructor View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->

            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="introduction.html">1. Introduction</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="reproducible-analysis.html">2. Reproducible Data Analysis</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="reading-files.html">3. Reading data from file</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="descript-stat.html">4. Descriptive Statistics</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="table1.html">5. Table One</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="tidy-data.html">6. Tidy Data</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="normal-distribution.html">7. The normal distribution</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="is-it-normal.html">8. Testing for normality</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="which-distribution.html">9. How is the data distributed?</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush11">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading11">
        <a href="regression.html">10. Linear regression</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush12">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading12">
        <a href="clt.html">11. Central Limit Theorem</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush13">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading13">
        <a href="barcharts.html">12. Nicer barcharts</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush14">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading14">
        <a href="powerberegninger.html">13. powerberegninger</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="CLT-dk.html">CLT - på dansk</a></li>
<li><a href="CLT-en.html">CLT - på dansk</a></li>
<li><a href="data.html">Data sets</a></li>
<li><a href="reference.html">Reference</a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width resources">
<a href="aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">

            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-introduction"><p>Content from <a href="introduction.html">Introduction</a></p>
<hr>
<p>Last updated on 2024-07-30 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/introduction.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do you write a lesson using R Markdown and
<a href="https://carpentries.github.io/sandpaper/" class="external-link">sandpaper</a>?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to use markdown with the new lesson template</li>
<li>Demonstrate how to include pieces of code, figures, and nested
challenge blocks</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use <code>.md</code> files for episodes when you want static
content</li>
<li>Use <code>.Rmd</code> files for episodes when you need to generate
output</li>
<li>Run <code>sandpaper::check_lesson()</code> to identify any issues
with your lesson</li>
<li>Run <code>sandpaper::build_lesson()</code> to preview your lesson
locally</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-reproducible-analysis"><p>Content from <a href="reproducible-analysis.html">Reproducible Data Analysis</a></p>
<hr>
<p>Last updated on 2024-07-30 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/reproducible-analysis.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I ensure that my results can be reproduced?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to use markdown with the new lesson template</li>
<li>Demonstrate how to include pieces of code, figures, and nested
challenge blocks</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>A key concept in the scientific process is reproducibility. We should
be able to run the same experiment again, and get, more or less, the
same result.</p>

<p>This also applies to the analysis of data. If we have a collection of
measurements of blood pressure from patients before and after they have
taken an antihypertensive drug, we might arrive at the result that this
specific drug is not working. Doing the same analysis tomorrow, we
should reach the same result.</p>
<p>And that can be surprisingly difficult!</p>
<p>There are a lot of pitfalls, ranging from accessibility to incentive
structures in academia. But the two areas where R can help us are:</p>
<ul>
<li>Software Environment</li>
<li>Documentation and Metadata</li>
<li>Complex Workflows</li>
</ul></section><section><h2 class="section-heading" id="software-environment">Software Environment<a class="anchor" aria-label="anchor" href="#software-environment"></a>
<a class="anchor" aria-label="anchor" href="#software-environment"></a>
</h2>
<hr class="half-width">
<p>Data analysis is done using specific software, libraries or packages,
in a variety of versions. And it happens in an environment on the
computer that might not be identical from day to day.</p>
<p>One example of these problems is shown every time we load tidyverse:
<img src="fig/tidyverse_conflicts.png" alt="Tidyverse conflicts" class="figure"></p>
<p>This message informs us that there is a <code>filter()</code>
function in the <code>stats</code> packages which is part of the core
R-installation. That function is masked by the <code>filter()</code>
function from the <code>tidyverse´ package</code>dplyr`.</p>
<p>If our analysis relies on the way the <code>filter()</code> function
works in the <code>tidyverse</code>, we will get errors if
<code>tidyverse</code> is not loaded.</p>
<p>We might also have data stored in memory. Every time we close
RStudio, we are asked if we want to save the environment:</p>
<figure><img src="fig/save_environment.png" alt="Should we save the environment? No!" class="figure mx-auto d-block"><div class="figcaption">Should we save the environment? No!</div>
</figure><p>This will save all the objects we have in our environment, in order
for RStudio to be able to load them into memory when we open RStudio
again.</p>
<p>That can be nice and useful. On the other hand we run the risk of
having the wrong version of the
<code>my_data_that_is_ready_for_analysis</code> dataframe lying around
in memory.</p>
<p>In addition we can experience performance problems. Storing a lot of
large objects before closing RStudio can take a lot of time. And loading
them into memory when opening RStudio will also take a lot of time.</p>
<p>On modern computers we normally have plenty of storage - but it is
entirely possible to fill your harddrive with R-environments to the
point where your computer crashes.</p>
</section><section><h2 class="section-heading" id="documentation-and-metadata">Documentation and Metadata:<a class="anchor" aria-label="anchor" href="#documentation-and-metadata"></a>
<a class="anchor" aria-label="anchor" href="#documentation-and-metadata"></a>
</h2>
<hr class="half-width">
<p>What did we actually do in the analysis? Why did we do it? Why are we
coming to the conclusion we have got to?</p>
<p>Three very good questions. Having good metadata, data that describes
your data, often makes understanding your data easier. Documenting the
individual steps of your analysis, may not seem necessary right now -
you know why you are doing what you are doing. But future you - you in
three months, or some one else, might not remember or be able to guess
(correctly).</p>
</section><section><h2 class="section-heading" id="complex-workflows">Complex Workflows<a class="anchor" aria-label="anchor" href="#complex-workflows"></a>
<a class="anchor" aria-label="anchor" href="#complex-workflows"></a>
</h2>
<hr class="half-width">
<p>Doing data analysis in eg Excel, can involve a lot of pointing and
clicking.</p>
<p>And in any piece of software, the analysis will normally always
involve more than one step. Those steps will have to be done in the
correct order. Calculating a mean of some values, depends heavily on
whether it happens before or after deleting irrelevant observations.</p>
</section><section><h2 class="section-heading" id="the-solution-to-all-of-this">The solution to all of this!<a class="anchor" aria-label="anchor" href="#the-solution-to-all-of-this"></a>
<a class="anchor" aria-label="anchor" href="#the-solution-to-all-of-this"></a>
</h2>
<hr class="half-width">
<p><img src="fig/horstmarkdown.png" alt="The Rmarkdown family" class="figure">{“Artwork by <a href="https://twitter.com/allison_horst" class="external-link"><span class="citation">@allison_horst</span></a>, CC-BY”}</p>
<p>Working in RMarkdown allows us to collect the text describing our
data, what and why we are doing what we do, the code actually doing it,
and the results of that code - all in one document.</p>
<p>Open a new file, choose RMarkdown, and give your document a name:</p>
<figure><img src="fig/rmarkdown.png" alt="An RMarkdown document" class="figure mx-auto d-block"><div class="figcaption">An RMarkdown document</div>
</figure><p>In the code chunks, marked here with a light grey background,
contains code, in this case not very advanced code. You can run the
entire code chunk by clicking the green arrow on the right. Or by
placing your cursor in the line of code you want to run, and pressing
ctrl+enter (or command+enter on a Mac).</p>
<p>Outside the code chunks we can add our reasons for actually running
<code>summary</code> on the <code>cars</code> dataframe, and describe
what it contains.</p>
<p>You will see a new button in RStudio: <img src="fig/knitr_button.png" alt="The Knit button" class="figure"></p>
<p>Clicking this, will “knit” your document; run each chunck of code,
add the output to your document, and combine your code, the results and
all your explanatory text to one html-document.</p>
<p>If you do not want an HTMl-document, you can knit to a MicroSoft Word
document. Depending on your computer, you can knit directly to a
pdf.</p>
<p>Having the entirety of your analysis in an RMarkdown document, and
then running it, ensures that the individual steps in the analysis are
run in the correct order.</p>
<p>It does not ensure that your documentation of what you do is written
- it makes it easy to add it, but you still have to do it.</p>
<div class="section level3">
<h3 id="but-what-about-the-environment">But what about the environment?<a class="anchor" aria-label="anchor" href="#but-what-about-the-environment"></a>
</h3>
<p>So we force ourself to have the steps in our analysis in the correct
order, and we make it easy to add documentation. What about the
environment?</p>
<p>Working with RMarkdown also adresses this problem. Every time we
<code>knit</code> our document, RStudio opens a new session of R,
without libraries or objects in memory. This ensures that the analysis
is done in the exact same way each and every time.</p>
<p>This, on the other hand, requires us to add code chunks loading
libraries and data to our document.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use RMarkdown to enforce reproducible analysis</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section><section id="aio-reading-files"><p>Content from <a href="reading-files.html">Reading data from file</a></p>
<hr>
<p>Last updated on 2024-07-30 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/reading-files.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do you read in data from files??</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to read in data from a selection of different data
files.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>The first step of doing dataanalysis, is normally to read in the
data.</p>
<p>Data can come from many different sources, and it is practically
impossible to cover every possible format. Here we cover some of the
more common.</p>

<figure><img src="fig/manyfiles.webp" class="figure mx-auto d-block"></figure></section><section><h2 class="section-heading" id="use-code">Use code!<a class="anchor" aria-label="anchor" href="#use-code"></a>
<a class="anchor" aria-label="anchor" href="#use-code"></a>
</h2>
<hr class="half-width">
<p>RStudio makes it simple to load most common data formats. Right-click
on the file in RStudio, and choose import. RStudio will then provide an
interface for loading the data.</p>
<figure><img src="fig/data_import.png" class="figure mx-auto d-block"></figure><p>However in general we prefer to have a script or a document, that can
be run without us pointing and clicking. So - instead of importing the
data in this way, copy the code that RStudio uses to import the data,
and paste it into your script or document.</p>
</section><section><h2 class="section-heading" id="csv-files">CSV-files<a class="anchor" aria-label="anchor" href="#csv-files"></a>
<a class="anchor" aria-label="anchor" href="#csv-files"></a>
</h2>
<hr class="half-width">
<p>The most basic file type for storing and transferring data. A
“simple” textfile, containing tabular data. One line of text for each
row of data, each cell in that row, corresponding to a column, separated
with a separator, typically a comma.</p>
<p>Many languages use commas as decimal separators. That neccesitates an
option for using something else than a comma. Typically a semicolon.</p>
<div class="section level3">
<h3 id="truly-commaseparated-files">Truly commaseparated files<a class="anchor" aria-label="anchor" href="#truly-commaseparated-files"></a>
</h3>
<p>Use <code>read.csv()</code> (from base-R) or <code>read_csv()</code>
(from <code>readr</code>, included in <code>tidyverse</code>)</p>
<p>We recommend using <code>read_csv()</code>.</p>
</div>
<div class="section level3">
<h3 id="semicolon-separated-files">Semicolon separated files<a class="anchor" aria-label="anchor" href="#semicolon-separated-files"></a>
</h3>
<p>Use <code>read.csv2()</code> (from base-R) or
<code>read_csv2()</code> (from <code>readr</code>, included in
<code>tidyverse</code>)</p>
<p>We recommend <code>read_csv2()</code></p>
</div>
<div class="section level3">
<h3 id="what-they-have-in-common">What they have in common<a class="anchor" aria-label="anchor" href="#what-they-have-in-common"></a>
</h3>
<p><code>read_csv</code> and <code>read_csv2</code> take a lot of
arguments that can control datatypes, handling of headers etc. For most
use, the default options are enough, but if you need to adjust
something, there are plenty of options for that.</p>
<p>An especially useful argument is <code>guess_max</code></p>
<p><code>read_csv</code> and <code>read_csv2</code> tries to guess the
datatypes in the file, and will convert the data accordingly. That will
return a dataframe where date-time data is stored as such. The functions
by default reads the first 1000 rows, and makes a guess on the datatype
based on that.</p>
<p>That can lead to problems if the first 1000 rows of a column contain
numbers, and row 1001 contains text. In that case the entire row will be
coerced to <code>numeric</code>, and the following rows will contain
<code>NA</code> values. Adjust the argument <code>guess_max</code> to
something larger to catch this problem.</p>
<p>To include every row in the guess, add <code>guess_max = Inf</code> -
but be carefull if you have a very large dataset.</p>
</div>
</section><section><h2 class="section-heading" id="excel-files">Excel-files<a class="anchor" aria-label="anchor" href="#excel-files"></a>
<a class="anchor" aria-label="anchor" href="#excel-files"></a>
</h2>
<hr class="half-width">
<p>Use the <code>readxl</code> package. Excel comes in two variants,
<code>xls</code> and <code>xlsx</code>. <code>read_excel()</code> makes
a qualified quess of the actual type your excel-file is. Should we need
to specify, we can use <code>read_xls()</code> or
<code>read_xlsx()</code>.</p>
<p>Workbooks often contains more than one sheet. We can specify which we
want to read in:</p>
<p><code>read_excel(path = "filename", sheet = 2)</code></p>
<p>Which will read in sheet number 2 from the workbook “filename”.</p>
<p>Read the documentation for details on how to read in specific cells
or ranges.</p>
</section><section><h2 class="section-heading" id="spss">SPSS<a class="anchor" aria-label="anchor" href="#spss"></a>
<a class="anchor" aria-label="anchor" href="#spss"></a>
</h2>
<hr class="half-width">
<p>SPSS, originally “Statistical Package for the Social Sciences”, later
renamed “Statistical Product and Service Solutions” is a proprietary
statistical software suite developed by IBM.</p>
<p>Not surprisingly it is widely used in social science.</p>
<p>The package <code>haven</code> supports reading SPSS (Stata and SAS)
files</p>
<p>Use the package to read in spss files:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">haven</span><span class="op">)</span></span>
<span><span class="fu">read_spss</span><span class="op">(</span><span class="st">"filename"</span><span class="op">)</span></span></code></pre>
</div>
<p>The function returns at tibble.</p>
<p>Note that SPSS uses a variety of different formats.
<code>read_spss()</code> will make a guess of the correct format, but if
problems arise, try using one of the other functions provided in
<code>haven</code></p>
</section><section><h2 class="section-heading" id="stata">Stata<a class="anchor" aria-label="anchor" href="#stata"></a>
<a class="anchor" aria-label="anchor" href="#stata"></a>
</h2>
<hr class="half-width">
<p>Stata is a proprietary statistical software package, used in a
multitude of different fields, primarily biomedicine, epidemiololy,
sociology and economics.</p>
<p>As mentioned above, hte <code>haven</code> package provides functions
for reading Stata files:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">haven</span><span class="op">)</span></span>
<span><span class="fu">read_stata</span><span class="op">(</span><span class="st">"filename"</span><span class="op">)</span></span></code></pre>
</div>
<p>The function returns at tibble.</p>
<p>As with SPSS Stata uses a couple of different fileformats, and
<code>read_stata</code> makes a guess as to which format is used. If
problems arise, <code>haven</code> has more specific functions for
reading specific file formats.</p>
</section><section><h2 class="section-heading" id="sas">SAS<a class="anchor" aria-label="anchor" href="#sas"></a>
<a class="anchor" aria-label="anchor" href="#sas"></a>
</h2>
<hr class="half-width">
<p>SAS is a proprietary statistical software suite developed by SAS
Institute.</p>
<p>As mentioned above the package <code>haven</code> can read
SAS-files:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">haven</span><span class="op">)</span></span>
<span><span class="fu">read_sas</span><span class="op">(</span><span class="st">"filename"</span><span class="op">)</span></span></code></pre>
</div>
<p>The function returns at tibble.</p>
<p>As with SPSS and Stata, SAS uses a couple of different fileformats,
and <code>read_sas</code> tries to guess the correct format.</p>
<p>If problems arise, <code>haven</code> has more specific functions for
reading specific file formats.</p>
</section><section><h2 class="section-heading" id="json">JSON<a class="anchor" aria-label="anchor" href="#json"></a>
<a class="anchor" aria-label="anchor" href="#json"></a>
</h2>
<hr class="half-width">
<p>Not all data come in a nice rectangular format:</p>
<table style="width:97%;" class="table">
<colgroup>
<col width="50%">
<col width="20%">
<col width="22%">
<col width="4%">
</colgroup>
<tbody>
<tr class="odd">
<td rowspan="2">
<h1 id="country">Country</h1>
<p>USA</p>
</td>
<td rowspan="2">
<h1 id="name">Name</h1>
<p>NASA</p>
</td>
<td rowspan="2">
<h1 id="phonenumber">Phonenumber</h1>
<ol start="713" style="list-style-type: decimal">
<li>483-3111</li>
</ol>
</td>
<td></td>
</tr>
<tr class="even">
<td></td>
</tr>
<tr class="odd">
<td></td>
<td>White House</td>
<td>
<ol start="202" style="list-style-type: decimal">
<li>456-1414</li>
</ol>
<p>(202)-456-1111</p>
</td>
<td></td>
</tr>
<tr class="even">
<td>Russia</td>
<td>Kremlin</td>
<td colspan="2">0107-095-295-9051</td>
</tr>
<tr class="odd">
<td>Vatican</td>
<td>The Pope</td>
<td>011-39-6-6982</td>
<td></td>
</tr>
</tbody>
</table>
<p>There are two locations in the US, and one of them have two
phonenumbers. These kinds of structure, where one row contains data with
more than one row (etc), are called nested, and are typically stored or
distributed in the JSON-format.</p>
<p>JSON can be read using <code>fromJSON()</code> from the
<code>jsonlite</code> library.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">jsonlite</span><span class="op">)</span></span>
<span><span class="fu">fromJSON</span><span class="op">(</span><span class="st">"filename"</span><span class="op">)</span></span></code></pre>
</div>
<p>Note that you will end up with nested columns - containing lists -
which you probably will have to handle afterwards.</p>
</section><section><h2 class="section-heading" id="other-formats">Other formats<a class="anchor" aria-label="anchor" href="#other-formats"></a>
<a class="anchor" aria-label="anchor" href="#other-formats"></a>
</h2>
<hr class="half-width">
<p>In general if a piece of software is in widespread enough use that
you encounter the weird file-format it uses, someone will have written a
package for reading it. Google is your friend here!</p>
<p>Also, if you encounter a really weird dataformat, please send us an
example so we can expand our knowledge.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>The <code>readr</code> version of <code>read_csv()</code> is
preferred</li>
<li>Remember that csv is not always actually separated with commas.</li>
<li>The <code>haven</code> package contains functions for reading common
proprietary file formats.</li>
<li>In general a package will exist for reading strange datatypes.
Google is your friend!</li>
<li>Use code to read in your data</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-descript-stat"><p>Content from <a href="descript-stat.html">Descriptive Statistics</a></p>
<hr>
<p>Last updated on 2024-07-30 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/descript-stat.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can we describe a set of data?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Learn about the most common ways of describing a variable</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>Descriptive statistic involves summarising or describing a set of
data. It usually presents quantitative descriptions in a short form, and
helps to simplify large datasaets.</p>
<p>Most descriptive statistical parameters applies to just one variable
in our data, and includes:</p>
<table class="table">
<thead><tr class="header">
<th>Central tendency</th>
<th>Measure of variation</th>
<th>Measure of shape</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Mean</td>
<td>Range</td>
<td>Skewness</td>
</tr>
<tr class="even">
<td>Median</td>
<td>Quartiles</td>
<td>Kurtosis</td>
</tr>
<tr class="odd">
<td>mode</td>
<td>Inter Quartile Range</td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>Variance</td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td>Standard deviation</td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>Percentiles</td>
<td></td>
</tr>
</tbody>
</table></section><div class="section level1">
<h1 id="central-tendency">Central tendency<a class="anchor" aria-label="anchor" href="#central-tendency"></a>
</h1>
<p>The easiest way to get summary statistics on data is to use the
<code>summarise</code> function from the <code>tidyverse</code>
package.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span></code></pre>
</div>
<p>In the following we are working with the <code>palmerpenguins</code>
dataset:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">palmerpenguins</span><span class="op">)</span></span></code></pre>
</div>
<p>Specifically the weight of the penguins, stored in the variable
<code>body_mass_g</code>:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span><span class="op">$</span><span class="va">body_mass_g</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  [1] 3750 3800 3250   NA 3450 3650 3625 4675 3475 4250 3300 3700 3200 3800 4400
 [16] 3700 3450 4500 3325 4200 3400 3600 3800 3950 3800 3800 3550 3200 3150 3950
 [31] 3250 3900 3300 3900 3325 4150 3950 3550 3300 4650 3150 3900 3100 4400 3000
 [46] 4600 3425 2975 3450 4150 3500 4300 3450 4050 2900 3700 3550 3800 2850 3750
 [61] 3150 4400 3600 4050 2850 3950 3350 4100 3050 4450 3600 3900 3550 4150 3700
 [76] 4250 3700 3900 3550 4000 3200 4700 3800 4200 3350 3550 3800 3500 3950 3600
 [91] 3550 4300 3400 4450 3300 4300 3700 4350 2900 4100 3725 4725 3075 4250 2925
[106] 3550 3750 3900 3175 4775 3825 4600 3200 4275 3900 4075 2900 3775 3350 3325
[121] 3150 3500 3450 3875 3050 4000 3275 4300 3050 4000 3325 3500 3500 4475 3425
[136] 3900 3175 3975 3400 4250 3400 3475 3050 3725 3000 3650 4250 3475 3450 3750
[151] 3700 4000 4500 5700 4450 5700 5400 4550 4800 5200 4400 5150 4650 5550 4650
[166] 5850 4200 5850 4150 6300 4800 5350 5700 5000 4400 5050 5000 5100 4100 5650
[181] 4600 5550 5250 4700 5050 6050 5150 5400 4950 5250 4350 5350 3950 5700 4300
[196] 4750 5550 4900 4200 5400 5100 5300 4850 5300 4400 5000 4900 5050 4300 5000
[211] 4450 5550 4200 5300 4400 5650 4700 5700 4650 5800 4700 5550 4750 5000 5100
[226] 5200 4700 5800 4600 6000 4750 5950 4625 5450 4725 5350 4750 5600 4600 5300
[241] 4875 5550 4950 5400 4750 5650 4850 5200 4925 4875 4625 5250 4850 5600 4975
[256] 5500 4725 5500 4700 5500 4575 5500 5000 5950 4650 5500 4375 5850 4875 6000
[271] 4925   NA 4850 5750 5200 5400 3500 3900 3650 3525 3725 3950 3250 3750 4150
[286] 3700 3800 3775 3700 4050 3575 4050 3300 3700 3450 4400 3600 3400 2900 3800
[301] 3300 4150 3400 3800 3700 4550 3200 4300 3350 4100 3600 3900 3850 4800 2700
[316] 4500 3950 3650 3550 3500 3675 4450 3400 4300 3250 3675 3325 3950 3600 4050
[331] 3350 3450 3250 4050 3800 3525 3950 3650 3650 4000 3400 3775 4100 3775</code></pre>
</div>
<p>How can we describe these values?</p>
<div class="section level2">
<h2 id="mean">Mean<a class="anchor" aria-label="anchor" href="#mean"></a>
</h2>
<p>The mean is the average of all datapoints. We add all values
(excluding the missing values encoded with <code>NA</code>), and divide
with the number of observations:</p>
<p><span class="math display">\[\overline{x} = \frac{1}{N}\sum_1^N
x_i\]</span> Where N is the number of observations, and <span class="math inline">\(x_i\)</span> is the individual observations in the
sample <span class="math inline">\(x\)</span>.</p>
<p>The easiest way of getting the mean is using the <code>mean()</code>
function:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mean</span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 4201.754</code></pre>
</div>
<p>A slightly more cumbersome way is using the summarise function from
<code>tidyverse</code>:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>avg_mass <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1 × 1
  avg_mass
     &lt;dbl&gt;
1    4202.</code></pre>
</div>
<p>The advantage will be clear below.</p>
<p>Barring significant outliers, <code>mean</code> is an expression of
position of the data. This is the weight we would expect a random
penguin in our dataset to have.</p>
<p>However, we have three different species of penguins in the dataset,
and they have quite different average weights. There is also a
significant difference in the average weight for the two sexes.</p>
<p>We will get to that at the end of this segment.</p>
</div>
<div class="section level2">
<h2 id="median">Median<a class="anchor" aria-label="anchor" href="#median"></a>
</h2>
<p>Similarly to the average/mean, the <code>median</code> is an
expression of the location of the data. If we order our data by size,
from the smallest to the largest value, and locate the middle
observation, we get the median. This is the value that half of the
observations is smaller than. And half the observations is larger.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>median <span class="op">=</span> <span class="fu">median</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1 × 1
  median
   &lt;dbl&gt;
1   4050</code></pre>
</div>
<p>We can note that the mean is larger that the median. This indicates
that the data is skewed, in this case toward the larger penguins.</p>
<p>We can get both <code>median</code> and <code>mean</code> in one
go:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>median <span class="op">=</span> <span class="fu">median</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            mean   <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1 × 2
  median  mean
   &lt;dbl&gt; &lt;dbl&gt;
1   4050 4202.</code></pre>
</div>

</div>
<div class="section level2">
<h2 id="mode">Mode<a class="anchor" aria-label="anchor" href="#mode"></a>
</h2>
<p>Mode is the most common, or frequently occurring, observation. R does
not have a build-in function for this, but we can easily find the mode
by counting the different observations,and locating the most common
one.</p>
<p>We typically do not use this for continous variables. The mode of the
<code>sex</code> variable in this dataset can be found like this:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">sex</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 3 × 2
  sex        n
  &lt;fct&gt;  &lt;int&gt;
1 male     168
2 female   165
3 &lt;NA&gt;      11</code></pre>
</div>
<p>We count the different values in the <code>sex</code> variable, and
arrange the counts in descending order (<code>desc</code>). The mode of
the <code>sex</code> variable is male.</p>
<p>In this specific case, we note that the dataset is pretty evenly
balanced regarding the two sexes.</p>
</div>
</div>
<div class="section level1">
<h1 id="measures-of-variance">Measures of variance<a class="anchor" aria-label="anchor" href="#measures-of-variance"></a>
</h1>
<p>Knowing where the observations are located is interesting. But how do
they vary? How can we describe the variation in the data?</p>
<div class="section level2">
<h2 id="range">Range<a class="anchor" aria-label="anchor" href="#range"></a>
</h2>
<p>The simplest information about the variation is the range. What is
the smallest and what is the largest value? The <code>range()</code>
function can find it.</p>
<p>Since this returns more than one value, we use the function reframe
instead of summarise:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">reframe</span><span class="op">(</span>range <span class="op">=</span> <span class="fu">range</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 2 × 1
  range
  &lt;int&gt;
1  2700
2  6300</code></pre>
</div>
<p>However it is typically more usefull to extract the two values to
separate columns in the output:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>min <span class="op">=</span> <span class="fu">min</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            max <span class="op">=</span> <span class="fu">max</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1 × 2
    min   max
  &lt;int&gt; &lt;int&gt;
1  2700  6300</code></pre>
</div>
<p>The range informs us of the spread of the observations.</p>
</div>
<div class="section level2">
<h2 id="variance">Variance<a class="anchor" aria-label="anchor" href="#variance"></a>
</h2>
<p>The observations varies. They are no all located at the mean (or
median), but are spread out on both sides of the mean. Can we get a
numerical value describing that?</p>
<p>An obvious way would be to calculate the difference between each of
the observations and the mean, and then take the average of those
differences.</p>
<p>That will give us the average deviation. But we have a problem. The
average weight of penguins was 4202 (rounded). Look at two penguins, one
weighing 5000, and another weighing 3425. The differences are:</p>
<ul>
<li>5000 - 4202 = 798</li>
<li>3425 - 4202 = -777</li>
</ul>
<p>The sum of those two differences is: -777 + 798 = 21 g. And the
average is then 10.5 gram. That is <em>not</em> a good estimate of a
variation from the mean of more than 700 gram.</p>
<p>The problem is, that the differences can be both positive and
negative, and might cancel each other out.</p>
<p>We solve that problem by squaring the differences, and calculate the
mean of those.</p>

<p>The mathematical notation would be:</p>
<p><span class="math display">\[
\sigma^2 = \frac{\sum_{i=1}^N(x_i - \mu)^2}{N}
\]</span></p>
<p>Why are we suddenly using <span class="math inline">\(\mu\)</span>
instead of <span class="math inline">\(\overline{x}\)</span>? Because
this definition uses the population mean. The mean, or average, in the
entire population of all penguins everywhere in the universe. But we
have not weighed all those penguins.</p>
<p>Instead we will normally look at the sample variance:</p>
<p><span class="math display">\[
s^2 = \frac{\sum_{i=1}^N(x_i - \overline{x})^2}{N-1}
\]</span></p>
<p>Note that we also change the <span class="math inline">\(\sigma\)</span> to an <span class="math inline">\(s\)</span>.</p>
<p>And again we are not going to do that by hand, but will ask R to do
it for us:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>            variance <span class="op">=</span> <span class="fu">var</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>          <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1 × 1
  variance
     &lt;dbl&gt;
1  643131.</code></pre>
</div>

</div>
<div class="section level2">
<h2 id="standard-deviation">Standard deviation<a class="anchor" aria-label="anchor" href="#standard-deviation"></a>
</h2>
<p>There is a problem with the variance. It is 643131, completely off
scale from the actual values. There is also a problem with the unit
which is in <span class="math inline">\(g^2\)</span>.</p>
<p>A measurement of the variation of the data would be the standard
deviation, simply defined as the square root of the variance:</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>            s <span class="op">=</span> <span class="fu">sd</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>          <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1 × 1
      s
  &lt;dbl&gt;
1  802.</code></pre>
</div>
<p>Since the standard deviation occurs in several statistical tests, it
is more frequently used that the variance. It is also more intuitively
relateable to the mean.</p>
</div>
<div class="section level2">
<h2 id="a-histogram">A histogram<a class="anchor" aria-label="anchor" href="#a-histogram"></a>
</h2>
<p>A visual illustration of the data can be nice. Often one of the first
we make, is a histogram.</p>
<p>A histogram is a plot or graph where we split the range of
observations in a number of “buckets”, and count the number of
observations in each bucket:</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">body_mass_g</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="op">!</span><span class="fu">is.na</span><span class="op">(</span><span class="va">body_mass_g</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>buckets <span class="op">=</span> <span class="fu">cut</span><span class="op">(</span><span class="va">body_mass_g</span>, breaks<span class="op">=</span><span class="fu">seq</span><span class="op">(</span><span class="fl">2500</span>,<span class="fl">6500</span>,<span class="fl">500</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">group_by</span><span class="op">(</span><span class="va">buckets</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">summarise</span><span class="op">(</span>antal <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 8 × 2
  buckets         antal
  &lt;fct&gt;           &lt;int&gt;
1 (2.5e+03,3e+03]    11
2 (3e+03,3.5e+03]    67
3 (3.5e+03,4e+03]    92
4 (4e+03,4.5e+03]    57
5 (4.5e+03,5e+03]    54
6 (5e+03,5.5e+03]    33
7 (5.5e+03,6e+03]    26
8 (6e+03,6.5e+03]     2</code></pre>
</div>
<p>Typically, rather that counting ourself, we leave the work to R, and
make a histogram directly:</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">body_mass_g</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">geom_histogram</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<figure><img src="fig/descript-stat-rendered-unnamed-chunk-14-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>By default ggplot chooses 30 bins, typically we should chose a
different number:</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">body_mass_g</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">geom_histogram</span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<figure><img src="fig/descript-stat-rendered-unnamed-chunk-15-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Or, ideally, set the widths of them, manually:</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">body_mass_g</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">geom_histogram</span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">250</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Histogram with binwidth = 250 g"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<p><img src="fig/descript-stat-rendered-unnamed-chunk-16-1.png" style="display: block; margin: auto;" class="figure">
Or even specify the exact intervals we want, here intervals from 0 to
6500 gram in intervals of 250 gram:</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">body_mass_g</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">geom_histogram</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">seq</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">6500</span>,<span class="fl">250</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Histogram with bins in 250 g steps from 0 to 6500 g"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<p><img src="fig/descript-stat-rendered-unnamed-chunk-17-1.png" style="display: block; margin: auto;" class="figure">
The histogram provides us with a visual indication of both range, the
variation of the values, and an idea about where the data is
located.</p>
</div>
<div class="section level2">
<h2 id="quartiles">Quartiles<a class="anchor" aria-label="anchor" href="#quartiles"></a>
</h2>
<p>The median can be understood as splitting the data in two equally
sized parts, where one is characterized by having values smaller than
the median and the other as having values larger than the median. It is
the value where 50% of the observations are smaller.</p>
<p>Similary we can calculate the value where 25% of the observations are
smaller.</p>
<p>That is often called the first quartile, where the median is the 50%,
or second quartile. Quartile implies four parts, and the existence of a
third or 75% quartile.</p>
<p>We can calcultate those using the quantile function:</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">quantile</span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">body_mass_g</span>, probs <span class="op">=</span> <span class="fl">.25</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> 25%
3550 </code></pre>
</div>
<p>and</p>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">quantile</span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">body_mass_g</span>, probs <span class="op">=</span> <span class="fl">.75</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> 75%
4750 </code></pre>
</div>

<p>We are often interested in knowing the range in which 50% of the
observations fall.</p>
<p>That is used often enough that we have a dedicated function for
it:</p>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>iqr <span class="op">=</span> <span class="fu">IQR</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1 × 1
    iqr
  &lt;dbl&gt;
1  1200</code></pre>
</div>
<p>The name of the quantile function implies that we might have other
quantiles than quartiles. Actually we can calculate any quantile, eg the
2.5% quantile:</p>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">quantile</span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">body_mass_g</span>, probs <span class="op">=</span> <span class="fl">.025</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>    2.5%
2988.125 </code></pre>
</div>
<p>The individual quantiles can be interesting in themselves. If we want
a visual representation of <em>all</em> quantiles, we can calculate all
of them, and plot them.</p>
<p>Instead of doing that by hand, we can use a concept called
<em>CDF</em> or cumulative density function:</p>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CDF</span> <span class="op">&lt;-</span> <span class="fu">ecdf</span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">body_mass_g</span><span class="op">)</span></span>
<span><span class="va">CDF</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Empirical CDF
Call: ecdf(penguins$body_mass_g)
 x[1:94] =   2700,   2850,   2900,  ...,   6050,   6300</code></pre>
</div>
<p>That was not very informative. Lets plot it:</p>
<p>[NOT QUITE DONE!]</p>
<div class="codewrapper sourceCode" id="cb44">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">quantiler</span> <span class="op">&lt;-</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">body_mass_g</span>, probs <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.75</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">penguins</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">body_mass_g</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">stat_ecdf</span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"step"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.25</span>,<span class="fl">0.5</span>,<span class="fl">0.75</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">quantiler</span><span class="op">)</span></span></code></pre>
</div>
<p><img src="fig/descript-stat-rendered-unnamed-chunk-23-1.png" style="display: block; margin: auto;" class="figure">
den skal vi nok have beskrevet lidt mere.</p>
<p>Men pointen er, at vi for enhver værdi kan aflæse ting. Hvor stor en
andel af pingvinerne vejer mindre end 3000 g? Vi kan finde 3000 på
x-aksen, og aflæse den matchende værdi på y-aksen.</p>
<p>Det svarer også til - hvis vi tager en tilfældig pingvin, hvad er så
sandsynligheden for at den vejer mindre end 3000 gram? Eller for at den
vejer mere end 5000 gram?</p>
</div>
<div class="section level2">
<h2 id="measures-of-shape">Measures of shape<a class="anchor" aria-label="anchor" href="#measures-of-shape"></a>
</h2>
</div>
<div class="section level2">
<h2 id="skewness">Skewness<a class="anchor" aria-label="anchor" href="#skewness"></a>
</h2>
<p>Vi bliver nok nødt til at lave et histogram…</p>
<p>We previously saw a histogram of the data, and noted that the
observations were skewed to the left, and that the “tail” on the right
was longer than on the left. That skewness can be quantised.</p>
<p>There is no function for skewness build into R, but we can get it
from the library <code>e1071</code></p>
<div class="codewrapper sourceCode" id="cb45">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">e1071</span><span class="op">)</span></span>
<span><span class="fu">skewness</span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.4662117</code></pre>
</div>
<p>The skewness is positive, indicating that the data are skewed to the
left, just as we saw. A negative skewness would indicate that the data
skew to the right.</p>
</div>
<div class="section level2">
<h2 id="kurtosis">Kurtosis<a class="anchor" aria-label="anchor" href="#kurtosis"></a>
</h2>
<p>Og her skal vi nok lige have styr på den intuitive forståelse af
det.</p>
</div>
<div class="section level2">
<h2 id="everything-everywhere-all-at-once">Everything Everywhere All at Once<a class="anchor" aria-label="anchor" href="#everything-everywhere-all-at-once"></a>
</h2>
<p>A lot of these descriptive values can be gotten for every variable in
the dataset using the <code>summary</code> function:</p>
<div class="codewrapper sourceCode" id="cb47">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>      species          island    bill_length_mm  bill_depth_mm
 Adelie   :152   Biscoe   :168   Min.   :32.10   Min.   :13.10
 Chinstrap: 68   Dream    :124   1st Qu.:39.23   1st Qu.:15.60
 Gentoo   :124   Torgersen: 52   Median :44.45   Median :17.30
                                 Mean   :43.92   Mean   :17.15
                                 3rd Qu.:48.50   3rd Qu.:18.70
                                 Max.   :59.60   Max.   :21.50
                                 NA's   :2       NA's   :2
 flipper_length_mm  body_mass_g       sex           year
 Min.   :172.0     Min.   :2700   female:165   Min.   :2007
 1st Qu.:190.0     1st Qu.:3550   male  :168   1st Qu.:2007
 Median :197.0     Median :4050   NA's  : 11   Median :2008
 Mean   :200.9     Mean   :4202                Mean   :2008
 3rd Qu.:213.0     3rd Qu.:4750                3rd Qu.:2009
 Max.   :231.0     Max.   :6300                Max.   :2009
 NA's   :2         NA's   :2                                 </code></pre>
</div>
<p>Here we get the range, the 1st and 3rd quantiles (and from those the
IQR), the median and the mean and, rather useful, the number of missing
values in each variable.</p>
<p>We can also get all the descriptive values in one table, by adding
more than one summarizing function to the summarise function:</p>
<div class="codewrapper sourceCode" id="cb49">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>min <span class="op">=</span> <span class="fu">min</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            max <span class="op">=</span> <span class="fu">max</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            mean <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            median <span class="op">=</span> <span class="fu">median</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            stddev <span class="op">=</span> <span class="fu">sd</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            var <span class="op">=</span> <span class="fu">var</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            Q1 <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">body_mass_g</span>, probs <span class="op">=</span> <span class="fl">.25</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            Q3 <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">body_mass_g</span>, probs <span class="op">=</span> <span class="fl">.75</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            iqr <span class="op">=</span> <span class="fu">IQR</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            skew <span class="op">=</span> <span class="fu">skewness</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            kurtosis <span class="op">=</span> <span class="fu">kurtosis</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1 × 11
    min   max  mean median stddev     var    Q1    Q3   iqr  skew kurtosis
  &lt;int&gt; &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
1  2700  6300 4202.   4050   802. 643131.  3550  4750  1200 0.466   -0.740</code></pre>
</div>
<p>As noted, we have three different species of penguins in the dataset.
Their weight varies a lot. If we want to do the summarising on each for
the species, we can group the data by species, before summarising:</p>
<div class="codewrapper sourceCode" id="cb51">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">species</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>min <span class="op">=</span> <span class="fu">min</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            max <span class="op">=</span> <span class="fu">max</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            mean <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            median <span class="op">=</span> <span class="fu">median</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            stddev <span class="op">=</span> <span class="fu">sd</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 3 × 6
  species     min   max  mean median stddev
  &lt;fct&gt;     &lt;int&gt; &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1 Adelie     2850  4775 3701.   3700   459.
2 Chinstrap  2700  4800 3733.   3700   384.
3 Gentoo     3950  6300 5076.   5000   504.</code></pre>
</div>
<p>We have removed some summary statistics in order to get a smaller
table.</p>
</div>
<div class="section level2">
<h2 id="boxplots">Boxplots<a class="anchor" aria-label="anchor" href="#boxplots"></a>
</h2>
<p>Finally boxplots offers a way of visualising some of the summary
statistics:</p>
<div class="codewrapper sourceCode" id="cb53">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">body_mass_g</span>, y <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<figure><img src="fig/descript-stat-rendered-unnamed-chunk-28-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The boxplot shows us the median (the fat line in the middel of each
box), the 1st and 3rd quartiles (the ends of the boxes), and the range,
with the whiskers at each end of the boxes, illustrating the minimum and
maximum. Any observations, more than 1.5 times the IQR from either the
1st or 3rd quartiles, are deemed as outliers and would be plotted as
individual points in the plot.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Nogen statisktiske pointer om det her</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</div></section><section id="aio-table1"><p>Content from <a href="table1.html">Table One</a></p>
<hr>
<p>Last updated on 2024-07-30 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/table1.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do you make a Table One?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain what a Table One is</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="what-is-a-table-one">What is a “Table One”?<a class="anchor" aria-label="anchor" href="#what-is-a-table-one"></a>
<a class="anchor" aria-label="anchor" href="#what-is-a-table-one"></a>
</h2>
<hr class="half-width">
<p>Primarily used in medical and epidemiological research, a Table One
is typically the first table in any publication using data.</p>
<p>It presents the baseline characteristics of the participants in a
study, and provides a concise overview of the relevant demographic and
clinical variables.</p>
<p>It typically compares different groups (male~female,
treatment~control), to highlight similarities and differences.</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Attaching package: 'table1'</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following objects are masked from 'package:base':

    units, units&lt;-</code></pre>
</div>
It can look like this: <!--html_preserve-->
<div class="Rtable1">
<table class="table Rtable1">
<thead><tr>
<th class="rowlabel firstrow lastrow">
</th>
<th class="firstrow lastrow">
<span class="stratlabel">Treated<br><span class="stratn">(N=20)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">Placebo<br><span class="stratn">(N=20)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">Overall<br><span class="stratn">(N=40)</span></span>
</th>
</tr></thead>
<tbody>
<tr>
<td class="rowlabel firstrow">
Sex
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
</tr>
<tr>
<td class="rowlabel">
Male
</td>
<td>
10 (50.0%)
</td>
<td>
10 (50.0%)
</td>
<td>
20 (50.0%)
</td>
</tr>
<tr>
<td class="rowlabel lastrow">
Female
</td>
<td class="lastrow">
10 (50.0%)
</td>
<td class="lastrow">
10 (50.0%)
</td>
<td class="lastrow">
20 (50.0%)
</td>
</tr>
<tr>
<td class="rowlabel firstrow">
Age (years)
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
</tr>
<tr>
<td class="rowlabel">
Mean (SD)
</td>
<td>
26.6 (10.5)
</td>
<td>
28.0 (12.5)
</td>
<td>
27.3 (11.4)
</td>
</tr>
<tr>
<td class="rowlabel">
Median [Min, Max]
</td>
<td>
24.7 [10.2, 45.0]
</td>
<td>
26.5 [11.7, 48.3]
</td>
<td>
26.3 [10.2, 48.3]
</td>
</tr>
<tr>
<td class="rowlabel lastrow">
Missing
</td>
<td class="lastrow">
1 (5.0%)
</td>
<td class="lastrow">
0 (0%)
</td>
<td class="lastrow">
1 (2.5%)
</td>
</tr>
<tr>
<td class="rowlabel firstrow">
Weight (kg)
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
</tr>
<tr>
<td class="rowlabel">
Mean (SD)
</td>
<td>
72.8 (15.1)
</td>
<td>
73.1 (14.9)
</td>
<td>
73.0 (14.8)
</td>
</tr>
<tr>
<td class="rowlabel lastrow">
Median [Min, Max]
</td>
<td class="lastrow">
71.7 [42.8, 107]
</td>
<td class="lastrow">
70.1 [51.4, 101]
</td>
<td class="lastrow">
70.9 [42.8, 107]
</td>
</tr>
</tbody>
</table>
</div>
<!--/html_preserve-->
<p>We have 40 participants in a study, split into equal control and
treatment groups, and describe the distribution of Sex, Age and Weight
in both the two groups, and overall.</p>
<p>A number of packages making it easy to make a Table One exists. Here
we look at the package <code>table1</code>.</p>
<p>The specific way of doing it depends on the data available. If we do
not have data on the weight of the participants, we are not able to
describe the distribution of their weight.</p>
<p>But the table above was made in this way:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">table1</span><span class="op">)</span></span>
<span><span class="fu">table1</span><span class="op">(</span><span class="op">~</span><span class="va">sex</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">weight</span><span class="op">|</span><span class="va">treatment</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span></code></pre>
</div>
<p>We specify that we would like a table that is a function of
<code>sex</code>, <code>age</code> and <code>wt</code>, and we would
like it split into groups based on the values in the
<code>treatment</code></p>
<p>It might be instructive to take a look at how the data was prepared.
First the data it self:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">expand.grid</span><span class="op">(</span>id<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, sex<span class="op">=</span><span class="fu">c</span><span class="op">(</span><span class="st">"Male"</span>, <span class="st">"Female"</span><span class="op">)</span>, treatment<span class="op">=</span><span class="fu">c</span><span class="op">(</span><span class="st">"Treated"</span>, <span class="st">"Placebo"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dat</span><span class="op">$</span><span class="va">age</span> <span class="op">&lt;-</span> <span class="fu">runif</span><span class="op">(</span><span class="fu">nrow</span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>, <span class="fl">10</span>, <span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">dat</span><span class="op">$</span><span class="va">age</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span>  <span class="co"># Add a missing value</span></span>
<span><span class="va">dat</span><span class="op">$</span><span class="va">weight</span> <span class="op">&lt;-</span> <span class="fu">exp</span><span class="op">(</span><span class="fu">rnorm</span><span class="op">(</span><span class="fu">nrow</span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>, <span class="fu">log</span><span class="op">(</span><span class="fl">70</span><span class="op">)</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>The interesting part occurs here, where we add labels to the data.
That allows us to control the headings in the table:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">label</span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Sex"</span></span>
<span><span class="fu">label</span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">age</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Age"</span></span>
<span><span class="fu">label</span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">treatment</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Treatment Group"</span></span>
<span><span class="fu">label</span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">weight</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Weight"</span></span></code></pre>
</div>
<p>It can be beneficial to add information about units of the data:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">units</span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">age</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"years"</span></span>
<span><span class="fu">units</span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">weight</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"kg"</span></span></code></pre>
</div>
</section><section><h2 class="section-heading" id="more-advanced-stuff">More advanced stuff<a class="anchor" aria-label="anchor" href="#more-advanced-stuff"></a>
<a class="anchor" aria-label="anchor" href="#more-advanced-stuff"></a>
</h2>
<hr class="half-width">
<p>FLYTTES TIL SEPARAT SIDE?</p>
<p>We might want to be able to precisely control the summary statistics
presented in the table.</p>
<p>We can do that by specifying input to the arguments
<code>render.continuous</code> and <code>render.categorical</code> that
control how continuous and categorical data respecetively, is shown in
the table.</p>
<p>The simple way of doing that is by using abbrevieated function
names:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">table1</span><span class="op">(</span><span class="op">~</span><span class="va">sex</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">weight</span><span class="op">|</span><span class="va">treatment</span>, data <span class="op">=</span> <span class="va">dat</span>,</span>
<span>        render.continuous<span class="op">=</span><span class="fu">c</span><span class="op">(</span>.<span class="op">=</span><span class="st">"Mean (SD%)"</span>, .<span class="op">=</span><span class="st">"Median [Min, Max]"</span>,</span>
<span>                           <span class="st">"Geom. mean (Geo. SD%)"</span><span class="op">=</span><span class="st">"GMEAN (GSD%)"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<!--html_preserve-->
<div class="Rtable1">
<table class="table Rtable1">
<thead><tr>
<th class="rowlabel firstrow lastrow">
</th>
<th class="firstrow lastrow">
<span class="stratlabel">Treated<br><span class="stratn">(N=20)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">Placebo<br><span class="stratn">(N=20)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">Overall<br><span class="stratn">(N=40)</span></span>
</th>
</tr></thead>
<tbody>
<tr>
<td class="rowlabel firstrow">
Sex
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
</tr>
<tr>
<td class="rowlabel">
Male
</td>
<td>
10 (50.0%)
</td>
<td>
10 (50.0%)
</td>
<td>
20 (50.0%)
</td>
</tr>
<tr>
<td class="rowlabel lastrow">
Female
</td>
<td class="lastrow">
10 (50.0%)
</td>
<td class="lastrow">
10 (50.0%)
</td>
<td class="lastrow">
20 (50.0%)
</td>
</tr>
<tr>
<td class="rowlabel firstrow">
Age (years)
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
</tr>
<tr>
<td class="rowlabel">
Mean (SD%)
</td>
<td>
26.6 (10.5%)
</td>
<td>
28.0 (12.5%)
</td>
<td>
27.3 (11.4%)
</td>
</tr>
<tr>
<td class="rowlabel">
Median [Min, Max]
</td>
<td>
24.7 [10.2, 45.0]
</td>
<td>
26.5 [11.7, 48.3]
</td>
<td>
26.3 [10.2, 48.3]
</td>
</tr>
<tr>
<td class="rowlabel">
Geom. mean (Geo. SD%)
</td>
<td>
24.4 (1.54%)
</td>
<td>
25.4 (1.60%)
</td>
<td>
24.9 (1.56%)
</td>
</tr>
<tr>
<td class="rowlabel lastrow">
Missing
</td>
<td class="lastrow">
1 (5.0%)
</td>
<td class="lastrow">
0 (0%)
</td>
<td class="lastrow">
1 (2.5%)
</td>
</tr>
<tr>
<td class="rowlabel firstrow">
Weight (kg)
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
</tr>
<tr>
<td class="rowlabel">
Mean (SD%)
</td>
<td>
72.8 (15.1%)
</td>
<td>
73.1 (14.9%)
</td>
<td>
73.0 (14.8%)
</td>
</tr>
<tr>
<td class="rowlabel">
Median [Min, Max]
</td>
<td>
71.7 [42.8, 107]
</td>
<td>
70.1 [51.4, 101]
</td>
<td>
70.9 [42.8, 107]
</td>
</tr>
<tr>
<td class="rowlabel lastrow">
Geom. mean (Geo. SD%)
</td>
<td class="lastrow">
71.3 (1.24%)
</td>
<td class="lastrow">
71.7 (1.22%)
</td>
<td class="lastrow">
71.5 (1.23%)
</td>
</tr>
</tbody>
</table>
</div>
<!--/html_preserve-->
<p><code>table1</code> recognizes the following summary statisticis: N,
NMISS, MEAN, SD, CV, GMEAN, GCV, MEDIAN, MIN, MAX, IQR, Q1, Q2, Q3, T1,
T2, FREQ, PCT</p>
<p>Details can be found in the help to the function
<code>stats.default()</code></p>
<p>Note that they are case-insensitive, and we can write Median or
mediAn instead of median.</p>
<p>Also note that we write <code>.="Mean (SD%)"</code> which will be
recognized as the functions <code>mean()</code> and <code>sd()</code>,
but also that the label shown should be “Mean (SD%)”.</p>
<p>If we want to specify the label, we can write
<code>"Geom. mean (Geo. SD%)"="GMEAN (GSD%)"</code></p>
<p>ØVELSE - ÆNDRE PÅ LABEL ETC.</p>
</section><section><h2 class="section-heading" id="very-advanced-stuff">Very advanced stuff<a class="anchor" aria-label="anchor" href="#very-advanced-stuff"></a>
<a class="anchor" aria-label="anchor" href="#very-advanced-stuff"></a>
</h2>
<hr class="half-width">
<p>If we want to specify the summary statistics very precisely, we have
to define a function ourself:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_summary</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu">c</span><span class="op">(</span><span class="st">""</span>,<span class="st">"Median"</span> <span class="op">=</span> <span class="fu">sprintf</span><span class="op">(</span><span class="st">"%.3f"</span>, <span class="fu">median</span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,</span>
<span><span class="st">"Variance"</span> <span class="op">=</span> <span class="fu">sprintf</span><span class="op">(</span><span class="st">"%.1f"</span>, <span class="fu">var</span><span class="op">(</span><span class="va">x</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">table1</span><span class="op">(</span><span class="op">~</span><span class="va">sex</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">weight</span><span class="op">|</span><span class="va">treatment</span>, data <span class="op">=</span> <span class="va">dat</span>,</span>
<span>render.continuous <span class="op">=</span> <span class="va">my_summary</span><span class="op">)</span></span></code></pre>
</div>
<!--html_preserve-->
<div class="Rtable1">
<table class="table Rtable1">
<thead><tr>
<th class="rowlabel firstrow lastrow">
</th>
<th class="firstrow lastrow">
<span class="stratlabel">Treated<br><span class="stratn">(N=20)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">Placebo<br><span class="stratn">(N=20)</span></span>
</th>
<th class="firstrow lastrow">
<span class="stratlabel">Overall<br><span class="stratn">(N=40)</span></span>
</th>
</tr></thead>
<tbody>
<tr>
<td class="rowlabel firstrow">
Sex
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
</tr>
<tr>
<td class="rowlabel">
Male
</td>
<td>
10 (50.0%)
</td>
<td>
10 (50.0%)
</td>
<td>
20 (50.0%)
</td>
</tr>
<tr>
<td class="rowlabel lastrow">
Female
</td>
<td class="lastrow">
10 (50.0%)
</td>
<td class="lastrow">
10 (50.0%)
</td>
<td class="lastrow">
20 (50.0%)
</td>
</tr>
<tr>
<td class="rowlabel firstrow">
Age (years)
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
</tr>
<tr>
<td class="rowlabel">
Median
</td>
<td>
24.731
</td>
<td>
26.474
</td>
<td>
26.289
</td>
</tr>
<tr>
<td class="rowlabel">
Variance
</td>
<td>
109.3
</td>
<td>
156.3
</td>
<td>
130.5
</td>
</tr>
<tr>
<td class="rowlabel lastrow">
Missing
</td>
<td class="lastrow">
1 (5.0%)
</td>
<td class="lastrow">
0 (0%)
</td>
<td class="lastrow">
1 (2.5%)
</td>
</tr>
<tr>
<td class="rowlabel firstrow">
Weight (kg)
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
<td class="firstrow">
</td>
</tr>
<tr>
<td class="rowlabel">
Median
</td>
<td>
71.678
</td>
<td>
70.059
</td>
<td>
70.894
</td>
</tr>
<tr>
<td class="rowlabel lastrow">
Variance
</td>
<td class="lastrow">
229.4
</td>
<td class="lastrow">
223.1
</td>
<td class="lastrow">
220.5
</td>
</tr>
</tbody>
</table>
</div>
<!--/html_preserve-->
<p>We do not <em>need</em> to use the <code>sprintf()</code> function,
but it is a very neat way of combining text with numeric variables.</p>
<p>ØVELSE - HVAD MON .3f GØR?</p>
<p>What we absolutely need to do is adding the empty string in the
beginning.</p>
<p>ØVELSE - HVAD SKER DER HVIS MAN LADER VÆRE?</p>
<p>Summary statistics for categorical data can be adjusted similarly, by
specifying <code>render.categorical</code>.</p>

<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use <code>.md</code> files for episodes when you want static
content</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-tidy-data"><p>Content from <a href="tidy-data.html">Tidy Data</a></p>
<hr>
<p>Last updated on 2024-07-30 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/tidy-data.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do you write a lesson using R Markdown and
<a href="https://carpentries.github.io/sandpaper/" class="external-link">sandpaper</a>?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain what tidy data is</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>Most of what we want to do with our data is relatively simple.
<em>If</em> the data is structured in the right way.</p>
<p>Working within the paradigm of <code>tidyverse</code> it is
preferable if the data is <em>tidy</em>.</p>
<p><img src="fig/tidy_why.jpg" alt="test" class="figure">{“Illustrations from the
Openscapes blog Tidy Data for reproducibility, efficiency, and
collaboration by Julia Lowndes and Allison Horst”}</p>
<p>Tidy data is not the opposite of messy data. Data can be nice and
well structured, tidy as in non-messy, without being tidy in the way we
understand it in this context.</p>
<p><img src="fig/tidy_hadley_2.jpg" alt="test2" class="figure">{“Illustrations from
the Openscapes blog Tidy Data for reproducibility, efficiency, and
collaboration by Julia Lowndes and Allison Horst”}</p>
<p>Tidy data in the world of R, especially the dialect of R we call
tidyverse, are characterized by:</p>
<ul>
<li>Each variable is a column; each column is a variable.</li>
<li>Each observation is a row; each row is an observation.</li>
<li>Each value is a cell; each cell is a single value.</li>
</ul>
<p><img src="fig/tidy_hadley.jpg" alt="ter" class="figure">{“Illustrations from the
Openscapes blog Tidy Data for reproducibility, efficiency, and
collaboration by Julia Lowndes and Allison Horst”}</p>
<p>This way of structuring our data is useful not only in R, but also in
other software packages.</p>
</section><section><h2 class="section-heading" id="dos-and-donts-in-excel">Do’s and dont’s in Excel<a class="anchor" aria-label="anchor" href="#dos-and-donts-in-excel"></a>
<a class="anchor" aria-label="anchor" href="#dos-and-donts-in-excel"></a>
</h2>
<hr class="half-width">
<p>Excel is a very useful tool, especially for collecting data.</p>
<p>But even though we are able to do everything we can do in R, in
Excel, we will normally do the main part of our work with data in R.</p>
<p>It is therefor a very good idea to think about how we collect and
organise the data in Excel, to make our life easier later on.</p>
<p>We have collected some good rules of thumb for structuring data in
Excel, based on time-consuming and traumatic experiences wrangling data
from Excel to R.</p>
<p><strong>Always</strong></p>
<ul>
<li>Use one column for one variable</li>
<li>Use one row for one observation</li>
<li>Use one cell for one value</li>
<li>Begin your data in the upper left corner (cell A1)</li>
<li>Use one sheet for each type of data</li>
</ul>
<p><strong>Never (EVER!)</strong></p>
<ul>
<li>Modify your raw data - always make a copy before making any
change</li>
<li>Merge cells</li>
<li>Use colors for information</li>
</ul>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>tidy data provides a consistent way of organizing data</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-normal-distribution"><p>Content from <a href="normal-distribution.html">The normal distribution</a></p>
<hr>
<p>Last updated on 2024-07-30 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/normal-distribution.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do you write a lesson using R Markdown and
<a href="https://carpentries.github.io/sandpaper/" class="external-link">sandpaper</a>?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to use markdown with the new lesson template</li>
<li>Demonstrate how to include pieces of code, figures, and nested
challenge blocks</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="the-normal-distribution">The Normal Distribution<a class="anchor" aria-label="anchor" href="#the-normal-distribution"></a>
<a class="anchor" aria-label="anchor" href="#the-normal-distribution"></a>
</h2>
<hr class="half-width">
<p>The normal distribution follows this formula:</p>
<p><span class="math display">\[
f(x) = \frac{1}{\sqrt{2\pi\sigma^2}} e^{-\frac{(x-\mu)^2}{2\sigma^2}}
\]</span></p>
<p>It returns the probability density for a given x, population mean and
population standard deviation. We can see that it is the “true” mean and
standard deviation for the entire population, basically for the
<em>entire</em> universe, because they are written using greek
letters.</p>
<p>We are often working with the standardized normal distribution, where
mean is 0 and the standard deviation is 1.</p>
<p>If we plot that, it looks like this:</p>
<p><img src="fig/The_Normal_Distribution.svg" alt="The Normal Distribution." class="figure"> The area under the curve is 1,
equivalent to 100%.</p>
<p>The normal distribution have a lot of nice mathematical properties,
some of which are indicated on the graph.</p>
<p>CDF-plottet - så vi har forbindelsen til den deskriptive
statistik.</p>
<p>Konceptet med - hvad er sandsynligheden for at se en observation der
ligger x standardafvigelser fra middelværdien.</p>
<p>This allows us to calculate the probability of finding a certain
value in the data, if the data is normally distributed, if we know the
mean and the standard deviation.</p>
<p>R provides us with a set of functions:</p>
<p>pnorm the probability of having a smaller value than. qnorm the value
corresponding to a given probability dnorm the probability density of
the norma distribution at a given x.</p>
<p>Og det er for den standardiserede normalfordeling N(0,1)</p>
<p>De har mulighed for at returnere værdier for en hvilken som helst
normalfordeling med arbitrære middelværdi og standardafvigelse.</p>
<p>An example:</p>
<p>If the height of men are normally distributed, with a mean (mu) = 183
cm, and a standarddeviation of 9.7 cm. How probably is it to find a man
that is taller than 2 meters?</p>
<p>Directly:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span> <span class="op">-</span> <span class="fu">pnorm</span><span class="op">(</span><span class="fl">200</span>,<span class="fl">183</span>,<span class="fl">9.7</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.03983729</code></pre>
</div>
<p>In this example, pnorm returns the probability of an observation
smaller than 200, if data is normally distributed with mean 183, and
standard deviation 9.7.</p>
<p>The probability of finding any observation is 1. So the probability
of finding an observation larger than 200, is 1 minus the probability of
finding an observation smaller than 200.</p>
<p>Manually we could calculate the distance from 200 to 183 = 17. And
divide that with the standard deviation 9.7: 17/9.7 = 1.752577.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span> <span class="op">-</span> <span class="fu">pnorm</span><span class="op">(</span><span class="fl">1.752577</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.03983732</code></pre>
</div>
<p>How many men are between 170 and 190 cm tall? Lidt før dette punkt
skal vi videre til næste lesson.</p>
<p>Og efter clt videre til hypotesetests</p>
</section><section><h2 class="section-heading" id="clt">CLT<a class="anchor" aria-label="anchor" href="#clt"></a>
<a class="anchor" aria-label="anchor" href="#clt"></a>
</h2>
<hr class="half-width">
<p>CLT fører til at vi kan betragte middelværdien for vores data som
normalfordelt. selv når disse data ikke <em>er</em> normalfordelte.</p>
<p>I praksis bruger vi t-fordelingen, der ser lidt anderledes ud - vi
har nemlig ikke kendskab til hele populationens sande middelværdi og
varians. t-fordelingen har tykkere haler, der giver os større sikkerhed
for vores konklusioner.</p>
<p>Hvad gør vi så? Hvis vi tager i princippet uendeligt mange
stikprøver, samples, og beregner middelværdierne, så vil disse
middelværdier følge normalfordelingen.</p>
<p>hvis vi fremstiller linealer, og har en tese om at de er præcist 20
cm lange, som de skal være. det er mu</p>
<p>Nu tager vi en stikprøve på størrelsen “n” fra produktionen. Måler
dem, og beregner gennemsnittet.</p>
<p>Måler vi præcist nok, vil det gennemsnit formentlig adskille sig fra
20 cm. Det gennemsnit er X-bar.</p>
<p>I dette tilfælde antager vi at vi kender standardafvigelsen for vores
produktion.</p>
<p>Hvis vi normerer alle vores målinger, så gennemsnittet er 0. Det gør
vi ved at trække gennemsnittet fra alle målinger. Og så
standardafvigelsen er 1. Det gør vi ved at dividere alle målinger med
standardafvigelsen.</p>
<p>Så vil gennemsnittet af vores stikprøve, fordi CLT, følge en
normalfordeling. Og vi kan se hvor det gennemsnit, denne z-score,
placerer sig på den sande normalfordeling.</p>
<p>og ud fra de matematiske egenskaber fra normalfordelingen, kan vi se
hvor underlig den middelværdi vi måler, er.</p>
<p>og det er stadig ikke en specielt god forklaring…</p>
<div class="section level3">
<h3 id="fordelingsfunktionerne-i-r-">Fordelingsfunktionerne i R.<a class="anchor" aria-label="anchor" href="#fordelingsfunktionerne-i-r-"></a>
</h3>
<p>De hyppigst forekommende fordelinger har hver deres sæt af
funktioner.</p>
<div class="section level4">
<h4 id="rnorm">rnorm<a class="anchor" aria-label="anchor" href="#rnorm"></a>
</h4>
<p>I samme familie finder vi runif, rbeta og en del andre:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rnorm</span><span class="op">(</span><span class="fl">5</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span> <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1]  0.17668452 -1.48868449  0.09500549  0.94531847  0.56708962</code></pre>
</div>
<p>Den returnerer (her) fem tilfældige værdier fra en normalfordeling
med (her) middelværdi 0 og standardafvigelse 1.</p>
</div>
<div class="section level4">
<h4 id="dnorm">dnorm<a class="anchor" aria-label="anchor" href="#dnorm"></a>
</h4>
<p>densiteten. I plottet er det værdien på y-aksen af kurven.</p>
</div>
<div class="section level4">
<h4 id="pnorm">pnorm<a class="anchor" aria-label="anchor" href="#pnorm"></a>
</h4>
<p>Den kumulative fordeling. Hvis x er 0, er arealet fra minus uendelig
til 0 lig pnorm(0). Og hvis vi bruger defaulet mean og sd, er det så
0.5. Sandsynligheden for en værdi mindre end x.</p>
</div>
<div class="section level4">
<h4 id="qnorm">qnorm<a class="anchor" aria-label="anchor" href="#qnorm"></a>
</h4>
<p>det er så den omvendte funktion af pnorm. Husk det på at et q er det
omvendte af et p.</p>
<p>i pnorm finder vi sandsynligheden for at værdien er mindre end x. I
qnorm finder vi x for en given sandsynlighed.</p>
</div>
</div>
</section><section><h2 class="section-heading" id="er-ting-normalfordelte">Er ting normalfordelte?<a class="anchor" aria-label="anchor" href="#er-ting-normalfordelte"></a>
<a class="anchor" aria-label="anchor" href="#er-ting-normalfordelte"></a>
</h2>
<hr class="half-width">
<p>Normalfordelingen kaldes normal fordi Karl Pearson og Francis Galton
i det 19. århundrede observerede at det var en statistisk fordeling der
forklarede rigtig mange fænomener i befolkningsdata. Højde, vægt,
blodtryk, intelligenskvotienter mv. Faktisk var det den der forklarede
flest (af de ting de nu undersøgte).</p>
<p>Og så er det i øvrigt den fordeling som middelværdier af stikprøver
vil tilnærme sig jf. den centrale grænseværdisætning.</p>
<p>Så den er normal fordi det er normen, den hyppigst forekommende. Ikke
at forveksle med en mere løs, dagligsprogs, normativ (pun intended)
anvendelse af ordet norm. Normalen i en statistisk sammenhæng er ganske
enkelt den hyppigst forekommende observation.</p>
<p>Det i statistisk forstand normale, normen, er at have brune øjne
(&gt;50% af klodens befolkning har brune øjne). Det betyder ikke at der
er noget galt med at have blå øjne.</p>
<p>Og rigtig mange ting er ret tæt på at være normalfordelte. Men i
virkeligheden er der ikke mange fænomener der følger normalfordelingen
fuldstændig. Et eksempel:</p>
<p>Serum (en del af blod) Molybdæn (der er et essentielt sporstof i
human fysiologi), har en middelværdi på 1.55 og en standardafvigelse på
0.74 hos normale, raske mennesker.</p>
<p>Rifai, N. (2017). Tietz textbook of clinical chemistry and molecular
diagnostics : Tietz textbook of clinical chemistry and molecular
diagnostics - e-book. Elsevier - Health Sciences Division.</p>
<p>Hvis vi antager at serum-Molybdæn er normalfordelt i populationen,
kan vi beregne hvor stor en andel af den normale raske befolkning i
danmark, der har en Molybdæn-koncentration under 0:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pnorm</span><span class="op">(</span><span class="fl">0</span>, mean <span class="op">=</span> <span class="fl">1.55</span>, sd <span class="op">=</span> <span class="fl">0.74</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.01810352</code></pre>
</div>
<p>Hvilket vil sige at vi forventer at lidt over 100.000 danskere har et
negativt indhold af Molybdæn i blodet. Hvilket er fysisk umuligt.
Hvorfor går det så godt alligevel? Fordi serum molybdæn er normalfordelt
<em>nok</em>.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use <code>.md</code> files for episodes when you want static
content</li>
<li>Use <code>.Rmd</code> files for episodes when you need to generate
output</li>
<li>Run <code>sandpaper::check_lesson()</code> to identify any issues
with your lesson</li>
<li>Run <code>sandpaper::build_lesson()</code> to preview your lesson
locally</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-is-it-normal"><p>Content from <a href="is-it-normal.html">Testing for normality</a></p>
<hr>
<p>Last updated on 2024-07-30 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/is-it-normal.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do we determine if a dataset might be normally distributed?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to use markdown with the new lesson template</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">palmerpenguins</span><span class="op">)</span></span></code></pre>
</div>
<section><h2 class="section-heading" id="how-to-test-if-our-data-is-normally-distributed">How to test if our data is normally distributed?<a class="anchor" aria-label="anchor" href="#how-to-test-if-our-data-is-normally-distributed"></a>
<a class="anchor" aria-label="anchor" href="#how-to-test-if-our-data-is-normally-distributed"></a>
</h2>
<hr class="half-width">
<p>Common question - is my data normally distributed?</p>
<p>What does it mean that it is normally distributed? It means that the
distribution of our data has the same properties as the normal
distribution.</p>
<p>Let us get some data that we can test:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">normal_test_data</span> <span class="op">&lt;-</span> <span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">species</span> <span class="op">==</span> <span class="st">"Chinstrap"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">bill_depth_mm</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="mean-and-median">Mean and median<a class="anchor" aria-label="anchor" href="#mean-and-median"></a>
</h3>
<p>One of the properties of the normal distribution is that the mean and
median of the data is equal. Let us look at the penguins:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="va">normal_test_data</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> bill_depth_mm
 Min.   :16.40
 1st Qu.:17.50
 Median :18.45
 Mean   :18.42
 3rd Qu.:19.40
 Max.   :20.80  </code></pre>
</div>
<p>This is actually pretty close! But equality between median and mean
is a neccesary, not a sufficient condition.</p>
<p>What next. A histogram of the data should look normal. Let us take a
closer look at bill_depth_mm where mean and median are closest:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">normal_test_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">bill_depth_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<figure><img src="fig/is-it-normal-rendered-histogram-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>This does not really look like a normal distribution. The fact that
mean and median are almost identical was not a sufficient criterium for
normalcy.</p>
<p>The shape of a histogram is heavily dependent on the bins we choose.
A better way of visualizing often density-plots:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">normal_test_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">bill_depth_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_density</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/is-it-normal-rendered-densityplot-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>We can think of this as a histogram with infinitely small bins.</p>
<p>This does look more normal - but it would be nice to be able to
quantize the degree of normalcy.</p>
</div>
</section><section><h2 class="section-heading" id="percentiels-and-qq-plots-as-a-test">Percentiels and QQ-plots as a test<a class="anchor" aria-label="anchor" href="#percentiels-and-qq-plots-as-a-test"></a>
<a class="anchor" aria-label="anchor" href="#percentiels-and-qq-plots-as-a-test"></a>
</h2>
<hr class="half-width">
<p>The properties of the normal distribution informs us that 50% of the
observations in the data are smaller than the mean (and conversely 50%
are larger). We alson know that 50% of the observations should be in the
interquartile range. And what we also know is that 2.5% of the
observations (the 2.5 percentile) are smaller than the mean minus 1.96
times the standard deviation.</p>
<p>Actually we can calculate exactly which percentile a given
observation is in. And we we can calculate which value a given
percentile should have.</p>
<p>Comparing those gives us an indication of how well the data conforms
to a normal distribution.</p>
<p>Rather than doing that by hand, we can get R to do it for us in a
nice graphical way:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">normal_test_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>sample <span class="op">=</span> <span class="va">bill_depth_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_qq</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_qq_line</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/is-it-normal-rendered-qq-plot-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The <code>geom_qq</code> function calculate and plots which
percentile an observation is in.</p>
<p>Rather than being given percentiles, we are given the value that the
percentile corresponds to if we calculate it as number of standard
deviations from the mean.</p>
<p>This results in plots that are more comparable.</p>
<p><code>geom_qq_line</code> plots the line corresponding til the values
the percentiles should have, if the data was normally distributed.</p>
<p>A common theme is that the midle of the data falls relatively close
to the line, and that there are deviations from the line at both ends.
In this case the deviations are largish, indicating that the data is not
normally distributed.</p>
<div id="callout1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout<a class="anchor" aria-label="anchor" href="#callout1"></a>
</h3>
<div class="callout-content">
<p>We have two tails in the qq-plot, a left and a right. And they can be
either above or below the qq-line.</p>
<p>That results in four different cases, that informs us about what is
wrong with the data - in regards to how it deviates from normalcy.</p>
<table class="table">
<colgroup>
<col width="15%">
<col width="15%">
<col width="15%">
<col width="54%">
</colgroup>
<thead><tr class="header">
<th>Left tail</th>
<th>Right tail</th>
<th>Name</th>
<th>What</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Above</td>
<td>Below</td>
<td>Leptokurtic</td>
<td>Heavier tails - ie. more extreme values. Higher kurtosis</td>
</tr>
<tr class="even">
<td>Below</td>
<td>Above</td>
<td>Platykurtic</td>
<td>Lighter tails - ie. fewer extreme values. Lower kurtosis</td>
</tr>
<tr class="odd">
<td>Above</td>
<td>Above</td>
<td>Right skewed</td>
<td>A tail that stretches to the higher values - the extreme values are
larger.</td>
</tr>
<tr class="even">
<td>Below</td>
<td>Below</td>
<td>Left skewed</td>
<td>A tail that stretches to the lower values - the extreme values are
smaller.</td>
</tr>
</tbody>
</table>
<figure><img src="fig/is-it-normal-rendered-unnamed-chunk-1-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="numerical-measures-rather-than-graphical">Numerical measures rather than graphical<a class="anchor" aria-label="anchor" href="#numerical-measures-rather-than-graphical"></a>
<a class="anchor" aria-label="anchor" href="#numerical-measures-rather-than-graphical"></a>
</h2>
<hr class="half-width">
<p>With experience the qq-plots can be used to determine if the data is
normally distributed - the points are exactly on the line. But only
rarely the points matches exactly - even if the data is normally
distributed <em>enough</em>. And how much can the tails deviate from the
line before the data is not normally distributed <em>enough</em>?</p>
<p>The deviations can be described numerically using two parameters:</p>
<p>Kurtosis and skewness.</p>
<p>Base-R do not have functions for this, but the package
<code>e1071</code> does.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">e1071</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">skewness</span><span class="op">(</span><span class="va">normal_test_data</span><span class="op">$</span><span class="va">bill_depth_mm</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.006578141</code></pre>
</div>
<p>kurtosis</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">kurtosis</span><span class="op">(</span><span class="va">normal_test_data</span><span class="op">$</span><span class="va">bill_depth_mm</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] -0.960087</code></pre>
</div>
<p>As a rule of thumb, skewness should be within +/-0.5 if the data is
normally distributed. Values between +/-0.5 and +/- 1 indicates a
moderate skewness, where data <em>can</em> still be approximately
normally distributed. Values larger that +/-1 indicates a significant
skewness, and the data is probably not normally distributed.</p>
<p>For the kurtosis matters are a bit more complicated as the kurtosis
for a normal distribution is 3. We therefore look at excess kurtosis,
where i subtract 3 from the calculated kurtosis. An value of +/-1 exces
kurtosis indicates that the data has a ‘tailedness’ close to the normal
distribution. Values between +/-1 and +/-2 indicates a moderate
deviation from the normal distribution, but the data can still be
approximately normally distributed. Values larger than +/-2 is in
general taken as an indication that the data is not normally
distributed.</p>
<p>The absolute value of the excess kurtosis is larger than 2,
indicating that the data is not normally distributed.</p>
</section><section><h2 class="section-heading" id="more-direct-tests">More direct tests<a class="anchor" aria-label="anchor" href="#more-direct-tests"></a>
<a class="anchor" aria-label="anchor" href="#more-direct-tests"></a>
</h2>
<hr class="half-width">
<p>The question of wether or not data is normally distributed is
important in many contexts, and it should come as no surprise that a
multitude of tests has been devised for testing exactly that.</p>

<div class="section level3">
<h3 id="shapiro-wilk">Shapiro-Wilk<a class="anchor" aria-label="anchor" href="#shapiro-wilk"></a>
</h3>
<p>The Shapiro-Wilk test is especially suited for small sample sizes
(&lt;50, some claim it works well up to &lt;2000).</p>
<p>It is a measure of the linear correlation between data and the
normally distributed quantiles, what we see in the qqplot.</p>
<p>The null-hypothesis is that data is normally distributed, and the
Shapiro-Wilk test returns a p-value reporting the risk of being wrong if
we reject the null-hypothesis.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">shapiro.test</span><span class="op">(</span><span class="va">normal_test_data</span><span class="op">$</span><span class="va">bill_depth_mm</span><span class="op">)</span> </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Shapiro-Wilk normality test

data:  normal_test_data$bill_depth_mm
W = 0.97274, p-value = 0.1418</code></pre>
</div>
<p>The p-value in this case is 0.1418 - and we do not have enough
evidense to reject the null-hypothesis. The data is probably normally
distributed.</p>
</div>
<div class="section level3">
<h3 id="kolmogorov-smirnov">Kolmogorov-Smirnov<a class="anchor" aria-label="anchor" href="#kolmogorov-smirnov"></a>
</h3>
<p>The KS-test allows us to test if the data is distributed as a lot of
different distributions, not only the normal distribution. Because of
this, we need to specify the specific distribution we are testing for,
in this case a normal distribution with specific values for mean and
standard deviation.</p>
<p>Therefore we need to calculate those:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mean</span> <span class="op">&lt;-</span> <span class="fu">mean</span><span class="op">(</span><span class="va">normal_test_data</span><span class="op">$</span><span class="va">bill_depth_mm</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">sd</span> <span class="op">&lt;-</span> <span class="fu">sd</span><span class="op">(</span><span class="va">normal_test_data</span><span class="op">$</span><span class="va">bill_depth_mm</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">ks.test</span><span class="op">(</span><span class="va">normal_test_data</span><span class="op">$</span><span class="va">bill_depth_mm</span>, <span class="st">"pnorm"</span>, mean <span class="op">=</span> <span class="va">mean</span>, sd <span class="op">=</span> <span class="va">sd</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning in ks.test.default(normal_test_data$bill_depth_mm, "pnorm", mean =
mean, : ties should not be present for the one-sample Kolmogorov-Smirnov test</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Asymptotic one-sample Kolmogorov-Smirnov test

data:  normal_test_data$bill_depth_mm
D = 0.073463, p-value = 0.8565
alternative hypothesis: two-sided</code></pre>
</div>
<p>In this test the null-hypothesis is also that data is normally
distributed. The p-values is very high, and therefore we cannot reject
the null-hypothesis. Again, this is not the same as the data
<em>actually</em> being normally distributed.</p>
<p>This test assumes that there are no repeated values in the data, as
that can affect the precision of the test. The p-value is still very
high, and we will conclude that we cannot rule out that the data is not
normally distributed.</p>
<p>Note that the KS-test assumes that we actually know the true mean and
standard deviation. Here we calculate those values based on the sample,
which is problematic.</p>
</div>
<div class="section level3">
<h3 id="liliefors-test">Liliefors test<a class="anchor" aria-label="anchor" href="#liliefors-test"></a>
</h3>
<p>This is a variation on the KS-test, that is designed specifically for
testing for normality. It does not require us to know the true mean and
standard deviation for the population.</p>
<p>This test is also not available in base-R, but can be found in the
<code>nortest</code> package:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">nortest</span><span class="op">)</span></span>
<span><span class="fu">lillie.test</span><span class="op">(</span><span class="va">normal_test_data</span><span class="op">$</span><span class="va">bill_depth_mm</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Lilliefors (Kolmogorov-Smirnov) normality test

data:  normal_test_data$bill_depth_mm
D = 0.073463, p-value = 0.483</code></pre>
</div>
<p>Again the p-value is so high, that we cannot reject the
null-hypothesis.</p>
</div>
<div class="section level3">
<h3 id="anderson-darling-test">Anderson-Darling test<a class="anchor" aria-label="anchor" href="#anderson-darling-test"></a>
</h3>
<p>This test is more sensitive for deviations in the tails.</p>
<p>It is not available in base-R, but can be found in the
<code>nortest</code> package.</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ad.test</span><span class="op">(</span><span class="va">normal_test_data</span><span class="op">$</span><span class="va">bill_depth_mm</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Anderson-Darling normality test

data:  normal_test_data$bill_depth_mm
A = 0.44788, p-value = 0.2714</code></pre>
</div>
<p>In this case the null-hypothesis is also that data is normally
distributed, and the p-value indicates that we cannot reject the
null-hypothesis.</p>
</div>
</section><section><h2 class="section-heading" id="and-is-it-actually-normally-distributed">And is it actually normally distributed?<a class="anchor" aria-label="anchor" href="#and-is-it-actually-normally-distributed"></a>
<a class="anchor" aria-label="anchor" href="#and-is-it-actually-normally-distributed"></a>
</h2>
<hr class="half-width">
<p>Probably not. Except for the excess kurtosis all the tests we have
done indicate that the depth of the beaks of chinstrap penguins can be
normally distributed. Or rather, that we cannot reject the
null-hypothesis that they are normally distributed.</p>
<p>But the fact that we cannot reject this hypothesis is not the same as
concluding that the data actually <strong>is</strong> normally
distributed.</p>
<p>Based on the excess kurtosis and the qq-plot, it would be reasonable
to conclude that it is not.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use <code>.md</code> files for episodes when you want static
content</li>
<li>Use <code>.Rmd</code> files for episodes when you need to generate
output</li>
<li>Run <code>sandpaper::check_lesson()</code> to identify any issues
with your lesson</li>
<li>Run <code>sandpaper::build_lesson()</code> to preview your lesson
locally</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-which-distribution"><p>Content from <a href="which-distribution.html">How is the data distributed?</a></p>
<hr>
<p>Last updated on 2024-07-30 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/which-distribution.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>If my data is not normally distributed - which distribution does it
actually follow?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Show how to identify possible distributions describing the data</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>Your data was not normally distributed. Now what?</p>
<p>The process generating your data is probably following some
distribution. The size distribution of cities appears to follow a Pareto
distibution, as is wealth. The number of mutations in a string of DNA
appears to follow a poisson distribution. And the distribution of wind
speeds as well as times to failure for technical components both follow
the Weibull distribution.</p>
<p>If you have a theoretical foundation for which distribution you data
generating function follows, that is nice.</p>
<p>If you do not - we will be interested in figuring out which
distribution your data actually follow.</p>
</section><section><h2 class="section-heading" id="how">How?<a class="anchor" aria-label="anchor" href="#how"></a>
<a class="anchor" aria-label="anchor" href="#how"></a>
</h2>
<hr class="half-width">
<p>We fit our data to a distribution. Or rather - we fit the data to
several different distributions and then choose the best.</p>
<p>Let us look at some data. The <code>faithful</code> data set contains
272 observations of the Old Faithful geyser in Yellowstone National Park
in USA. We only look at eruptions that lasts longer than 3 minutes:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span>
<span><span class="va">eruption_example</span> <span class="op">&lt;-</span> <span class="va">faithful</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">eruptions</span> <span class="op">&gt;</span> <span class="fl">3</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">select</span><span class="op">(</span><span class="va">eruptions</span><span class="op">)</span></span></code></pre>
</div>

<p>Rather than testing a lot of different distributions, we can use the
<code>gamlss</code> package, and two add-ons to that.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">gamlss</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">gamlss.dist</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">gamlss.add</span><span class="op">)</span></span></code></pre>
</div>
<p><code>gamlss</code> has the advantage of implementing a <em>lot</em>
of different statistical distributions.</p>
<p>The function <code>fitDist()</code> from <code>gamlss</code> will fit
the data to a selection of different statistical distributions,
calculate a measure of the goodness of fit, and return the best fit (and
information on all the others). Rather than testing against all 97
different distributions supported by <code>gamlss</code>, we can specify
only a selection, in this case <code>realplus</code>, that only includes
the 23 distributions that are defined for positive, real numbers:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">fitDist</span><span class="op">(</span><span class="va">eruptions</span>, type <span class="op">=</span> <span class="st">"realplus"</span>, data <span class="op">=</span> <span class="va">eruption_example</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  |                                                                              |                                                                      |   0%  |                                                                              |===                                                                   |   4%  |                                                                              |======                                                                |   9%  |                                                                              |=========                                                             |  13%  |                                                                              |============                                                          |  17%  |                                                                              |===============                                                       |  22%  |                                                                              |==================                                                    |  26%  |                                                                              |=====================                                                 |  30%  |                                                                              |========================                                              |  35%  |                                                                              |===========================                                           |  39%  |                                                                              |==============================                                        |  43%  |                                                                              |=================================                                     |  48%  |                                                                              |=====================================                                 |  52%  |                                                                              |========================================                              |  57%  |                                                                              |===========================================                           |  61%  |                                                                              |==============================================                        |  65%  |                                                                              |=================================================                     |  70%  |                                                                              |====================================================                  |  74%  |                                                                              |=======================================================               |  78%  |                                                                              |==========================================================            |  83%Error in solve.default(oout$hessian) :
  Lapack routine dgesv: system is exactly singular: U[4,4] = 0
  |                                                                              |=============================================================         |  87%Error in solve.default(oout$hessian) :
  Lapack routine dgesv: system is exactly singular: U[4,4] = 0
  |                                                                              |================================================================      |  91%  |                                                                              |===================================================================   |  96%  |                                                                              |======================================================================| 100%</code></pre>
</div>
<p>If you do this yourself, you will notice a lot of error-messages. It
is not possible to fit this particular data to <em>all</em> the
distributions, and the ones where the fit fails (enough), we will get an
error message.</p>
<p>The output from <code>fitDist()</code> will return the best fit:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Family:  c("WEI2", "Weibull type 2")
Fitting method: "nlminb"

Call:  gamlssML(formula = y, family = DIST[i])

Mu Coefficients:
[1]  -18.69
Sigma Coefficients:
[1]  2.524

 Degrees of Freedom for the fit: 2 Residual Deg. of Freedom   173
Global Deviance:     175.245
            AIC:     179.245
            SBC:     185.574 </code></pre>
</div>
<p>We are told that the statistical distribution that best fits the data
is <code>Weibull type 2</code> and that the AIC-measurement of goodness
of fit is 170.245.</p>
<div id="callout1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout<a class="anchor" aria-label="anchor" href="#callout1"></a>
</h3>
<div class="callout-content">
<p>Is that a good fit? That is a good question. It strongly depends on
the values in the dataset. In this dataset, the length of the eruptions
are measured in minutes If we choose to measure that length in another
unit, eg seconds, the distribution should not change. But the AIC
will.</p>
<p>We can use the AIC to decide that one distribution fits the data
better than another, but not to conclude that that distribution is the
correct one.</p>
</div>
</div>
</div>
<p>The <code>fit</code> object containing the output of the
<code>fitDist()</code> function contains quite a bit more.</p>
<p>If we start by getting the errors out of the way,
<code>fit$failed</code> returns the two distributions that failed enough
to cause errors:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span><span class="op">$</span><span class="va">failed</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[[1]]
[1] "GIG"

[[2]]
[1] "LNO"</code></pre>
</div>
<p>As mentioned <code>fitDist()</code> fitted the data to 23 different
distributions. We can inspect the rest, and their associated AIC-values
like this:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span><span class="op">$</span><span class="va">fits</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>    WEI2     WEI3      WEI       GG    BCPEo     BCPE    BCCGo     BCCG
179.2449 179.2449 179.2449 181.1349 181.4953 181.4953 183.1245 183.1245
     GB2      BCT     BCTo   exGAUS       GA   LOGNO2    LOGNO       IG
183.1354 185.1245 185.1245 190.2994 194.4665 198.3047 198.3047 198.3558
  IGAMMA      EXP       GP PARETO2o  PARETO2
202.6759 861.8066 863.8067 863.8079 863.8081 </code></pre>
</div>
<p>Here we get <code>WEI2</code> first, with an AIC of 179.2449, but we
can see that <code>WEI3</code> and <code>WEI1</code> have almost exactly
the same AIC. Not that surprising if we guess that
<code>Weibull type 3</code> is probably rather similar to
<code>Weibull type 2</code>.</p>
<p>The difference in AIC for the first two distributions tested is very
small. Is it large enough for us to think that <code>WEI2</code> is
significantly better than <code>WEI3</code>?</p>
<p>No. As a general rule of thumb, the difference between the AIC of two
distributions have to be larger than 2 for us to see a significant
difference.</p>
<p>We can get more details using the <code>summary()</code>
function:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>*******************************************************************
Family:  c("WEI2", "Weibull type 2")

Call:  gamlssML(formula = y, family = DIST[i])

Fitting method: "nlminb"


Coefficient(s):
             Estimate  Std. Error  t value   Pr(&gt;|t|)
eta.mu    -18.6934274   1.1306427 -16.5334 &lt; 2.22e-16 ***
eta.sigma   2.5242093   0.0589965  42.7858 &lt; 2.22e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

 Degrees of Freedom for the fit: 2 Residual Deg. of Freedom   173
Global Deviance:     175.245
            AIC:     179.245
            SBC:     185.574 </code></pre>
</div>
<p>And we can get at graphical description as well:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/which-distribution-rendered-unnamed-chunk-7-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>******************************************************************
	      Summary of the Quantile Residuals
                           mean   =  -0.001205749
                       variance   =  0.9953007
               coef. of skewness  =  0.09022876
               coef. of kurtosis  =  2.529951
Filliben correlation coefficient  =  0.9976953
******************************************************************</code></pre>
</div>
</section><section><h2 class="section-heading" id="what-about-the-other-options">What about the other options?<a class="anchor" aria-label="anchor" href="#what-about-the-other-options"></a>
<a class="anchor" aria-label="anchor" href="#what-about-the-other-options"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="general-comments">General comments<a class="anchor" aria-label="anchor" href="#general-comments"></a>
</h3>
<p>Above we got the “best” fit. But we also noted that in order for us
to conclude that one distribution is a better fit than another, the
difference in AIC should be at least 2.</p>
<p>What we are looking for might not actually be the probability
distribution that best fits our data. Our data might be noisy or there
might me systematic errors. The probability distribution we really want,
is the one that best matches the underlying data generating function,
the mechanisms in the real world that we are studying, that actually is
at the hearth of the data we collect.</p>
<p>We might not be able to find that. But we should consider if some of
the other possibilities provided by <code>fitDist()</code> might
actually be better.</p>

<p>First step is to look at the relevant distributions. In the setup
with <code>gamlss</code>, <code>gamlss.dist</code> and
<code>gamlss.add</code> we can test distributions of different types.
The complete list can be found using the help function for
<code>fitDist()</code>, but falls in the following families:</p>
<ul>
<li>realline - continuous distributions for all real values</li>
<li>realplus - continuous distributions for positive real values</li>
<li>realAll - all continuous distributions - the combination of realline
and realplus</li>
<li>real0to1 - continuous distributions defined for real values between
0 and 1</li>
<li>counts - distributions for counts</li>
<li>binom - binomial distributions</li>
</ul>
<p>Begin by considering which type whatever your data is describing,
best matches.</p>
</div>
<div class="section level3">
<h3 id="actually-looking-at-the-fits">Actually looking at the fits<a class="anchor" aria-label="anchor" href="#actually-looking-at-the-fits"></a>
</h3>
<p>For the selection of eruptions that we fitted, we chose the
“realplus” selection of distibutions to test. We did that, because the
eruption times are all positive, and on the real number line.</p>
<div class="instructur">
<p>“Real numbers”, på dansk reelle tal. Hvis du ved hvad imaginære tal
er, ved du også hvad reelle tal er. Hvis ikke - så er reelle tal alle de
tal du vil tænke på som tal.</p>
</div>
<p>Behind the scenes <code>fitDist</code> fits the data to the chosen
selection of distributions, and returns the best.</p>
<p>Looking at the result of the fit we see this:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Family:  c("WEI2", "Weibull type 2")
Fitting method: "nlminb"

Call:  gamlssML(formula = y, family = DIST[i])

Mu Coefficients:
[1]  -18.69
Sigma Coefficients:
[1]  2.524

 Degrees of Freedom for the fit: 2 Residual Deg. of Freedom   173
Global Deviance:     175.245
            AIC:     179.245
            SBC:     185.574 </code></pre>
</div>
<p>In the <code>Call</code> part of the output, we see this:</p>
<p><code>Call:  gamlssML(formula = y, family = DIST[i])</code></p>
<p>and from that we can deduces that if we want to fit the data to eg
the log-normal distribution (in the documentation we find that the
abbreviation for that is “LOGNO”), we can do it like this:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">log_norm_fit</span> <span class="op">&lt;-</span> <span class="fu">gamlss</span><span class="op">(</span><span class="va">eruptions</span> <span class="op">~</span> <span class="fl">1</span>, family <span class="op">=</span> <span class="va">LOGNO</span>, data <span class="op">=</span> <span class="va">eruption_example</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>GAMLSS-RS iteration 1: Global Deviance = 194.3047
GAMLSS-RS iteration 2: Global Deviance = 194.3047 </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="va">log_norm_fit</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>******************************************************************
Family:  c("LOGNO", "Log Normal")

Call:
gamlss(formula = eruptions ~ 1, family = LOGNO, data = eruption_example)

Fitting method: RS()

------------------------------------------------------------------
Mu link function:  identity
Mu Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) 1.451832   0.007461   194.6   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Sigma link function:  log
Sigma Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -2.31561    0.05345  -43.32   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
No. of observations in the fit:  175
Degrees of Freedom for the fit:  2
      Residual Deg. of Freedom:  173
                      at cycle:  2

Global Deviance:     194.3047
            AIC:     198.3047
            SBC:     204.6343
******************************************************************</code></pre>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>The data generating function is not necessarily the same as the
distribution that best fit the data</li>
<li>Chose the distribution that best describes your data - not the one
that fits best</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section><section id="aio-regression"><p>Content from <a href="regression.html">Linear regression</a></p>
<hr>
<p>Last updated on 2024-07-30 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/regression.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I make a linear regression?</li>
<li>How do I interpret the results of a linear regression?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to fit data to a linear equation in one dimension</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>Here is some data, observations of the distance (in ft) it takes to
stop a car driving at different speeds (in mph):</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cars</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">speed</span>,<span class="va">dist</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/regression-rendered-unnamed-chunk-1-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Not surprisingly the faster the car travels, the longer distance it
takes to stop it.</p>
<p>If we want to predict how long a car traveling at 10 mph takes to
stop, we could look at the observations at 10 mph and note that there is
some variation. We might take the average of those observations, and use
that as an estimate of how many feet it takes to stop a car traveling at
10 mph.</p>
<p>But what if we want to predict how long it takes to stop the car if
we are driving it at 12.5 mph instead? That would be nice to know, in
order to avoid hitting stuff. There are no observations in the data at
12.5 mph! We could estimate it as the average of the (average) stopping
distance at 12 mph and at 13 mph (21.5 and 35 ft respectively) and give
an estimate of 28.25 ft.</p>
<p>This is easy - 12.5 is exactly at the middle of the interval of 12 to
13 mph. But what if we want the distance at 12.4 mph?</p>
<p>Instead of fiddling with the numbers manually, we note that it
appears to be possible to draw a straight line through the points,
describing the connection between the two variables.</p>
<p>Let’s do that:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cars</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">speed</span>,<span class="va">dist</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<figure><img src="fig/regression-rendered-unnamed-chunk-2-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The points do not fall precisely on the line, but it’s not very
bad.</p>

<p>When we want to figure out how long it takes to stop a car driving at
12.5 mph, we can locate 12.5 on the x-axis, move vertically up to the
line, and read the corresponding value on the y-axis, about 30 mph.</p>
<p>But we can do better. Such a line can be described mathematically.
Straight lines in two dimensions can in general be described using the
formula:</p>
<p><span class="math display">\[
y = ax + b
\]</span> or, in this specific case:</p>
<p><span class="math display">\[
dist = a*speed + b
\]</span></p>
<p><code>a</code> and <code>b</code> are the coefficients of this
“model”. <code>a</code> is the slope, or how much the distance changes,
if we change speed by one. <code>b</code> is the intercept, the value
where the line crosses the y-axis. Or the distance it takes to stop a
car, traveling at a speed of 0 miles per hour - a value that does not
necessarily make sense, but is still a part of the model.</p>
<p>If we want to be very strict about it, that <code>=</code> is not
really equal. The expression describes the straight line, but the actual
observations do not actually fall on the line. If, for a given dist and
speed, we want the expression to actually be equal, there is some
variation that we need to include. We do that by adding a
<code>residual</code>:</p>
<p><span class="math display">\[
dist = a*speed + b + \epsilon
\]</span></p>
<p>And, if we want to be very mathematical concise, instead of using
<code>a</code>and <code>b</code> for the coefficients in the expression,
we would instead write it like this:</p>
<p><span class="math display">\[
dist = \beta_0 + \beta_1 speed + \epsilon
\]</span></p>
<p>That is all very nice. But how do we find the actual <code>a</code>
and <code>b</code> (or <span class="math inline">\(\beta_i\)</span>)?
What is the “best” line or model for this?</p>
<p>We do that by fitting <code>a</code> and <code>b</code> to values
that minimizes <span class="math inline">\(\epsilon\)</span>, that is,
we need to find the difference between the actual observed values, and
the prediction from the expression or model. Instead of looking at the
individual differences one by one, we look at the sum of the
differences, and minimizes that. However, the observed values can be
larger than the prediction, or smaller. The differences can therefore be
both negative and positive, and the sum can become zero because the
difference might cancel each other out.</p>
<p>To avoid that problem, we square the differences, and then minimize
the sum of the squares. That is the reason for calling the method for
minimizing <span class="math inline">\(\epsilon\)</span>, and by that
finding the optimal <code>a</code> and <code>b</code>, “least
squares”.</p>
<p>In a simple linear model like this, we can calculate the coefficients
directly:</p>
<p><span class="math display">\[\beta_1 = \frac{\sum_{i=1}^{n} (x_i -
\overline{x})(y_i - \overline{y})}{\sum_{i=1}^{n} (x_i -
\overline{x})^2}\]</span></p>
<p><span class="math display">\[\beta_0 = \overline{y} -
\beta_1\overline{x}\]</span></p>
<p>We do not want to do that - R can do it for us, with the function
<code>lm()</code></p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">lm</span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">x</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span></code></pre>
</div>
<p>y~x is the “formula notation” in R, and describes that y is a
function of x.</p>
<p>Using the example from above:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linear_model</span> <span class="op">&lt;-</span> <span class="fu">lm</span><span class="op">(</span><span class="va">dist</span><span class="op">~</span><span class="va">speed</span>, data <span class="op">=</span> <span class="va">cars</span><span class="op">)</span></span></code></pre>
</div>
<p>We saved the result of the function in an object, in order to be able
to work with it. If we just want the coefficients, we can output the
result directly:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linear_model</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
lm(formula = dist ~ speed, data = cars)

Coefficients:
(Intercept)        speed
    -17.579        3.932  </code></pre>
</div>
<p>This gives us the coefficients of the model. The intercept,
<code>b</code> or <span class="math inline">\(\beta_0\)</span> is
-17.579. And the slope, <code>a</code> or <span class="math inline">\(\beta_1\)</span> is 3.932.</p>
<p>Having a negative intercept, or in this case any intercept different
from 0 does not make physical sense - a car travelling at 0 miles pr
hour should have a stopping distance of 0 ft.</p>
<p>The slope tells us, that if we increase the speed of the car by 1
mph, the stopping distance will increase by 3.932 ft.</p>
<div id="challenge-1-can-you-do-it" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-1-can-you-do-it" class="callout-inner">
<h3 class="callout-title">Challenge 1: Can you do it?<a class="anchor" aria-label="anchor" href="#challenge-1-can-you-do-it"></a>
</h3>
<div class="callout-content">
<p>What stopping distance does the model predict if the speed i 12.5
mph?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>3.932*12.5 - 17.579 = 31.571 ft</p>
</div>
</div>
</div>
</div>
<div id="challenge-2-might-there-be-a-problem-with-that-prediction" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-2-might-there-be-a-problem-with-that-prediction" class="callout-inner">
<h3 class="callout-title">Challenge 2: Might there be a problem with that prediction?<a class="anchor" aria-label="anchor" href="#challenge-2-might-there-be-a-problem-with-that-prediction"></a>
</h3>
<div class="callout-content">

</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>Yep. We might be able to measure the speed with the implied
precision. But the prediction implies a precision on the scale of
1/10000 mm.</p>
</div>
</div>
</div>
</div>
<p>We can get more details using the <code>summary()</code>
function:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="va">linear_model</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
lm(formula = dist ~ speed, data = cars)

Residuals:
    Min      1Q  Median      3Q     Max
-29.069  -9.525  -2.272   9.215  43.201

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -17.5791     6.7584  -2.601   0.0123 *
speed         3.9324     0.4155   9.464 1.49e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 15.38 on 48 degrees of freedom
Multiple R-squared:  0.6511,	Adjusted R-squared:  0.6438
F-statistic: 89.57 on 1 and 48 DF,  p-value: 1.49e-12</code></pre>
</div>
<p>Let us look at that output in detail.</p>
<p><code>Call</code> simply repeats the model that we build, just in
case we have forgotten it - but also to have the actual model included
in the output, in order for other functions to access it and use it. We
will get to that.</p>
<p>The residuals are included. It is often important to take a look at
those, and we will do that shortly.</p>
<p>Now, the coefficients.</p>
<p>The estimates for intercept and speed, that is the intercept and the
slope of the line, are given. Those are the same we saw previously. We
also get a standard error. We need that for testing how much trust we
have in the result.</p>
<p>We are almost certain that the estimates of the values for intercept
and slope are not correct. They are estimates after all and we will
never know what the <em>true</em> values are. But we can test if they
are zero.</p>
<p>The hypothesis we can test is - is the coefficient for the slope
actually zero, even though the estimate we get is 3.9? If it is zero,
speed will not have any influence on the stopping distance. So; with
what certainty can we rule out that it is in fact zero?</p>
<p>We are testing the hypothesis that we have gotten a value for speed
of 3.9 by random chance, but that the true value is zero. If it is zero,
the value of 3.9 is 9.5 standard errors away from 0: $3.9324/0.4155 =
9.46426 $. And, using the t-distribution which describes these sorts of
things pretty well, that will happen very rarely. The Pr, or p-value, is
1.49e-12. That is the chance, or probability, that we will get a value
for the slope in our model that is 9.464 standard errors away from zero,
if the true value of the slope is zero.</p>
<p>In general if the p-value is smaller than 0.05, we reject the
hypothesis that the true value of the slope is 0.</p>
<p>Since we can assume that the estimates are normally distributed, we
can see that, <em>if</em> the true value of the slope was zero, the
value we get here, is 3.9324/0.4155 = 9.46426, standard errors away from
zero.</p>
<p>RSE is the squareroot of the sum of the squared residuals, divided by
the number of observations, <span class="math inline">\(n\)</span> minus
the number of parameters in the model, in this case 2. It is an estimate
of the average difference between the observed values, and the values
the model predicts. We want RSE to be as small as possible. What is
small? That depends on the size of the values. If we predict values in
the range of 0 to 2, an RSE of 15 is very large. If we predict values in
the range 0 to 1000, it is small.</p>
<p>Multiple R-squared, is a measure of how much of the variation in
<code>dist</code> that our model explains. In this case the model
explains ~65% of the variation. Not that impressive, but acceptable.</p>
<p>The adjusted R-squared adjusts the multiple R-square by the number of
independent variables in the model. It becomes an important measure of
how good the model is, when we get to multiple linear regression,
because we will get a better R-squared by adding independent variables,
even if these variables do not actually have any connection to the
dependent variables.</p>
<p>The F-statistic is 89.57 and has a p-value of 1.49e-12.</p>
<p>This tests our model against a model where all the slopes (we only
have one in this case) are 0; that is, is the overall model significant.
In this case it is, and there is overall strong evidence for the claim
that the speed of the car influences the stopping distance.</p>
<div id="discussion1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#discussion1"></a>
</h3>
<div class="callout-content">
<p>Make a model, where you describe the length of the flipper of a
penguin, as a function of its weigth. You find data on penguins in the
library <code>palmerpenguins</code>. :::: solution</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">palmerpenguins</span><span class="op">)</span></span>
<span><span class="va">penguin_model</span> <span class="op">&lt;-</span> <span class="fu">lm</span><span class="op">(</span><span class="va">flipper_length_mm</span><span class="op">~</span><span class="va">body_mass_g</span>, data <span class="op">=</span> <span class="va">penguins</span><span class="op">)</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">penguin_model</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
lm(formula = flipper_length_mm ~ body_mass_g, data = penguins)

Residuals:
     Min       1Q   Median       3Q      Max
-23.7626  -4.9138   0.9891   5.1166  16.6392

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) 1.367e+02  1.997e+00   68.47   &lt;2e-16 ***
body_mass_g 1.528e-02  4.668e-04   32.72   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.913 on 340 degrees of freedom
  (2 observations deleted due to missingness)
Multiple R-squared:  0.759,	Adjusted R-squared:  0.7583
F-statistic:  1071 on 1 and 340 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</div>
</div>
<p>::::</p>
</section><section><h2 class="section-heading" id="testing-the-assumptions">Testing the assumptions<a class="anchor" aria-label="anchor" href="#testing-the-assumptions"></a>
<a class="anchor" aria-label="anchor" href="#testing-the-assumptions"></a>
</h2>
<hr class="half-width">
<p>We can <em>always</em> make a linear model. The questions is: should
we?</p>
<p>There are certain assumptions that needs to be met in order to trust
a linear model.</p>
<ol style="list-style-type: decimal">
<li><p>There should be a linear connection between the dependent and
independent variable. We test that by comparing the observed values with
the predicted values (the straight line).</p></li>
<li><p>Independence. The observations needs to be independent. If one
measurement influences another measurement, we are not allowed to use a
linear model.</p></li>
<li><p>Normality of residuals. The residuals must be normally
distributed.</p></li>
</ol>
<p>There exist specific tests for the first two assumptions, but in
general we know our data well enough to determine if they are fulfilled.
The third assumptions can be tested using a <code>qqplot</code>. We
begin by extracting the residuals from our model:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">residuals</span> <span class="op">&lt;-</span> <span class="fu">residuals</span><span class="op">(</span><span class="va">linear_model</span><span class="op">)</span></span></code></pre>
</div>
<p>And then plotting them:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">qqnorm</span><span class="op">(</span><span class="va">residuals</span><span class="op">)</span></span>
<span><span class="fu">qqline</span><span class="op">(</span><span class="va">residuals</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/regression-rendered-unnamed-chunk-9-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The points should be (close to be) on the straight line in the plot.
In this case they are close enough.</p>
<p>This is also a handy way to test if our data is normally
distributed.</p>
<div id="challenge3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#challenge3"></a>
</h3>
<div class="callout-content">
<p>Test if the residuals in our penguin model from before, are normally
distributed.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguin_residuals</span> <span class="op">&lt;-</span> <span class="fu">residuals</span><span class="op">(</span><span class="va">penguin_model</span><span class="op">)</span></span>
<span><span class="fu">qqnorm</span><span class="op">(</span><span class="va">penguin_residuals</span><span class="op">)</span></span>
<span><span class="fu">qqline</span><span class="op">(</span><span class="va">penguin_residuals</span><span class="op">)</span></span></code></pre>
</div>
<p><img src="fig/regression-rendered-unnamed-chunk-10-1.png" style="display: block; margin: auto;" class="figure">
They are relatively close to normal.</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use <code>.md</code> files for episodes when you want static
content</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-clt"><p>Content from <a href="clt.html">Central Limit Theorem</a></p>
<hr>
<p>Last updated on 2024-07-30 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/clt.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do you write a lesson using R Markdown and
<a href="https://carpentries.github.io/sandpaper/" class="external-link">sandpaper</a>?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to use markdown with the new lesson template</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>An important phenomenon working with data is the “Central Limit
Theorem”.</p>
<p>It states that, if we take a lot of samples from a distribution, the
mean of those samples will approximate the normal distribution, even
though the distribution in it self is not normally distributed.</p>
<p>The uniform distribution is not normally distributed. Without any
additional arguments, it will produce x random values between 0 and 1,
with equal probability for all possible values. Here we get 100 random
values, and plot a histogram of them:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">random_numbers</span> <span class="op">&lt;-</span> <span class="fu">runif</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span> </span>
<span><span class="fu">hist</span><span class="op">(</span><span class="va">random_numbers</span><span class="op">)</span></span></code></pre>
</div>
<p><img src="fig/clt-rendered-unnamed-chunk-1-1.png" style="display: block; margin: auto;" class="figure">
This is definitely not normally distributed.</p>
<p>The mean of these random numbers is:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mean</span><span class="op">(</span><span class="va">random_numbers</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.5037346</code></pre>
</div>
<p>The important point of the Central Limit Theorem is, that if we take
a large number of random samples, and calculate the mean of each of
these samples, the means will be normally distributed.</p>
<p>We could also have found the mean of the 100 random numbers like
this:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mean</span><span class="op">(</span><span class="fu">runif</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.5211886</code></pre>
</div>
<p>And we can use the <code>replicate()</code> function to repeat that
calculation several times, in this case 1000 times:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">repeated_means</span> <span class="op">&lt;-</span> <span class="fu">replicate</span><span class="op">(</span><span class="fl">1000</span>, <span class="fu">mean</span><span class="op">(</span><span class="fu">runif</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>When we plot the histogram of these 1000 means of 100 random numbers,
we get this result:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">hist</span><span class="op">(</span><span class="va">repeated_means</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/clt-rendered-unnamed-chunk-5-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The histogram looks quite normally distributed, even though the
distribution from which we drew the random samples were not.</p>
<p>This is the essense of the Central Limit Theorem. The distrubution of
the means of our samples will approximate the normal distribution,
regardless of the underlying distribution.</p>
<p>Because of this, we are able to treat the mean (and a number of other
statistical descriptors), as normally distributed - <em>and</em> use the
properties we know the normal distribution to have to work with
them.</p>
<p>The math required for proving this theorem is relatively complicated,
but can be found in the (extra material)[<a href="https://kubdatalab.github.io/R-toolbox/CLT-dk.html" class="external-link uri">https://kubdatalab.github.io/R-toolbox/CLT-dk.html</a>] on
this page. Note that the proof is in Danish, we are working on an
english version.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>The mean of a sample can be treated as if it is normally
distributed</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-barcharts"><p>Content from <a href="barcharts.html">Nicer barcharts</a></p>
<hr>
<p>Last updated on 2024-07-30 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/barcharts.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do we style barcharts to look better?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to use ggplot to make barcharts look better</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>Barcharts are easy to make, but how can we get them to look
nicer.</p>
<p>This is a checklist for cleaning up your barchart.</p>
<p>We start by getting some data:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">palmerpenguins</span><span class="op">)</span></span>
<span><span class="va">penguin_example</span> <span class="op">&lt;-</span> <span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">species</span><span class="op">)</span></span></code></pre>
</div>
<p>Barcharts and histograms are often confused. Histograms visualizes 1
dimentional data, barcharts 2 dimensional. The easy way to distinguish
them is the white space between the columns. Histograms are describing a
continious set of data, broken down into bins. Therefore there is no
breaks between the columns. Barcharts describes values in discrete
categories.</p>
<p>A further distinction in ggplot is between bar charts and column
charts.</p>
<p>Bar charts, made with <code>geom_bar()</code> makes the height of the
bar propotional to the number of cases/observations in each group, where
as <code>geom_col</code> makes the heights proportional to a value in
the group - that is just one value pr. group.</p>
<div id="callout1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout<a class="anchor" aria-label="anchor" href="#callout1"></a>
</h3>
<div class="callout-content">
<p>The way this happens is in the inner workings of the ggplot object.
All <code>geom</code>s come with an associated function/argument
<code>stats</code>, that controls the statistical transformation of the
input data. In <code>geom_bar</code> that transformation is
<code>stat_count()</code>, that counts the observations in each group.
In <code>geom_col´ it is ´stat_identity()</code>, which does nothing
with the data.</p>
</div>
</div>
</div>

<p>The us make the first barchart:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguin_example</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span><span class="fu">geom_bar</span><span class="op">(</span><span class="op">)</span> </span></code></pre>
</div>
<figure><img src="fig/barcharts-rendered-unnamed-chunk-1-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>This barchart is <em>boring</em>. Grey in grey.</p>
</section><section><h2 class="section-heading" id="step-1---colors-and-labels">Step 1 - colors and labels<a class="anchor" aria-label="anchor" href="#step-1---colors-and-labels"></a>
<a class="anchor" aria-label="anchor" href="#step-1---colors-and-labels"></a>
</h2>
<hr class="half-width">
<p>The first step would be to do something about the colors, and add
labels and a title to the plot:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguin_example</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span><span class="fu">geom_bar</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"darkorchid3"</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">labs</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  y <span class="op">=</span> <span class="st">"Number of penguins"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Number of penguins at Palmer Station, Antarctica"</span><span class="op">)</span></span></code></pre>
</div>
<p><img src="fig/barcharts-rendered-unnamed-chunk-2-1.png" style="display: block; margin: auto;" class="figure">
It is not strictly necessary to remove the label of the x-axis, but it
is superfluous in this case.</p>
</section><section><h2 class="section-heading" id="second-step---the-order-of-the-bars">Second step - the order of the bars<a class="anchor" aria-label="anchor" href="#second-step---the-order-of-the-bars"></a>
<a class="anchor" aria-label="anchor" href="#second-step---the-order-of-the-bars"></a>
</h2>
<hr class="half-width">
<p>Note that the plot orders the species of penguins in alphabetical
order. For some purposes this is perfectly fine. But in general we
prefer to have the categories ordered by size, that is the number of
observations.</p>
<p>The order of categories can be controlled by converting the
observations to a categorical value, and ordering the levels in that
<code>factor</code> by frequency.</p>
<p>The <code>forcats</code> library makes that relatively easy, using
the function <code>fct_infreq()</code>, which converts the character
vector that is <code>species</code> to a factor with levels ordered by
frequency:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguin_example</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>species <span class="op">=</span> <span class="fu">fct_infreq</span><span class="op">(</span><span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span><span class="fu">geom_bar</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"darkorchid3"</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">labs</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  y <span class="op">=</span> <span class="st">"Number of penguins"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Number of penguins at Palmer Station, Antarctica"</span><span class="op">)</span></span></code></pre>
</div>
<p><img src="fig/barcharts-rendered-unnamed-chunk-3-1.png" style="display: block; margin: auto;" class="figure">
This facilitates the reading of the graph - it becomes very easy to see
that the most frequent species of penguin is Adelie penguins.</p>

</section><section><h2 class="section-heading" id="rotating-the-plot">Rotating the plot<a class="anchor" aria-label="anchor" href="#rotating-the-plot"></a>
<a class="anchor" aria-label="anchor" href="#rotating-the-plot"></a>
</h2>
<hr class="half-width">
<p>We only have three here, but if we have a lot of categories, it is
often preferable to have the columns as bars on the y-axis. We do that
by changing the <code>x</code> in the <code>aes()</code> function to
<code>y</code>:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguin_example</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>species <span class="op">=</span> <span class="fu">fct_infreq</span><span class="op">(</span><span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span><span class="fu">geom_bar</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"darkorchid3"</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">labs</span><span class="op">(</span></span>
<span>  y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  x <span class="op">=</span> <span class="st">"Number of penguins"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Number of penguins at Palmer Station, Antarctica"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/barcharts-rendered-unnamed-chunk-4-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></section><section><h2 class="section-heading" id="size-of-text">Size of text<a class="anchor" aria-label="anchor" href="#size-of-text"></a>
<a class="anchor" aria-label="anchor" href="#size-of-text"></a>
</h2>
<hr class="half-width">
<p>The default size of the text on labels, title etc is a bit to the
small side. To improve readability, we change the base_size parameter in
the default theme of ggplot to 14. You might need to play around with
the value, depending on the number of categories.</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguin_example</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>species <span class="op">=</span> <span class="fu">fct_infreq</span><span class="op">(</span><span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span><span class="fu">geom_bar</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"darkorchid3"</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">labs</span><span class="op">(</span></span>
<span>  y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  x <span class="op">=</span> <span class="st">"Number of penguins"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Number of penguins at Palmer Station, Antarctica"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_grey</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p><img src="fig/barcharts-rendered-unnamed-chunk-5-1.png" style="display: block; margin: auto;" class="figure">
We also changed the scaling of the title of the plot. The size of that
is now 10% larger than the base size. We can do that by specifying a
specific size, but here we have done it using the <code>rel()</code>
function which changes the size relative to the base font size in the
plot.</p>
</section><section><h2 class="section-heading" id="step-xxx-removing-unnessecary-space">Step xxx removing unnessecary space<a class="anchor" aria-label="anchor" href="#step-xxx-removing-unnessecary-space"></a>
<a class="anchor" aria-label="anchor" href="#step-xxx-removing-unnessecary-space"></a>
</h2>
<hr class="half-width">
<p>There is a bit of empty space between the columns and the labels on
the y-axis.</p>
<p>Let us get rid of that:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguin_example</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>species <span class="op">=</span> <span class="fu">fct_infreq</span><span class="op">(</span><span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span><span class="fu">geom_bar</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"darkorchid3"</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">labs</span><span class="op">(</span></span>
<span>  y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  x <span class="op">=</span> <span class="st">"Number of penguins"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Number of penguins at Palmer Station, Antarctica"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_grey</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu">expansion</span><span class="op">(</span>mult <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p><img src="fig/barcharts-rendered-unnamed-chunk-6-1.png" style="display: block; margin: auto;" class="figure">
We control what is happening on the x-scale by using the family of
<code>scale_x</code> functions. Because it is a continuous scale, more
specifically <code>scale_x_continuous()</code>.</p>
<p>What is happening by default is that the scale is expanded relative
to the minimum and maximum values of the data. If we want to change
that, we cab either add absolute values (or subtract by using negative
values), or we can make a change relative to the data. That makes the
change robust to changes in the underlying data.</p>
<p>The mult() function in this case add 0 expansion to the left side of
the scale, and 1% ~ 0.01 to the righthand side of the scale.</p>
</section><section><h2 class="section-heading" id="remove-clutter">Remove clutter<a class="anchor" aria-label="anchor" href="#remove-clutter"></a>
<a class="anchor" aria-label="anchor" href="#remove-clutter"></a>
</h2>
<hr class="half-width">
<p>There ar horizontal lines in the plot background that are
unnessecary. And the grey background we get by default is not very nice.
Remove them:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguin_example</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>species <span class="op">=</span> <span class="fu">fct_infreq</span><span class="op">(</span><span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span><span class="fu">geom_bar</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"darkorchid3"</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">labs</span><span class="op">(</span></span>
<span>  y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  x <span class="op">=</span> <span class="st">"Number of penguins"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Number of penguins at Palmer Station, Antarctica"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu">expansion</span><span class="op">(</span>mult <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    panel.grid.major.y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.minor.y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<p><img src="fig/barcharts-rendered-unnamed-chunk-7-1.png" style="display: block; margin: auto;" class="figure">
First we change the default theme of the plot from
<code>theme_grey</code> to <code>theme_minimal</code>, which gets rid of
the grey background. In the additional <code>theme()</code> function we
remove the gridlines, both major and minor gridlines, on the y-axis, by
setting them to the speciel plot element
<code>element_blank()</code></p>
</section><section><h2 class="section-heading" id="add-raw-numbers-to-the-plot">Add raw numbers to the plot<a class="anchor" aria-label="anchor" href="#add-raw-numbers-to-the-plot"></a>
<a class="anchor" aria-label="anchor" href="#add-raw-numbers-to-the-plot"></a>
</h2>
<hr class="half-width">
<p>Especially for barcharts, it can make sense to add the raw values to
the columns, rather than relying on reading the values from the
x-axis.</p>
<p>That <em>can</em> be done, but a more general, and easier to
understand, approach is to construct a dataframe with the data:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguin_count</span> <span class="op">&lt;-</span> <span class="fu">count</span><span class="op">(</span><span class="va">penguin_example</span>, <span class="va">species</span><span class="op">)</span></span>
<span><span class="va">penguin_example</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>species <span class="op">=</span> <span class="fu">fct_infreq</span><span class="op">(</span><span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"darkorchid3"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Number of penguins at Palmer Station, Antarctica"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_minimal</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span></span>
<span>      panel.grid.major <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>      panel.grid.minor <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text</span><span class="op">(</span>data <span class="op">=</span> <span class="va">penguin_count</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">n</span>, y <span class="op">=</span> <span class="va">species</span>, label <span class="op">=</span> <span class="va">n</span><span class="op">)</span>,</span>
<span>    hjust <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    nudge_x <span class="op">=</span> <span class="op">-</span><span class="fl">0.25</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="cn">NULL</span>, expand <span class="op">=</span> <span class="fu">expansion</span><span class="op">(</span>mult <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span></code></pre>
</div>
<figure><img src="fig/barcharts-rendered-count_penguins-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>In general it is a good idea to remove all extraneous pixels in the
graph. And when we add the counts directly to the plot, we can get rid
of the x-axis entirely.</p>
<p>On the other hand, it can be a good idea in this specific example, to
add a vertical indication of where the x=0 intercept is:
<code>geom_vline(xintercept = 0)</code>.</p>
<p>And: Always remember to think about the contrast between the color of
the bars and the text!</p>
</section><section><h2 class="section-heading" id="add-labels-to-the-plot">Add labels to the plot<a class="anchor" aria-label="anchor" href="#add-labels-to-the-plot"></a>
<a class="anchor" aria-label="anchor" href="#add-labels-to-the-plot"></a>
</h2>
<hr class="half-width">
<p>We can do the same with labels if we want:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguin_example</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>species <span class="op">=</span> <span class="fu">fct_infreq</span><span class="op">(</span><span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"darkorchid3"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Number of penguins"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Number of penguins at Palmer Station, Antarctica"</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    panel.grid.major.y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.minor.y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.major.x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.minor.x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu">expansion</span><span class="op">(</span>mult <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_discrete</span><span class="op">(</span>breaks <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">penguin_count</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">n</span>, y <span class="op">=</span> <span class="va">species</span>, label <span class="op">=</span> <span class="va">n</span><span class="op">)</span>,</span>
<span>    hjust <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    nudge_x <span class="op">=</span> <span class="op">-</span><span class="fl">0.25</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"white"</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">penguin_count</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="va">species</span>, label <span class="op">=</span> <span class="va">species</span><span class="op">)</span>,</span>
<span>    hjust <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    nudge_x <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>    fontface <span class="op">=</span> <span class="st">"bold"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">4.5</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/barcharts-rendered-unnamed-chunk-8-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></section><section><h2 class="section-heading" id="slimmer-bars">Slimmer bars<a class="anchor" aria-label="anchor" href="#slimmer-bars"></a>
<a class="anchor" aria-label="anchor" href="#slimmer-bars"></a>
</h2>
<hr class="half-width">
<p>Depending on aspect ratio of the final plot, number of categories
etc, we might want to adjust the width of the bars:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguin_example</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>species <span class="op">=</span> <span class="fu">fct_infreq</span><span class="op">(</span><span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span></span>
<span>    fill <span class="op">=</span> <span class="st">"darkorchid3"</span>,</span>
<span>    width <span class="op">=</span> <span class="fl">0.4</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Number of penguins"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Number of penguins at Palmer Station, Antarctica"</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    panel.grid.major.y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.minor.y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.major.x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.minor.x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu">expansion</span><span class="op">(</span>mult <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_discrete</span><span class="op">(</span>breaks <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">penguin_count</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">n</span>, y <span class="op">=</span> <span class="va">species</span>, label <span class="op">=</span> <span class="va">n</span><span class="op">)</span>,</span>
<span>    hjust <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    nudge_y <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">5.5</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">penguin_count</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="va">species</span>, label <span class="op">=</span> <span class="va">species</span><span class="op">)</span>,</span>
<span>    hjust <span class="op">=</span> <span class="fl">0</span>, </span>
<span>    nudge_x <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>    nudge_y <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"white"</span>, </span>
<span>    fontface <span class="op">=</span> <span class="st">"bold"</span>, </span>
<span>    size <span class="op">=</span> <span class="fl">4.5</span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/barcharts-rendered-unnamed-chunk-9-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use <code>.md</code> files for episodes when you want static
content</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-powerberegninger"><p>Content from <a href="powerberegninger.html">powerberegninger</a></p>
<hr>
<p>Last updated on 2024-07-30 |

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/episodes/powerberegninger.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How large of a sample do I need to identify a result?</li>
<li>How much confidence can I get using a specific sample size?</li>
<li>How much power can I get using a specific sample size?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to use markdown with the new lesson template</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>We have some data on the lung volume of children, and want to see if
there is a difference between the (mean) lung volume of the two sexes.
Ie if the mean for boys is 1.87 and for girls is 1.84, there obviously
is a difference. But is it significant?</p>
<p>We would do that by running at two-sample t-test. The null-hypothesis
is that there is no difference between the mean of the two samples, and
if the p-value is smaller than (typically) 0.05, we will reject the
null-hypothesis.</p>
<p>That is not the same as concluding that there <em>is</em> a
difference, just that the risk of of observing such a difference by
random chance, if there really were no difference, is low (less than
5%).</p>
<p>This can go wrong in two ways. There might actually be no difference,
but we reject the null-hypothesis anyway, and conclude that a difference
exist. That is a false positive; we see a difference where none is. We
also call it a type I error.</p>
<p>On the other hand, there might really be a diffence, but we fail to
reject the null hypothesis, that is we conclude that no difference
exist, even though there <em>is</em> a difference. That is a false
negative, or a type II error.</p>
<p>The risk of a type I error is <span class="math inline">\(\alpha\)</span> - which is what we specify
choosing a level of significance, typically 0.05.</p>
<p>The risk of a type II error is related to the concept of “power”, or
<span class="math inline">\(\beta\)</span>. Thas is the chance of seeing
a difference where such a difference actually exists. And the risk of
not seeing it is therefore <span class="math inline">\(1-\beta\)</span>.</p>
<p>These two concepts are combined in power-calculations.</p>
</section><section><h2 class="section-heading" id="how-many-children-do-we-need-to-test">How many children do we need to test?<a class="anchor" aria-label="anchor" href="#how-many-children-do-we-need-to-test"></a>
<a class="anchor" aria-label="anchor" href="#how-many-children-do-we-need-to-test"></a>
</h2>
<hr class="half-width">
<p>We begin by loading the data. You can download the data <a href="https://raw.githubusercontent.com/KUBDatalab/R-toolbox/main/episodes/data/FEV.csv" class="external-link">from
this link</a>.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"data/FEV.csv"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Rows: 654 Columns: 6
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (6): Id, Age, FEV, Hgt, Sex, Smoke

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<p>The dataset have measurements of the lung capacity (FEV) for boys and
girls between the ages of 3 and 19. Since we know that there
<em>are</em> significant differences between the two sexes once they
reach puberty, we will be looking at the data for prepubescent
children.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">Age</span> <span class="op">&lt;</span> <span class="fl">10</span><span class="op">)</span></span></code></pre>
</div>
<p>The means and standard deviations can be calculated like this:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">Sex</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">summarise</span><span class="op">(</span>mean <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">FEV</span><span class="op">)</span>,</span>
<span>          sd <span class="op">=</span> <span class="fu">sd</span><span class="op">(</span><span class="va">FEV</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 2 × 3
    Sex  mean    sd
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0  2.00 0.508
2     1  2.07 0.514</code></pre>
</div>
<p>In this dataset the girls are coded as “0” and the boys as “1”. We
see a difference of 0.0757019.</p>
<p>Is there a difference? The null-hypothesis is that there is not. We
have two independent samples, so we are running a two-sample-t-test:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">girls</span> <span class="op">&lt;-</span> <span class="va">test_data</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">filter</span><span class="op">(</span><span class="va">Sex</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">boys</span> <span class="op">&lt;-</span> <span class="va">test_data</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">filter</span><span class="op">(</span><span class="va">Sex</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">t.test</span><span class="op">(</span><span class="va">boys</span><span class="op">$</span><span class="va">FEV</span>, <span class="va">girls</span><span class="op">$</span><span class="va">FEV</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Welch Two Sample t-test

data:  boys$FEV and girls$FEV
t = 1.3021, df = 306.88, p-value = 0.1939
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -0.03870191  0.19010577
sample estimates:
mean of x mean of y
 2.070799  1.995097 </code></pre>
</div>
<p>The p-value is larger than 0.05, so we do not reject the
null-hypothesis, and conclude that even though there might be a
difference, we cannot rule out the possibility that the difference we
see between the two means is happening by chance.</p>
<p>How many children should we measure, if we wanted to see a difference
of 0.0757019?</p>
<p>That is, how large a sample should we have, if we want to detect an
actual difference as small as this? This difference is often called the
effect-size.</p>
<p>The effect size is relative to the absolute size of the means. A
difference of 0.08 is easier to detect when it is between 1.99 and 2.07
than if it is between 5461.31 and 5461.39.</p>
<p>Therefore we measure the effect size in standard deviations rather
than in absolute values. We denote that as <code>d</code> or Cohen’s
d. Often we want to see a specific effect size: 0.2 is considered small,
0.5 as medium and 0.8 as large.</p>
<p>In this case we have an effect size, but needs to convert it to
standard deviations:</p>
<p><span class="math display">\[d = \frac{\mu_{boys} -
\mu_{girls}}{\sigma_{pooled}}\]</span></p>
<p>Where the pooled standard deviation is calculated with:</p>
<p><span class="math display">\[\sigma_{pooled} =
\sqrt{\frac{(n_{boys}-1)s_{boys}^2 +
(n_{girls}-1)s_{girls}^2}{n_{boys}+n_{girls} -2}}\]</span></p>
<p>Which is a weighted average of the two standard deviations.</p>
<p>We need the following values:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">Sex</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span>, mean <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">FEV</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fu">sd</span><span class="op">(</span><span class="va">FEV</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 2 × 4
    Sex     n  mean    sd
  &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0   155  2.00 0.508
2     1   154  2.07 0.514</code></pre>
</div>
<p>And now get the pooled standard deviation with:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s_p</span> <span class="op">&lt;-</span> <span class="fu">sqrt</span><span class="op">(</span><span class="op">(</span><span class="op">(</span><span class="fl">154</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fl">0.5144072</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="op">(</span><span class="fl">155</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fl">0.5075533</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">154</span><span class="op">+</span><span class="fl">155</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>And can then calculate Cohen’s d, or, the effect size in standard
deviations:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">2.070799</span><span class="op">-</span><span class="fl">1.995097</span><span class="op">)</span><span class="op">/</span><span class="va">s_p</span></span>
<span><span class="va">d</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.1481504</code></pre>
</div>
<p>Now we almost have all our ducks in a row. There is only one number
we need to decide on - the power. In this example we decide that it
should be 0.9. To reiterate: If the difference exists, we want to have a
90% chance of detecting it.</p>
<p>Or, conversely, we are willing to accept a 10% chance of a type II
error, where we fail to detect the difference.</p>
<p>R has a built in function for doing the final calculation for a two
sample t test. But we are going to use the <code>pwr</code> library. The
results are the same, but the calculations are different for different
tests, and <code>pwr</code> provides functions for handling other
tests.</p>
<p>The function we are going to use is <code>pwr.t.test</code>:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">pwr</span><span class="op">)</span></span>
<span><span class="fu">pwr.t.test</span><span class="op">(</span>d<span class="op">=</span><span class="va">d</span>, sig.level <span class="op">=</span> <span class="fl">0.05</span>, power <span class="op">=</span> <span class="fl">0.9</span>, type <span class="op">=</span> <span class="st">"two.sample"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
     Two-sample t test power calculation

              n = 958.4203
              d = 0.1481504
      sig.level = 0.05
          power = 0.9
    alternative = two.sided

NOTE: n is number in *each* group</code></pre>
</div>
<p>We specify the effect size (d), the significanse level (0.05), the
power we want (0.9), and the type of test we want to be able to do on
the data (“two.sample”).</p>
<p>And get the result that we need (at least) 959 observations in
<em>each</em> group, in order to see the wanted effect size, with at a
5% significanse level and with a power of 0.9.</p>
</section><section><h2 class="section-heading" id="how-large-effect-sizes-can-we-see">How large effect sizes can we see?<a class="anchor" aria-label="anchor" href="#how-large-effect-sizes-can-we-see"></a>
<a class="anchor" aria-label="anchor" href="#how-large-effect-sizes-can-we-see"></a>
</h2>
<hr class="half-width">
<p>The function is smart. There are four numbers involved: The effect
size, the significanse level, the power and the number of observations.
They are all connected, and if we specify three of them, we will get the
fourth.</p>
<p>Given the number of observations we have, we can calculate the power
of the test:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pwr.t.test</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">155</span>, d<span class="op">=</span><span class="va">d</span>, sig.level <span class="op">=</span> <span class="fl">0.05</span>, type <span class="op">=</span> <span class="st">"two.sample"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
     Two-sample t test power calculation

              n = 155
              d = 0.1481504
      sig.level = 0.05
          power = 0.2552478
    alternative = two.sided

NOTE: n is number in *each* group</code></pre>
</div>
<p>There is ~75% chance of getting a type II error.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use <code>.md</code> files for episodes when you want static
content</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/KUBDatalab/R-toolbox/edit/main/README.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/KUBDatalab/R-toolbox/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/KUBDatalab/R-toolbox/" class="external-link">Source</a></p>
				<p><a href="https://github.com/KUBDatalab/R-toolbox/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:kubdatalab@kb.dk">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.5" class="external-link">sandpaper (0.16.5)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.6" class="external-link">pegboard (0.7.6)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.3" class="external-link">varnish (1.0.3)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://KUBDatalab.github.io/R-toolbox/aio.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://KUBDatalab.github.io/R-toolbox/aio.html",
  "identifier": "https://KUBDatalab.github.io/R-toolbox/aio.html",
  "dateCreated": "2024-04-09",
  "dateModified": "2024-07-30",
  "datePublished": "2024-07-30"
}

  </script><script>
		feather.replace();
	</script>
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

